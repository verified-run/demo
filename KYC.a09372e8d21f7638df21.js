/*! For license information please see KYC.a09372e8d21f7638df21.js.LICENSE.txt */
(function(){var __webpack_modules__={8732:function(e){"use strict";e.exports=function(e,t){for(var n=new Array(arguments.length-1),r=0,a=2,s=!0;a<arguments.length;)n[r++]=arguments[a++];return new Promise((function(a,o){n[r]=function(e){if(s)if(s=!1,e)o(e);else{for(var t=new Array(arguments.length-1),n=0;n<t.length;)t[n++]=arguments[n];a.apply(null,t)}};try{e.apply(t||null,n)}catch(e){s&&(s=!1,o(e))}}))}},2340:function(e,t){"use strict";var n=t;n.length=function(e){var t=e.length;if(!t)return 0;for(var n=0;--t%4>1&&"="===e.charAt(t);)++n;return Math.ceil(3*e.length)/4-n};for(var r=new Array(64),a=new Array(123),s=0;s<64;)a[r[s]=s<26?s+65:s<52?s+71:s<62?s-4:s-59|43]=s++;n.encode=function(e,t,n){for(var a,s=null,o=[],i=0,u=0;t<n;){var c=e[t++];switch(u){case 0:o[i++]=r[c>>2],a=(3&c)<<4,u=1;break;case 1:o[i++]=r[a|c>>4],a=(15&c)<<2,u=2;break;case 2:o[i++]=r[a|c>>6],o[i++]=r[63&c],u=0}i>8191&&((s||(s=[])).push(String.fromCharCode.apply(String,o)),i=0)}return u&&(o[i++]=r[a],o[i++]=61,1===u&&(o[i++]=61)),s?(i&&s.push(String.fromCharCode.apply(String,o.slice(0,i))),s.join("")):String.fromCharCode.apply(String,o.slice(0,i))};var o="invalid encoding";n.decode=function(e,t,n){for(var r,s=n,i=0,u=0;u<e.length;){var c=e.charCodeAt(u++);if(61===c&&i>1)break;if(void 0===(c=a[c]))throw Error(o);switch(i){case 0:r=c,i=1;break;case 1:t[n++]=r<<2|(48&c)>>4,r=c,i=2;break;case 2:t[n++]=(15&r)<<4|(60&c)>>2,r=c,i=3;break;case 3:t[n++]=(3&r)<<6|c,i=0}}if(1===i)throw Error(o);return n-s},n.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}},8023:function(e){"use strict";function t(){this._listeners={}}e.exports=t,t.prototype.on=function(e,t,n){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:n||this}),this},t.prototype.off=function(e,t){if(void 0===e)this._listeners={};else if(void 0===t)this._listeners[e]=[];else for(var n=this._listeners[e],r=0;r<n.length;)n[r].fn===t?n.splice(r,1):++r;return this},t.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var n=[],r=1;r<arguments.length;)n.push(arguments[r++]);for(r=0;r<t.length;)t[r].fn.apply(t[r++].ctx,n)}return this}},7417:function(e){"use strict";function t(e){return"undefined"!=typeof Float32Array?function(){var t=new Float32Array([-0]),n=new Uint8Array(t.buffer),r=128===n[3];function a(e,r,a){t[0]=e,r[a]=n[0],r[a+1]=n[1],r[a+2]=n[2],r[a+3]=n[3]}function s(e,r,a){t[0]=e,r[a]=n[3],r[a+1]=n[2],r[a+2]=n[1],r[a+3]=n[0]}function o(e,r){return n[0]=e[r],n[1]=e[r+1],n[2]=e[r+2],n[3]=e[r+3],t[0]}function i(e,r){return n[3]=e[r],n[2]=e[r+1],n[1]=e[r+2],n[0]=e[r+3],t[0]}e.writeFloatLE=r?a:s,e.writeFloatBE=r?s:a,e.readFloatLE=r?o:i,e.readFloatBE=r?i:o}():function(){function t(e,t,n,r){var a=t<0?1:0;if(a&&(t=-t),0===t)e(1/t>0?0:2147483648,n,r);else if(isNaN(t))e(2143289344,n,r);else if(t>34028234663852886e22)e((a<<31|2139095040)>>>0,n,r);else if(t<11754943508222875e-54)e((a<<31|Math.round(t/1401298464324817e-60))>>>0,n,r);else{var s=Math.floor(Math.log(t)/Math.LN2);e((a<<31|s+127<<23|8388607&Math.round(t*Math.pow(2,-s)*8388608))>>>0,n,r)}}function o(e,t,n){var r=e(t,n),a=2*(r>>31)+1,s=r>>>23&255,o=8388607&r;return 255===s?o?NaN:a*(1/0):0===s?1401298464324817e-60*a*o:a*Math.pow(2,s-150)*(o+8388608)}e.writeFloatLE=t.bind(null,n),e.writeFloatBE=t.bind(null,r),e.readFloatLE=o.bind(null,a),e.readFloatBE=o.bind(null,s)}(),"undefined"!=typeof Float64Array?function(){var t=new Float64Array([-0]),n=new Uint8Array(t.buffer),r=128===n[7];function a(e,r,a){t[0]=e,r[a]=n[0],r[a+1]=n[1],r[a+2]=n[2],r[a+3]=n[3],r[a+4]=n[4],r[a+5]=n[5],r[a+6]=n[6],r[a+7]=n[7]}function s(e,r,a){t[0]=e,r[a]=n[7],r[a+1]=n[6],r[a+2]=n[5],r[a+3]=n[4],r[a+4]=n[3],r[a+5]=n[2],r[a+6]=n[1],r[a+7]=n[0]}function o(e,r){return n[0]=e[r],n[1]=e[r+1],n[2]=e[r+2],n[3]=e[r+3],n[4]=e[r+4],n[5]=e[r+5],n[6]=e[r+6],n[7]=e[r+7],t[0]}function i(e,r){return n[7]=e[r],n[6]=e[r+1],n[5]=e[r+2],n[4]=e[r+3],n[3]=e[r+4],n[2]=e[r+5],n[1]=e[r+6],n[0]=e[r+7],t[0]}e.writeDoubleLE=r?a:s,e.writeDoubleBE=r?s:a,e.readDoubleLE=r?o:i,e.readDoubleBE=r?i:o}():function(){function t(e,t,n,r,a,s){var o=r<0?1:0;if(o&&(r=-r),0===r)e(0,a,s+t),e(1/r>0?0:2147483648,a,s+n);else if(isNaN(r))e(0,a,s+t),e(2146959360,a,s+n);else if(r>17976931348623157e292)e(0,a,s+t),e((o<<31|2146435072)>>>0,a,s+n);else{var i;if(r<22250738585072014e-324)e((i=r/5e-324)>>>0,a,s+t),e((o<<31|i/4294967296)>>>0,a,s+n);else{var u=Math.floor(Math.log(r)/Math.LN2);1024===u&&(u=1023),e(4503599627370496*(i=r*Math.pow(2,-u))>>>0,a,s+t),e((o<<31|u+1023<<20|1048576*i&1048575)>>>0,a,s+n)}}}function o(e,t,n,r,a){var s=e(r,a+t),o=e(r,a+n),i=2*(o>>31)+1,u=o>>>20&2047,c=4294967296*(1048575&o)+s;return 2047===u?c?NaN:i*(1/0):0===u?5e-324*i*c:i*Math.pow(2,u-1075)*(c+4503599627370496)}e.writeDoubleLE=t.bind(null,n,0,4),e.writeDoubleBE=t.bind(null,r,4,0),e.readDoubleLE=o.bind(null,a,0,4),e.readDoubleBE=o.bind(null,s,4,0)}(),e}function n(e,t,n){t[n]=255&e,t[n+1]=e>>>8&255,t[n+2]=e>>>16&255,t[n+3]=e>>>24}function r(e,t,n){t[n]=e>>>24,t[n+1]=e>>>16&255,t[n+2]=e>>>8&255,t[n+3]=255&e}function a(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}function s(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}e.exports=t(t)},4199:function(module){"use strict";function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}module.exports=inquire},1474:function(e){"use strict";e.exports=function(e,t,n){var r=n||8192,a=r>>>1,s=null,o=r;return function(n){if(n<1||n>a)return e(n);o+n>r&&(s=e(r),o=0);var i=t.call(s,o,o+=n);return 7&o&&(o=1+(7|o)),i}}},8421:function(e,t){"use strict";var n=t;n.length=function(e){for(var t=0,n=0,r=0;r<e.length;++r)(n=e.charCodeAt(r))<128?t+=1:n<2048?t+=2:55296==(64512&n)&&56320==(64512&e.charCodeAt(r+1))?(++r,t+=4):t+=3;return t},n.read=function(e,t,n){if(n-t<1)return"";for(var r,a=null,s=[],o=0;t<n;)(r=e[t++])<128?s[o++]=r:r>191&&r<224?s[o++]=(31&r)<<6|63&e[t++]:r>239&&r<365?(r=((7&r)<<18|(63&e[t++])<<12|(63&e[t++])<<6|63&e[t++])-65536,s[o++]=55296+(r>>10),s[o++]=56320+(1023&r)):s[o++]=(15&r)<<12|(63&e[t++])<<6|63&e[t++],o>8191&&((a||(a=[])).push(String.fromCharCode.apply(String,s)),o=0);return a?(o&&a.push(String.fromCharCode.apply(String,s.slice(0,o))),a.join("")):String.fromCharCode.apply(String,s.slice(0,o))},n.write=function(e,t,n){for(var r,a,s=n,o=0;o<e.length;++o)(r=e.charCodeAt(o))<128?t[n++]=r:r<2048?(t[n++]=r>>6|192,t[n++]=63&r|128):55296==(64512&r)&&56320==(64512&(a=e.charCodeAt(o+1)))?(r=65536+((1023&r)<<10)+(1023&a),++o,t[n++]=r>>18|240,t[n++]=r>>12&63|128,t[n++]=r>>6&63|128,t[n++]=63&r|128):(t[n++]=r>>12|224,t[n++]=r>>6&63|128,t[n++]=63&r|128);return n-s}},7570:function(e,t,n){var r,a=(r=(r="undefined"!=typeof document&&document.currentScript?document.currentScript.src:void 0)||"/index.js",function(e){function t(){return M.buffer!=D&&Z(M.buffer),F}function a(){return M.buffer!=D&&Z(M.buffer),$}function s(){return M.buffer!=D&&Z(M.buffer),P}function o(){return M.buffer!=D&&Z(M.buffer),j}function i(){return M.buffer!=D&&Z(M.buffer),B}var u,c,l=void 0!==(e=e||{})?e:{};l.ready=new Promise((function(e,t){u=e,c=t}));var p,d={};for(p in l)l.hasOwnProperty(p)&&(d[p]=l[p]);var h=[],f=function(e,t){throw t},m=!1,y=!1,g=!1,b=!1;m="object"==typeof window,y="function"==typeof importScripts,g="object"==typeof process&&"object"==typeof process.versions&&"string"==typeof process.versions.node,b=!m&&!g&&!y;var w=l.ENVIRONMENT_IS_PTHREAD||!1;w&&(D=l.buffer);var v,x,k,_,S,N="";function T(e){return l.locateFile?l.locateFile(e,N):N+e}if(g){var E;N=y?n(2980).dirname(N)+"/":"//",v=function(e,t){return _||(_=n(7256)),S||(S=n(2980)),e=S.normalize(e),_.readFileSync(e,t?null:"utf8")},k=function(e){var t=v(e,!0);return t.buffer||(t=new Uint8Array(t)),q(t.buffer),t},process.argv.length>1&&process.argv[1].replace(/\\/g,"/"),h=process.argv.slice(2),process.on("uncaughtException",(function(e){if(!(e instanceof sn))throw e})),process.on("unhandledRejection",ge),f=function(e){process.exit(e)},l.inspect=function(){return"[Emscripten Module object]"};try{E=n(7958)}catch(e){throw console.error('The "worker_threads" module is not supported in this node.js build - perhaps a newer version is needed?'),e}n.g.Worker=E.Worker}else b?("undefined"!=typeof read&&(v=function(e){return read(e)}),k=function(e){var t;return"function"==typeof readbuffer?new Uint8Array(readbuffer(e)):(q("object"==typeof(t=read(e,"binary"))),t)},"undefined"!=typeof scriptArgs?h=scriptArgs:void 0!==arguments&&(h=arguments),"function"==typeof quit&&(f=function(e){quit(e)}),"undefined"!=typeof print&&("undefined"==typeof console&&(console={}),console.log=print,console.warn=console.error="undefined"!=typeof printErr?printErr:print)):(m||y)&&(y?N=self.location.href:"undefined"!=typeof document&&document.currentScript&&(N=document.currentScript.src),void 0!==r&&r&&(N=r),N=0!==N.indexOf("blob:")?N.substr(0,N.lastIndexOf("/")+1):"",g?(v=function(e,t){return _||(_=n(7256)),S||(S=n(2980)),e=S.normalize(e),_.readFileSync(e,t?null:"utf8")},k=function(e){var t=v(e,!0);return t.buffer||(t=new Uint8Array(t)),q(t.buffer),t}):(v=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},y&&(k=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),x=function(e,t,n){var r=new XMLHttpRequest;r.open("GET",e,!0),r.responseType="arraybuffer",r.onload=function(){200==r.status||0==r.status&&r.response?t(r.response):n()},r.onerror=n,r.send(null)}));g&&"undefined"==typeof performance&&(n.g.performance=n(4862).performance);var I,O=l.print||console.log.bind(console),A=l.printErr||console.warn.bind(console);for(p in d)d.hasOwnProperty(p)&&(l[p]=d[p]);d=null,l.arguments&&(h=l.arguments),l.thisProgram&&l.thisProgram,l.quit&&(f=l.quit),Atomics.load,Atomics.store,Atomics.compareExchange,l.wasmBinary&&(I=l.wasmBinary);var M,C,R=l.noExitRuntime||!0;"object"!=typeof WebAssembly&&ge("no native wasm support detected");var D,F,$,P,j,B,L=!1;function q(e,t){e||ge("Assertion failed: "+t)}function z(e){var t=l["_"+e];return q(t,"Cannot call unknown function "+e+", make sure it is exported"),t}function V(e,t,n,r,a){var s={string:function(e){var t=0;if(null!=e&&0!==e){var n=1+(e.length<<2);G(e,t=en(n),n)}return t},array:function(e){var t=en(e.length);return Y(e,t),t}},o=z(e),i=[],u=0;if(r)for(var c=0;c<r.length;c++){var l=s[n[c]];l?(0===u&&(u=Zt()),i[c]=l(r[c])):i[c]=r[c]}var p=o.apply(null,i);return p=function(e){return"string"===t?U(e):"boolean"===t?Boolean(e):e}(p),0!==u&&Qt(u),p}function W(e,t,n,r){var a=(n=n||[]).every((function(e){return"number"===e}));return"string"!==t&&a&&!r?z(e):function(){return V(e,t,n,arguments)}}function H(e,t,n){for(var r=t+n,a="";!(t>=r);){var s=e[t++];if(!s)return a;if(128&s){var o=63&e[t++];if(192!=(224&s)){var i=63&e[t++];if((s=224==(240&s)?(15&s)<<12|o<<6|i:(7&s)<<18|o<<12|i<<6|63&e[t++])<65536)a+=String.fromCharCode(s);else{var u=s-65536;a+=String.fromCharCode(55296|u>>10,56320|1023&u)}}else a+=String.fromCharCode((31&s)<<6|o)}else a+=String.fromCharCode(s)}return a}function U(e,t){return e?H(a(),e,t):""}function K(e,t,n,r){if(!(r>0))return 0;for(var a=n,s=n+r-1,o=0;o<e.length;++o){var i=e.charCodeAt(o);if(i>=55296&&i<=57343&&(i=65536+((1023&i)<<10)|1023&e.charCodeAt(++o)),i<=127){if(n>=s)break;t[n++]=i}else if(i<=2047){if(n+1>=s)break;t[n++]=192|i>>6,t[n++]=128|63&i}else if(i<=65535){if(n+2>=s)break;t[n++]=224|i>>12,t[n++]=128|i>>6&63,t[n++]=128|63&i}else{if(n+3>=s)break;t[n++]=240|i>>18,t[n++]=128|i>>12&63,t[n++]=128|i>>6&63,t[n++]=128|63&i}}return t[n]=0,n-a}function G(e,t,n){return K(e,a(),t,n)}function J(e){for(var t=0,n=0;n<e.length;++n){var r=e.charCodeAt(n);r>=55296&&r<=57343&&(r=65536+((1023&r)<<10)|1023&e.charCodeAt(++n)),r<=127?++t:t+=r<=2047?2:r<=65535?3:4}return t}function Y(e,n){t().set(e,n)}function X(e,t){return e%t>0&&(e+=t-e%t),e}function Z(e){D=e,l.HEAP8=F=new Int8Array(e),l.HEAP16=new Int16Array(e),l.HEAP32=P=new Int32Array(e),l.HEAPU8=$=new Uint8Array(e),l.HEAPU16=new Uint16Array(e),l.HEAPU32=j=new Uint32Array(e),l.HEAPF32=new Float32Array(e),l.HEAPF64=B=new Float64Array(e)}var Q,ee=l.INITIAL_MEMORY||16777216;if(w)M=l.wasmMemory,D=l.buffer;else if(l.wasmMemory)M=l.wasmMemory;else if(!((M=new WebAssembly.Memory({initial:ee/65536,maximum:32768,shared:!0})).buffer instanceof SharedArrayBuffer))throw A("requested a shared WebAssembly.Memory but the returned buffer is not a SharedArrayBuffer, indicating that while the browser has SharedArrayBuffer it does not have WebAssembly threads support - you may need to set a flag"),g&&console.log("(on node you may need: --experimental-wasm-threads --experimental-wasm-bulk-memory and also use a recent version)"),Error("bad memory");M&&(D=M.buffer),ee=D.byteLength,Z(D);var te=[],ne=[],re=[],ae=[],se=[];function oe(){if(!w){if(l.preRun)for("function"==typeof l.preRun&&(l.preRun=[l.preRun]);l.preRun.length;)le(l.preRun.shift());Oe(te)}}function ie(){w||Oe(ne)}function ue(){w||Oe(re)}function ce(){if(!w){if(l.postRun)for("function"==typeof l.postRun&&(l.postRun=[l.postRun]);l.postRun.length;)pe(l.postRun.shift());Oe(se)}}function le(e){te.unshift(e)}function pe(e){se.unshift(e)}w||ne.push({func:function(){jt()}});var de=0,he=null,fe=null;function me(e){q(!w,"addRunDependency cannot be used in a pthread worker"),de++,l.monitorRunDependencies&&l.monitorRunDependencies(de)}function ye(e){if(de--,l.monitorRunDependencies&&l.monitorRunDependencies(de),0==de&&(null!==he&&(clearInterval(he),he=null),fe)){var t=fe;fe=null,t()}}function ge(e){l.onAbort&&l.onAbort(e),w&&console.error("Pthread aborting at "+(new Error).stack),A(e+=""),L=!0,e="abort("+e+"). Build with -s ASSERTIONS=1 for more info.";var t=new WebAssembly.RuntimeError(e);throw c(t),t}function be(e,t){return String.prototype.startsWith?e.startsWith(t):0===e.indexOf(t)}l.preloadedImages={},l.preloadedAudios={};var we="data:application/octet-stream;base64,";function ve(e){return be(e,we)}var xe="file://";function ke(e){return be(e,xe)}var _e="tfjs-backend-wasm-threaded-simd.wasm";function Se(e){try{if(e==_e&&I)return new Uint8Array(I);if(k)return k(e);throw"both async and sync fetching of the wasm failed"}catch(e){ge(e)}}function Ne(){if(!I&&(m||y)){if("function"==typeof fetch&&!ke(_e))return fetch(_e,{credentials:"same-origin"}).then((function(e){if(!e.ok)throw"failed to load wasm binary file at '"+_e+"'";return e.arrayBuffer()})).catch((function(){return Se(_e)}));if(x)return new Promise((function(e,t){x(_e,(function(t){e(new Uint8Array(t))}),t)}))}return Promise.resolve().then((function(){return Se(_e)}))}function Te(){var e={a:Pt};function t(e,t){var n=e.exports;if(l.asm=n,Q=l.asm.F,C=t,!w){var r=Fe.unusedWorkers.length;Fe.unusedWorkers.forEach((function(e){Fe.loadWasmModuleToWorker(e,(function(){--r||ye()}))}))}}function n(e){t(e.instance,e.module)}function r(t){return Ne().then((function(t){return WebAssembly.instantiate(t,e)})).then(t,(function(e){A("failed to asynchronously prepare wasm: "+e),ge(e)}))}if(w||me(),l.instantiateWasm)try{return l.instantiateWasm(e,t)}catch(e){return A("Module.instantiateWasm callback failed with error: "+e),!1}return(I||"function"!=typeof WebAssembly.instantiateStreaming||ve(_e)||ke(_e)||"function"!=typeof fetch?r(n):fetch(_e,{credentials:"same-origin"}).then((function(t){return WebAssembly.instantiateStreaming(t,e).then(n,(function(e){return A("wasm streaming compile failed: "+e),A("falling back to ArrayBuffer instantiation"),r(n)}))}))).catch(c),{}}ve(_e)||(_e=T(_e));var Ee={10024:function(){throw"Canceled!"},10042:function(e,t){setTimeout((function(){Kt(e,t)}),0)}};function Ie(){Fe.initRuntime()}function Oe(e){for(;e.length>0;){var t=e.shift();if("function"!=typeof t){var n=t.func;"number"==typeof n?void 0===t.arg?Q.get(n)():Q.get(n)(t.arg):n(void 0===t.arg?null:t.arg)}else t(l)}}function Ae(e,n){if(e<=0||e>t().length||!0&e||n<0)return-28;if(0==n)return 0;n>=2147483647&&(n=1/0);var r=Atomics.load(s(),an>>2),a=0;if(r==e&&Atomics.compareExchange(s(),an>>2,r,0)==r&&(a=1,--n<=0))return 1;var o=Atomics.notify(s(),e>>2,n);if(o>=0)return o+a;throw"Atomics.notify returned an unexpected value "+o}function Me(e){if(w)throw"Internal Error! killThread() can only ever be called from main application thread!";if(!e)throw"Internal Error! Null pthread_ptr in killThread!";s()[e+12>>2]=0;var t=Fe.pthreads[e];t.worker.terminate(),Fe.freeThreadData(t),Fe.runningWorkers.splice(Fe.runningWorkers.indexOf(t.worker),1),t.worker.pthread=void 0}function Ce(e){if(w)throw"Internal Error! cancelThread() can only ever be called from main application thread!";if(!e)throw"Internal Error! Null pthread_ptr in cancelThread!";Fe.pthreads[e].worker.postMessage({cmd:"cancel"})}function Re(e){if(w)throw"Internal Error! cleanupThread() can only ever be called from main application thread!";if(!e)throw"Internal Error! Null pthread_ptr in cleanupThread!";var t=Fe.pthreads[e];if(t){s()[e+12>>2]=0;var n=t.worker;Fe.returnWorkerToPool(n)}}l._emscripten_futex_wake=Ae;var De,Fe={unusedWorkers:[],runningWorkers:[],initMainThreadBlock:function(){for(var e=Math.min(4,Math.max(1,(navigator.hardwareConcurrency||1)/2)),t=0;t<e;++t)Fe.allocateUnusedWorker()},initRuntime:function(){for(var e=Bt(228),t=0;t<57;++t)o()[e/4+t]=0;s()[e+12>>2]=e;var n=e+152;s()[n>>2]=n;var r=Bt(512);for(t=0;t<128;++t)o()[r/4+t]=0;Atomics.store(o(),e+100>>2,r),Atomics.store(o(),e+40>>2,e),Xt(e,!y,1),Ut(e)},initWorker:function(){},pthreads:{},threadExitHandlers:[],setThreadStatus:function(){},runExitHandlers:function(){for(;Fe.threadExitHandlers.length>0;)Fe.threadExitHandlers.pop()();w&&Vt()&&Wt()},runExitHandlersAndDeinitThread:function(e,t){Atomics.store(o(),e+56>>2,1),Atomics.store(o(),e+60>>2,0),Fe.runExitHandlers(),Atomics.store(o(),e+4>>2,t),Atomics.store(o(),e+0>>2,1),Ae(e+0,2147483647),Xt(0,0,0)},threadExit:function(e){var t=Vt();t&&(Fe.runExitHandlersAndDeinitThread(t,e),w&&postMessage({cmd:"exit"}))},threadCancel:function(){Fe.runExitHandlersAndDeinitThread(Vt(),-1),postMessage({cmd:"cancelDone"})},terminateAllThreads:function(){for(var e in Fe.pthreads)(r=Fe.pthreads[e])&&r.worker&&Fe.returnWorkerToPool(r.worker);Fe.pthreads={};for(var t=0;t<Fe.unusedWorkers.length;++t)(n=Fe.unusedWorkers[t]).terminate();for(Fe.unusedWorkers=[],t=0;t<Fe.runningWorkers.length;++t){var n,r=(n=Fe.runningWorkers[t]).pthread;Fe.freeThreadData(r),n.terminate()}Fe.runningWorkers=[]},freeThreadData:function(e){if(e){if(e.threadInfoStruct){var t=s()[e.threadInfoStruct+100>>2];s()[e.threadInfoStruct+100>>2]=0,Lt(t),Lt(e.threadInfoStruct)}e.threadInfoStruct=0,e.allocatedOwnStack&&e.stackBase&&Lt(e.stackBase),e.stackBase=0,e.worker&&(e.worker.pthread=null)}},returnWorkerToPool:function(e){Fe.runWithoutMainThreadQueuedCalls((function(){delete Fe.pthreads[e.pthread.threadInfoStruct],Fe.unusedWorkers.push(e),Fe.runningWorkers.splice(Fe.runningWorkers.indexOf(e),1),Fe.freeThreadData(e.pthread),e.pthread=void 0}))},runWithoutMainThreadQueuedCalls:function(e){s()[rn>>2]=0;try{e()}finally{s()[rn>>2]=1}},receiveObjectTransfer:function(e){},loadWasmModuleToWorker:function(e,t){e.onmessage=function(n){var r=n.data,a=r.cmd;if(e.pthread&&(Fe.currentProxiedOperationCallerThread=e.pthread.threadInfoStruct),r.targetThread&&r.targetThread!=Vt()){var s=Fe.pthreads[r.targetThread];return s?s.worker.postMessage(n.data,r.transferList):console.error('Internal error! Worker sent a message "'+a+'" to target pthread '+r.targetThread+", but that thread no longer exists!"),void(Fe.currentProxiedOperationCallerThread=void 0)}if("processQueuedMainThreadWork"===a)Ht();else if("spawnThread"===a)Ct(n.data);else if("cleanupThread"===a)Re(r.thread);else if("killThread"===a)Me(r.thread);else if("cancelThread"===a)Ce(r.thread);else if("loaded"===a)e.loaded=!0,t&&t(e),e.runPthread&&(e.runPthread(),delete e.runPthread);else if("print"===a)O("Thread "+r.threadId+": "+r.text);else if("printErr"===a)A("Thread "+r.threadId+": "+r.text);else if("alert"===a)alert("Thread "+r.threadId+": "+r.text);else if("exit"===a)e.pthread&&Atomics.load(o(),e.pthread.threadInfoStruct+64>>2)&&Fe.returnWorkerToPool(e);else if("exitProcess"===a)try{un(r.returnCode)}catch(n){if(n instanceof sn)return;throw n}else"cancelDone"===a?Fe.returnWorkerToPool(e):"objectTransfer"===a?Fe.receiveObjectTransfer(n.data):"setimmediate"===n.data.target?e.postMessage(n.data):A("worker sent an unknown command "+a);Fe.currentProxiedOperationCallerThread=void 0},e.onerror=function(e){A("pthread sent an error! "+e.filename+":"+e.lineno+": "+e.message)},g&&(e.on("message",(function(t){e.onmessage({data:t})})),e.on("error",(function(t){e.onerror(t)})),e.on("exit",(function(e){}))),e.postMessage({cmd:"load",urlOrBlob:l.mainScriptUrlOrBlob||r,wasmMemory:M,wasmModule:C})},allocateUnusedWorker:function(){var e=T("tfjs-backend-wasm-threaded-simd.worker.js");Fe.unusedWorkers.push(new Worker(e))},getNewWorker:function(){return 0==Fe.unusedWorkers.length&&(Fe.allocateUnusedWorker(),Fe.loadWasmModuleToWorker(Fe.unusedWorkers[0])),Fe.unusedWorkers.length>0?Fe.unusedWorkers.pop():null},busySpinWait:function(e){for(var t=performance.now()+e;performance.now()<t;);}};function $e(e,t){tn(e,t),Qt(e)}function Pe(){return R}function je(e,t){return Q.get(e)(t)}function Be(e,t,n,r){ge("Assertion failed: "+U(e)+", at: "+[t?U(t):"unknown filename",n,r?U(r):"unknown function"])}function Le(e,t){_main(e,t)}function qe(e){return s()[qt()>>2]=e,e}function ze(e,t){if(w)return Ye(1,1,e,t)}function Ve(e,t){if(e==t)postMessage({cmd:"processQueuedMainThreadWork"});else if(w)postMessage({targetThread:e,cmd:"processThreadQueue"});else{var n=Fe.pthreads[e],r=n&&n.worker;if(!r)return;r.postMessage({cmd:"processThreadQueue"})}return 1}function We(){ge()}function He(e,t,n){var r=Qe(t,n);return Ee[e].apply(null,r)}function Ue(e,t){}function Ke(e,n,r){if(e<=0||e>t().length||!0&e)return-28;if(m){if(Atomics.load(s(),e>>2)!=n)return-6;var a=performance.now(),o=a+r;for(Atomics.exchange(s(),an>>2,e);;){if((a=performance.now())>o)return Atomics.exchange(s(),an>>2,0),-73;if(0==Atomics.exchange(s(),an>>2,0))break;if(Ht(),Atomics.load(s(),e>>2)!=n)return-6;Atomics.exchange(s(),an>>2,e)}return 0}var i=Atomics.wait(s(),e>>2,n,r);if("timed-out"===i)return-73;if("not-equal"===i)return-6;if("ok"===i)return 0;throw"Atomics.wait returned an unexpected value "+i}function Ge(e,t,n){a().copyWithin(e,t,t+n)}function Je(){return g?n(2578).cpus().length:navigator.hardwareConcurrency}function Ye(e,t){for(var n=arguments.length-2,r=Zt(),a=n,s=en(8*a),o=s>>3,u=0;u<n;u++){var c=arguments[2+u];i()[o+u]=c}var l=Jt(e,a,s,t);return Qt(r),l}l.establishStackSpace=$e,l.getNoExitRuntime=Pe,l.invokeEntryPoint=je,De=g?function(){var e=process.hrtime();return 1e3*e[0]+e[1]/1e6}:w?function(){return performance.now()-l.__performance_now_clock_drift}:"undefined"!=typeof dateNow?dateNow:function(){return performance.now()};var Xe=[],Ze=[];function Qe(e,t){var n;for(Ze.length=0,t>>=2;n=a()[e++];){var r=n<105;r&&1&t&&t++,Ze.push(r?i()[t++>>1]:s()[t]),++t}return Ze}function et(e,t,n){Xe.length=t;for(var r=n>>3,a=0;a<t;a++)Xe[a]=i()[r+a];return(e<0?Ee[-e-1]:$t[e]).apply(null,Xe)}function tt(){return a().length}function nt(e){try{return M.grow(e-D.byteLength+65535>>>16),Z(M.buffer),1}catch(e){}}function rt(e){var t=tt();if(e<=t)return!1;var n=2147483648;if(e>n)return!1;for(var r=1;r<=4;r*=2){var a=t*(1+.2/r);if(a=Math.min(a,e+100663296),nt(Math.min(n,X(Math.max(e,a),65536))))return!0}return!1}var at={inEventHandler:0,removeAllEventListeners:function(){for(var e=at.eventHandlers.length-1;e>=0;--e)at._removeHandler(e);at.eventHandlers=[],at.deferredCalls=[]},registerRemoveEventListeners:function(){at.removeEventListenersRegistered||(ae.push(at.removeAllEventListeners),at.removeEventListenersRegistered=!0)},deferredCalls:[],deferCall:function(e,t,n){function r(e,t){if(e.length!=t.length)return!1;for(var n in e)if(e[n]!=t[n])return!1;return!0}for(var a in at.deferredCalls){var s=at.deferredCalls[a];if(s.targetFunction==e&&r(s.argsList,n))return}at.deferredCalls.push({targetFunction:e,precedence:t,argsList:n}),at.deferredCalls.sort((function(e,t){return e.precedence<t.precedence}))},removeDeferredCalls:function(e){for(var t=0;t<at.deferredCalls.length;++t)at.deferredCalls[t].targetFunction==e&&(at.deferredCalls.splice(t,1),--t)},canPerformEventHandlerRequests:function(){return at.inEventHandler&&at.currentEventHandler.allowsDeferredCalls},runDeferredCalls:function(){if(at.canPerformEventHandlerRequests())for(var e=0;e<at.deferredCalls.length;++e){var t=at.deferredCalls[e];at.deferredCalls.splice(e,1),--e,t.targetFunction.apply(null,t.argsList)}},eventHandlers:[],removeAllHandlersOnTarget:function(e,t){for(var n=0;n<at.eventHandlers.length;++n)at.eventHandlers[n].target!=e||t&&t!=at.eventHandlers[n].eventTypeString||at._removeHandler(n--)},_removeHandler:function(e){var t=at.eventHandlers[e];t.target.removeEventListener(t.eventTypeString,t.eventListenerFunc,t.useCapture),at.eventHandlers.splice(e,1)},registerOrRemoveHandler:function(e){var t=function(t){++at.inEventHandler,at.currentEventHandler=e,at.runDeferredCalls(),e.handlerFunc(t),at.runDeferredCalls(),--at.inEventHandler};if(e.callbackfunc)e.eventListenerFunc=t,e.target.addEventListener(e.eventTypeString,t,e.useCapture),at.eventHandlers.push(e),at.registerRemoveEventListeners();else for(var n=0;n<at.eventHandlers.length;++n)at.eventHandlers[n].target==e.target&&at.eventHandlers[n].eventTypeString==e.eventTypeString&&at._removeHandler(n--)},queueEventHandlerOnThread_iiii:function(e,t,n,r,a){var o=Zt(),i=en(12);s()[i>>2]=n,s()[i+4>>2]=r,s()[i+8>>2]=a,Yt(0,e,637534208,t,r,i),Qt(o)},getTargetThreadForEventCallback:function(e){switch(e){case 1:return 0;case 2:return Fe.currentProxiedOperationCallerThread;default:return e}},getNodeNameForTarget:function(e){return e?e==window?"#window":e==screen?"#screen":e&&e.nodeName?e.nodeName:"":""},fullscreenEnabled:function(){return document.fullscreenEnabled||document.webkitFullscreenEnabled}};function st(e){var t=J(e)+1,n=Bt(t);return G(e,n,t),n}function ot(e,t,n,r){var a=Zt(),o=en(12),i=0;t&&(i=st(t)),s()[o>>2]=i,s()[o+4>>2]=n,s()[o+8>>2]=r,Yt(0,e,657457152,0,i,o),Qt(a)}function it(e,t,n,r){ot(e,t=t?U(t):"",n,r)}function ut(e){return e>2?U(e):e}var ct=[0,"undefined"!=typeof document?document:0,"undefined"!=typeof window?window:0];function lt(e){return e=ut(e),ct[e]||("undefined"!=typeof document?document.querySelector(e):void 0)}function pt(e){return lt(e)}function dt(e,t,n){var r=pt(e);if(!r)return-4;if(r.canvasSharedPtr&&(s()[r.canvasSharedPtr>>2]=t,s()[r.canvasSharedPtr+4>>2]=n),!r.offscreenCanvas&&r.controlTransferredOffscreen)return r.canvasSharedPtr?(it(s()[r.canvasSharedPtr+8>>2],e,t,n),1):-4;r.offscreenCanvas&&(r=r.offscreenCanvas);var a=!1;if(r.GLctxObject&&r.GLctxObject.GLctx){var o=r.GLctxObject.GLctx.getParameter(2978);a=0===o[0]&&0===o[1]&&o[2]===r.width&&o[3]===r.height}return r.width=t,r.height=n,a&&r.GLctxObject.GLctx.viewport(0,0,t,n),0}function ht(e,t,n){return w?Ye(2,1,e,t,n):dt(e,t,n)}function ft(e,t,n){return pt(e)?dt(e,t,n):ht(e,t,n)}function mt(e){}function yt(e,t){}function gt(e){var t=e.getExtension("ANGLE_instanced_arrays");if(t)return e.vertexAttribDivisor=function(e,n){t.vertexAttribDivisorANGLE(e,n)},e.drawArraysInstanced=function(e,n,r,a){t.drawArraysInstancedANGLE(e,n,r,a)},e.drawElementsInstanced=function(e,n,r,a,s){t.drawElementsInstancedANGLE(e,n,r,a,s)},1}function bt(e){var t=e.getExtension("OES_vertex_array_object");if(t)return e.createVertexArray=function(){return t.createVertexArrayOES()},e.deleteVertexArray=function(e){t.deleteVertexArrayOES(e)},e.bindVertexArray=function(e){t.bindVertexArrayOES(e)},e.isVertexArray=function(e){return t.isVertexArrayOES(e)},1}function wt(e){var t=e.getExtension("WEBGL_draw_buffers");if(t)return e.drawBuffers=function(e,n){t.drawBuffersWEBGL(e,n)},1}function vt(e){return!!(e.multiDrawWebgl=e.getExtension("WEBGL_multi_draw"))}var xt={counter:1,buffers:[],programs:[],framebuffers:[],renderbuffers:[],textures:[],uniforms:[],shaders:[],vaos:[],contexts:{},offscreenCanvases:{},timerQueriesEXT:[],programInfos:{},stringCache:{},unpackAlignment:4,recordError:function(e){xt.lastError||(xt.lastError=e)},getNewId:function(e){for(var t=xt.counter++,n=e.length;n<t;n++)e[n]=null;return t},getSource:function(e,t,n,r){for(var a="",o=0;o<t;++o){var i=r?s()[r+4*o>>2]:-1;a+=U(s()[n+4*o>>2],i<0?void 0:i)}return a},createContext:function(e,t){var n=e.getContext("webgl",t);return n?xt.registerContext(n,t):0},registerContext:function(e,t){var n=Bt(8);s()[n+4>>2]=Vt();var r={handle:n,attributes:t,version:t.majorVersion,GLctx:e};return e.canvas&&(e.canvas.GLctxObject=r),xt.contexts[n]=r,(void 0===t.enableExtensionsByDefault||t.enableExtensionsByDefault)&&xt.initExtensions(r),n},makeContextCurrent:function(e){return xt.currentContext=xt.contexts[e],l.ctx=Nt=xt.currentContext&&xt.currentContext.GLctx,!(e&&!Nt)},getContext:function(e){return xt.contexts[e]},deleteContext:function(e){xt.currentContext===xt.contexts[e]&&(xt.currentContext=null),"object"==typeof at&&at.removeAllHandlersOnTarget(xt.contexts[e].GLctx.canvas),xt.contexts[e]&&xt.contexts[e].GLctx.canvas&&(xt.contexts[e].GLctx.canvas.GLctxObject=void 0),Lt(xt.contexts[e].handle),xt.contexts[e]=null},initExtensions:function(e){if(e||(e=xt.currentContext),!e.initExtensionsDone){e.initExtensionsDone=!0;var t=e.GLctx;gt(t),bt(t),wt(t),t.disjointTimerQueryExt=t.getExtension("EXT_disjoint_timer_query"),vt(t),(t.getSupportedExtensions()||[]).forEach((function(e){e.indexOf("lose_context")<0&&e.indexOf("debug")<0&&t.getExtension(e)}))}},populateUniformTable:function(e){for(var t=xt.programs[e],n=xt.programInfos[e]={uniforms:{},maxUniformLength:0,maxAttributeLength:-1,maxUniformBlockNameLength:-1},r=n.uniforms,a=Nt.getProgramParameter(t,35718),s=0;s<a;++s){var o=Nt.getActiveUniform(t,s),i=o.name;n.maxUniformLength=Math.max(n.maxUniformLength,i.length+1),"]"==i.slice(-1)&&(i=i.slice(0,i.lastIndexOf("[")));var u=Nt.getUniformLocation(t,i);if(u){var c=xt.getNewId(xt.uniforms);r[i]=[o.size,c],xt.uniforms[c]=u;for(var l=1;l<o.size;++l){var p=i+"["+l+"]";u=Nt.getUniformLocation(t,p),c=xt.getNewId(xt.uniforms),xt.uniforms[c]=u}}}}},kt=["default","low-power","high-performance"];function _t(e,t){var n=t>>2,r=s()[n+6],a={alpha:!!s()[n+0],depth:!!s()[n+1],stencil:!!s()[n+2],antialias:!!s()[n+3],premultipliedAlpha:!!s()[n+4],preserveDrawingBuffer:!!s()[n+5],powerPreference:kt[r],failIfMajorPerformanceCaveat:!!s()[n+7],majorVersion:s()[n+8],minorVersion:s()[n+9],enableExtensionsByDefault:s()[n+10],explicitSwapControl:s()[n+11],proxyContextToMainThread:s()[n+12],renderViaOffscreenBackBuffer:s()[n+13]},o=pt(e);return o?a.explicitSwapControl?0:xt.createContext(o,a):0}function St(e,t){return _t(e,t)}var Nt,Tt={mappings:{},buffers:[null,[],[]],printChar:function(e,t){var n=Tt.buffers[e];0===t||10===t?((1===e?O:A)(H(n,0)),n.length=0):n.push(t)},varargs:void 0,get:function(){return Tt.varargs+=4,s()[Tt.varargs-4>>2]},getStr:function(e){return U(e)},get64:function(e,t){return e}};function Et(e){return w?Ye(3,1,e):0}function It(e,t,n,r,a){if(w)return Ye(4,1,e,t,n,r,a)}function Ot(e,t,n,r){if(w)return Ye(5,1,e,t,n,r);for(var o=0,i=0;i<n;i++){for(var u=s()[t+8*i>>2],c=s()[t+(8*i+4)>>2],l=0;l<c;l++)Tt.printChar(e,a()[u+l]);o+=c}return s()[r>>2]=o,0}function At(e){var t=Fe.threadExitHandlers.pop();e&&t()}function Mt(e,t){Fe.threadExitHandlers.push((function(){Q.get(e)(t)}))}function Ct(e){if(w)throw"Internal Error! spawnThread() can only ever be called from main application thread!";var t=Fe.getNewWorker();if(void 0!==t.pthread)throw"Internal error!";if(!e.pthread_ptr)throw"Internal error, no pthread ptr!";Fe.runningWorkers.push(t);for(var n=Bt(512),r=0;r<128;++r)s()[n+4*r>>2]=0;var a=e.stackBase+e.stackSize,i=Fe.pthreads[e.pthread_ptr]={worker:t,stackBase:e.stackBase,stackSize:e.stackSize,allocatedOwnStack:e.allocatedOwnStack,threadInfoStruct:e.pthread_ptr},u=i.threadInfoStruct>>2;Atomics.store(o(),u+16,e.detached),Atomics.store(o(),u+25,n),Atomics.store(o(),u+10,i.threadInfoStruct),Atomics.store(o(),u+20,e.stackSize),Atomics.store(o(),u+19,a),Atomics.store(o(),u+26,e.stackSize),Atomics.store(o(),u+28,a),Atomics.store(o(),u+29,e.detached);var c=zt()+40;Atomics.store(o(),u+43,c),t.pthread=i;var l={cmd:"run",start_routine:e.startRoutine,arg:e.arg,threadInfoStruct:e.pthread_ptr,stackBase:e.stackBase,stackSize:e.stackSize};t.runPthread=function(){l.time=performance.now(),t.postMessage(l,e.transferList)},t.loaded&&(t.runPthread(),delete t.runPthread)}function Rt(e,t,n,r){if("undefined"==typeof SharedArrayBuffer)return A("Current environment does not support SharedArrayBuffer, pthreads are not available!"),6;if(!e)return A("pthread_create called with a null thread pointer!"),28;var a=[];if(w&&0===a.length)return Gt(687865856,e,t,n,r);var i=0,u=0,c=0;t&&-1!=t?(i=s()[t>>2],i+=81920,u=s()[t+8>>2],c=0!==s()[t+12>>2]):i=2097152;var l=0==u;l?u=nn(16,i):q((u-=i)>0);for(var p=Bt(228),d=0;d<57;++d)o()[(p>>2)+d]=0;s()[e>>2]=p,s()[p+12>>2]=p;var h=p+152;s()[h>>2]=h;var f={stackBase:u,stackSize:i,allocatedOwnStack:l,detached:c,startRoutine:n,pthread_ptr:p,arg:r,transferList:a};return w?(f.cmd="spawnThread",postMessage(f,a)):Ct(f),0}function Dt(e){if(w)return Ye(6,1,e);switch(e){case 30:return 16384;case 85:return 131072;case 132:case 133:case 12:case 137:case 138:case 15:case 235:case 16:case 17:case 18:case 19:case 20:case 149:case 13:case 10:case 236:case 153:case 9:case 21:case 22:case 159:case 154:case 14:case 77:case 78:case 139:case 82:case 68:case 67:case 164:case 11:case 29:case 47:case 48:case 95:case 52:case 51:case 46:return 200809;case 27:case 246:case 127:case 128:case 23:case 24:case 160:case 161:case 181:case 182:case 242:case 183:case 184:case 243:case 244:case 245:case 165:case 178:case 179:case 49:case 50:case 168:case 169:case 175:case 170:case 171:case 172:case 97:case 76:case 32:case 173:case 35:case 80:case 81:case 79:return-1;case 176:case 177:case 7:case 155:case 8:case 157:case 125:case 126:case 92:case 93:case 129:case 130:case 131:case 94:case 91:return 1;case 74:case 60:case 69:case 70:case 4:return 1024;case 31:case 42:case 72:return 32;case 87:case 26:case 33:return 2147483647;case 34:case 1:return 47839;case 38:case 36:return 99;case 43:case 37:return 2048;case 0:return 2097152;case 3:return 65536;case 28:return 32768;case 44:return 32767;case 75:return 16384;case 39:return 1e3;case 89:return 700;case 71:return 256;case 40:return 255;case 2:return 100;case 180:return 64;case 25:return 20;case 5:return 16;case 6:return 6;case 73:return 4;case 84:return"object"==typeof navigator&&navigator.hardwareConcurrency||1}return qe(28),-1}w||Fe.initMainThreadBlock();var Ft,$t=[null,ze,ht,Et,It,Ot,Dt],Pt={e:Be,r:Le,x:Ve,b:We,y:He,j:Ue,c:Ke,d:Ae,f:De,p:Ge,z:Je,u:et,q:rt,v:ft,i:mt,t:yt,w:St,m:Et,n:It,g:Ot,o:Ie,a:M||l.wasmMemory,k:At,l:Mt,h:Rt,s:Dt},jt=(Te(),l.___wasm_call_ctors=function(){return(jt=l.___wasm_call_ctors=l.asm.A).apply(null,arguments)}),Bt=(l._init=function(){return(l._init=l.asm.B).apply(null,arguments)},l._register_tensor=function(){return(l._register_tensor=l.asm.C).apply(null,arguments)},l._dispose_data=function(){return(l._dispose_data=l.asm.D).apply(null,arguments)},l._dispose=function(){return(l._dispose=l.asm.E).apply(null,arguments)},l._Abs=function(){return(l._Abs=l.asm.G).apply(null,arguments)},l._Add=function(){return(l._Add=l.asm.H).apply(null,arguments)},l._AddN=function(){return(l._AddN=l.asm.I).apply(null,arguments)},l._All=function(){return(l._All=l.asm.J).apply(null,arguments)},l._Any=function(){return(l._Any=l.asm.K).apply(null,arguments)},l._ArgMax=function(){return(l._ArgMax=l.asm.L).apply(null,arguments)},l._AvgPool=function(){return(l._AvgPool=l.asm.M).apply(null,arguments)},l._BatchMatMul=function(){return(l._BatchMatMul=l.asm.N).apply(null,arguments)},l._Ceil=function(){return(l._Ceil=l.asm.O).apply(null,arguments)},l._ClipByValue=function(){return(l._ClipByValue=l.asm.P).apply(null,arguments)},l._Conv2D=function(){return(l._Conv2D=l.asm.Q).apply(null,arguments)},l._Conv2DBackpropInput=function(){return(l._Conv2DBackpropInput=l.asm.R).apply(null,arguments)},l._Cos=function(){return(l._Cos=l.asm.S).apply(null,arguments)},l._Cosh=function(){return(l._Cosh=l.asm.T).apply(null,arguments)},l._CropAndResize=function(){return(l._CropAndResize=l.asm.U).apply(null,arguments)},l._Cumsum=function(){return(l._Cumsum=l.asm.V).apply(null,arguments)},l._DepthToSpace=function(){return(l._DepthToSpace=l.asm.W).apply(null,arguments)},l._DepthwiseConv2dNative=function(){return(l._DepthwiseConv2dNative=l.asm.X).apply(null,arguments)},l._Elu=function(){return(l._Elu=l.asm.Y).apply(null,arguments)},l._Equal=function(){return(l._Equal=l.asm.Z).apply(null,arguments)},l._Exp=function(){return(l._Exp=l.asm._).apply(null,arguments)},l._FlipLeftRight=function(){return(l._FlipLeftRight=l.asm.$).apply(null,arguments)},l._Floor=function(){return(l._Floor=l.asm.aa).apply(null,arguments)},l._FloorDiv=function(){return(l._FloorDiv=l.asm.ba).apply(null,arguments)},l._FusedBatchNorm=function(){return(l._FusedBatchNorm=l.asm.ca).apply(null,arguments)},l._FusedConv2D=function(){return(l._FusedConv2D=l.asm.da).apply(null,arguments)},l._FusedDepthwiseConv2D=function(){return(l._FusedDepthwiseConv2D=l.asm.ea).apply(null,arguments)},l._Gather=function(){return(l._Gather=l.asm.fa).apply(null,arguments)},l._GatherNd=function(){return(l._GatherNd=l.asm.ga).apply(null,arguments)},l._Greater=function(){return(l._Greater=l.asm.ha).apply(null,arguments)},l._GreaterEqual=function(){return(l._GreaterEqual=l.asm.ia).apply(null,arguments)},l._LeakyRelu=function(){return(l._LeakyRelu=l.asm.ja).apply(null,arguments)},l._Less=function(){return(l._Less=l.asm.ka).apply(null,arguments)},l._LessEqual=function(){return(l._LessEqual=l.asm.la).apply(null,arguments)},l._Log=function(){return(l._Log=l.asm.ma).apply(null,arguments)},l._LogicalAnd=function(){return(l._LogicalAnd=l.asm.na).apply(null,arguments)},l._Max=function(){return(l._Max=l.asm.oa).apply(null,arguments)},l._MaxPool=function(){return(l._MaxPool=l.asm.pa).apply(null,arguments)},l._Maximum=function(){return(l._Maximum=l.asm.qa).apply(null,arguments)},l._Mean=function(){return(l._Mean=l.asm.ra).apply(null,arguments)},l._Min=function(){return(l._Min=l.asm.sa).apply(null,arguments)},l._Minimum=function(){return(l._Minimum=l.asm.ta).apply(null,arguments)},l._MirrorPad=function(){return(l._MirrorPad=l.asm.ua).apply(null,arguments)},l._Multiply=function(){return(l._Multiply=l.asm.va).apply(null,arguments)},l._Neg=function(){return(l._Neg=l.asm.wa).apply(null,arguments)},l._NonMaxSuppressionV3=function(){return(l._NonMaxSuppressionV3=l.asm.xa).apply(null,arguments)},l._NonMaxSuppressionV4=function(){return(l._NonMaxSuppressionV4=l.asm.ya).apply(null,arguments)},l._NonMaxSuppressionV5=function(){return(l._NonMaxSuppressionV5=l.asm.za).apply(null,arguments)},l._NotEqual=function(){return(l._NotEqual=l.asm.Aa).apply(null,arguments)},l._OneHot=function(){return(l._OneHot=l.asm.Ba).apply(null,arguments)},l._PadV2=function(){return(l._PadV2=l.asm.Ca).apply(null,arguments)},l._Pow=function(){return(l._Pow=l.asm.Da).apply(null,arguments)},l._Prelu=function(){return(l._Prelu=l.asm.Ea).apply(null,arguments)},l._Prod=function(){return(l._Prod=l.asm.Fa).apply(null,arguments)},l._RealDiv=function(){return(l._RealDiv=l.asm.Ga).apply(null,arguments)},l._Relu=function(){return(l._Relu=l.asm.Ha).apply(null,arguments)},l._Relu6=function(){return(l._Relu6=l.asm.Ia).apply(null,arguments)},l._ResizeBilinear=function(){return(l._ResizeBilinear=l.asm.Ja).apply(null,arguments)},l._Reverse=function(){return(l._Reverse=l.asm.Ka).apply(null,arguments)},l._RotateWithOffset=function(){return(l._RotateWithOffset=l.asm.La).apply(null,arguments)},l._Round=function(){return(l._Round=l.asm.Ma).apply(null,arguments)},l._Rsqrt=function(){return(l._Rsqrt=l.asm.Na).apply(null,arguments)},l._ScatterNd=function(){return(l._ScatterNd=l.asm.Oa).apply(null,arguments)},l._SelectV2=function(){return(l._SelectV2=l.asm.Pa).apply(null,arguments)},l._Sigmoid=function(){return(l._Sigmoid=l.asm.Qa).apply(null,arguments)},l._Sin=function(){return(l._Sin=l.asm.Ra).apply(null,arguments)},l._Softmax=function(){return(l._Softmax=l.asm.Sa).apply(null,arguments)},l._Sqrt=function(){return(l._Sqrt=l.asm.Ta).apply(null,arguments)},l._Square=function(){return(l._Square=l.asm.Ua).apply(null,arguments)},l._SquaredDifference=function(){return(l._SquaredDifference=l.asm.Va).apply(null,arguments)},l._Step=function(){return(l._Step=l.asm.Wa).apply(null,arguments)},l._StridedSlice=function(){return(l._StridedSlice=l.asm.Xa).apply(null,arguments)},l._Sub=function(){return(l._Sub=l.asm.Ya).apply(null,arguments)},l._Sum=function(){return(l._Sum=l.asm.Za).apply(null,arguments)},l._Tan=function(){return(l._Tan=l.asm._a).apply(null,arguments)},l._Tanh=function(){return(l._Tanh=l.asm.$a).apply(null,arguments)},l._Tile=function(){return(l._Tile=l.asm.ab).apply(null,arguments)},l._TopK=function(){return(l._TopK=l.asm.bb).apply(null,arguments)},l._Transform=function(){return(l._Transform=l.asm.cb).apply(null,arguments)},l._Transpose=function(){return(l._Transpose=l.asm.db).apply(null,arguments)},l.__FusedMatMul=function(){return(l.__FusedMatMul=l.asm.eb).apply(null,arguments)},l._malloc=function(){return(Bt=l._malloc=l.asm.fb).apply(null,arguments)}),Lt=l._free=function(){return(Lt=l._free=l.asm.gb).apply(null,arguments)},qt=l.___errno_location=function(){return(qt=l.___errno_location=l.asm.hb).apply(null,arguments)},zt=l._emscripten_get_global_libc=function(){return(zt=l._emscripten_get_global_libc=l.asm.ib).apply(null,arguments)},Vt=l._pthread_self=function(){return(Vt=l._pthread_self=l.asm.jb).apply(null,arguments)},Wt=l.___pthread_tsd_run_dtors=function(){return(Wt=l.___pthread_tsd_run_dtors=l.asm.kb).apply(null,arguments)},Ht=l._emscripten_main_thread_process_queued_calls=function(){return(Ht=l._emscripten_main_thread_process_queued_calls=l.asm.lb).apply(null,arguments)},Ut=(l._emscripten_current_thread_process_queued_calls=function(){return(l._emscripten_current_thread_process_queued_calls=l.asm.mb).apply(null,arguments)},l._emscripten_register_main_browser_thread_id=function(){return(Ut=l._emscripten_register_main_browser_thread_id=l.asm.nb).apply(null,arguments)}),Kt=l.__emscripten_do_dispatch_to_thread=function(){return(Kt=l.__emscripten_do_dispatch_to_thread=l.asm.ob).apply(null,arguments)},Gt=l._emscripten_sync_run_in_main_thread_4=function(){return(Gt=l._emscripten_sync_run_in_main_thread_4=l.asm.pb).apply(null,arguments)},Jt=l._emscripten_run_in_main_runtime_thread_js=function(){return(Jt=l._emscripten_run_in_main_runtime_thread_js=l.asm.qb).apply(null,arguments)},Yt=l.__emscripten_call_on_thread=function(){return(Yt=l.__emscripten_call_on_thread=l.asm.rb).apply(null,arguments)},Xt=(l._emscripten_tls_init=function(){return(l._emscripten_tls_init=l.asm.sb).apply(null,arguments)},l.__emscripten_thread_init=function(){return(Xt=l.__emscripten_thread_init=l.asm.tb).apply(null,arguments)}),Zt=l.stackSave=function(){return(Zt=l.stackSave=l.asm.ub).apply(null,arguments)},Qt=l.stackRestore=function(){return(Qt=l.stackRestore=l.asm.vb).apply(null,arguments)},en=l.stackAlloc=function(){return(en=l.stackAlloc=l.asm.wb).apply(null,arguments)},tn=l._emscripten_stack_set_limits=function(){return(tn=l._emscripten_stack_set_limits=l.asm.xb).apply(null,arguments)},nn=l._memalign=function(){return(nn=l._memalign=l.asm.yb).apply(null,arguments)},rn=l.__emscripten_allow_main_runtime_queued_calls=10016,an=l.__emscripten_main_thread_futex=11652;function sn(e){this.name="ExitStatus",this.message="Program terminated with exit("+e+")",this.status=e}function on(e){if(e=e||h,!(de>0)){if(w)return u(l),ie(),void postMessage({cmd:"loaded"});oe(),de>0||(l.setStatus?(l.setStatus("Running..."),setTimeout((function(){setTimeout((function(){l.setStatus("")}),1),t()}),1)):t())}function t(){Ft||(Ft=!0,l.calledRun=!0,L||(ie(),ue(),u(l),l.onRuntimeInitialized&&l.onRuntimeInitialized(),ce()))}}function un(e,t){if(!t||!R||0!==e){if(!t&&w)throw postMessage({cmd:"exitProcess",returnCode:e}),new sn(e);R||(Fe.terminateAllThreads(),l.onExit&&l.onExit(e),L=!0),f(e,new sn(e))}}if(l.cwrap=W,l.PThread=Fe,l.PThread=Fe,l.wasmMemory=M,l.ExitStatus=sn,fe=function e(){Ft||on(),Ft||(fe=e)},l.run=on,l.preInit)for("function"==typeof l.preInit&&(l.preInit=[l.preInit]);l.preInit.length>0;)l.preInit.pop()();return w&&(R=!1,Fe.initWorker()),on(),e.ready});e.exports=a},573:function(e,t,n){var r,a=(r=(r="undefined"!=typeof document&&document.currentScript?document.currentScript.src:void 0)||"/index.js",function(e){var t,a,s=void 0!==(e=e||{})?e:{};s.ready=new Promise((function(e,n){t=e,a=n}));var o,i={};for(o in s)s.hasOwnProperty(o)&&(i[o]=s[o]);var u=[],c=!1,l=!1,p=!1,d=!1;c="object"==typeof window,l="function"==typeof importScripts,p="object"==typeof process&&"object"==typeof process.versions&&"string"==typeof process.versions.node,d=!c&&!p&&!l;var h,f,m,y,g,b="";function w(e){return s.locateFile?s.locateFile(e,b):b+e}p?(b=l?n(2980).dirname(b)+"/":"//",h=function(e,t){return y||(y=n(7256)),g||(g=n(2980)),e=g.normalize(e),y.readFileSync(e,t?null:"utf8")},m=function(e){var t=h(e,!0);return t.buffer||(t=new Uint8Array(t)),N(t.buffer),t},process.argv.length>1&&process.argv[1].replace(/\\/g,"/"),u=process.argv.slice(2),process.on("uncaughtException",(function(e){if(!(e instanceof Re))throw e})),process.on("unhandledRejection",re),s.inspect=function(){return"[Emscripten Module object]"}):d?("undefined"!=typeof read&&(h=function(e){return read(e)}),m=function(e){var t;return"function"==typeof readbuffer?new Uint8Array(readbuffer(e)):(N("object"==typeof(t=read(e,"binary"))),t)},"undefined"!=typeof scriptArgs?u=scriptArgs:void 0!==arguments&&(u=arguments),"undefined"!=typeof print&&("undefined"==typeof console&&(console={}),console.log=print,console.warn=console.error="undefined"!=typeof printErr?printErr:print)):(c||l)&&(l?b=self.location.href:"undefined"!=typeof document&&document.currentScript&&(b=document.currentScript.src),r&&(b=r),b=0!==b.indexOf("blob:")?b.substr(0,b.lastIndexOf("/")+1):"",h=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},l&&(m=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),f=function(e,t,n){var r=new XMLHttpRequest;r.open("GET",e,!0),r.responseType="arraybuffer",r.onload=function(){200==r.status||0==r.status&&r.response?t(r.response):n()},r.onerror=n,r.send(null)});var v,x,k=s.print||console.log.bind(console),_=s.printErr||console.warn.bind(console);for(o in i)i.hasOwnProperty(o)&&(s[o]=i[o]);i=null,s.arguments&&(u=s.arguments),s.thisProgram&&s.thisProgram,s.quit&&s.quit,s.wasmBinary&&(v=s.wasmBinary),s.noExitRuntime,"object"!=typeof WebAssembly&&re("no native wasm support detected");var S=!1;function N(e,t){e||re("Assertion failed: "+t)}function T(e){var t=s["_"+e];return N(t,"Cannot call unknown function "+e+", make sure it is exported"),t}function E(e,t,n,r,a){var s={string:function(e){var t=0;if(null!=e&&0!==e){var n=1+(e.length<<2);P(e,t=Ce(n),n)}return t},array:function(e){var t=Ce(e.length);return j(e,t),t}},o=T(e),i=[],u=0;if(r)for(var c=0;c<r.length;c++){var l=s[n[c]];l?(0===u&&(u=Ae()),i[c]=l(r[c])):i[c]=r[c]}var p=o.apply(null,i);return p=function(e){return"string"===t?F(e):"boolean"===t?Boolean(e):e}(p),0!==u&&Me(u),p}function I(e,t,n,r){var a=(n=n||[]).every((function(e){return"number"===e}));return"string"!==t&&a&&!r?T(e):function(){return E(e,t,n,arguments)}}var O,A,M,C,R="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;function D(e,t,n){for(var r=t+n,a=t;e[a]&&!(a>=r);)++a;if(a-t>16&&e.subarray&&R)return R.decode(e.subarray(t,a));for(var s="";t<a;){var o=e[t++];if(128&o){var i=63&e[t++];if(192!=(224&o)){var u=63&e[t++];if((o=224==(240&o)?(15&o)<<12|i<<6|u:(7&o)<<18|i<<12|u<<6|63&e[t++])<65536)s+=String.fromCharCode(o);else{var c=o-65536;s+=String.fromCharCode(55296|c>>10,56320|1023&c)}}else s+=String.fromCharCode((31&o)<<6|i)}else s+=String.fromCharCode(o)}return s}function F(e,t){return e?D(M,e,t):""}function $(e,t,n,r){if(!(r>0))return 0;for(var a=n,s=n+r-1,o=0;o<e.length;++o){var i=e.charCodeAt(o);if(i>=55296&&i<=57343&&(i=65536+((1023&i)<<10)|1023&e.charCodeAt(++o)),i<=127){if(n>=s)break;t[n++]=i}else if(i<=2047){if(n+1>=s)break;t[n++]=192|i>>6,t[n++]=128|63&i}else if(i<=65535){if(n+2>=s)break;t[n++]=224|i>>12,t[n++]=128|i>>6&63,t[n++]=128|63&i}else{if(n+3>=s)break;t[n++]=240|i>>18,t[n++]=128|i>>12&63,t[n++]=128|i>>6&63,t[n++]=128|63&i}}return t[n]=0,n-a}function P(e,t,n){return $(e,M,t,n)}function j(e,t){A.set(e,t)}function B(e,t){return e%t>0&&(e+=t-e%t),e}function L(e){O=e,s.HEAP8=A=new Int8Array(e),s.HEAP16=new Int16Array(e),s.HEAP32=C=new Int32Array(e),s.HEAPU8=M=new Uint8Array(e),s.HEAPU16=new Uint16Array(e),s.HEAPU32=new Uint32Array(e),s.HEAPF32=new Float32Array(e),s.HEAPF64=new Float64Array(e)}s.INITIAL_MEMORY;var q,z=[],V=[],W=[],H=[];function U(){if(s.preRun)for("function"==typeof s.preRun&&(s.preRun=[s.preRun]);s.preRun.length;)Y(s.preRun.shift());he(z)}function K(){he(V)}function G(){he(W)}function J(){if(s.postRun)for("function"==typeof s.postRun&&(s.postRun=[s.postRun]);s.postRun.length;)X(s.postRun.shift());he(H)}function Y(e){z.unshift(e)}function X(e){H.unshift(e)}V.push({func:function(){Ie()}});var Z=0,Q=null,ee=null;function te(e){Z++,s.monitorRunDependencies&&s.monitorRunDependencies(Z)}function ne(e){if(Z--,s.monitorRunDependencies&&s.monitorRunDependencies(Z),0==Z&&(null!==Q&&(clearInterval(Q),Q=null),ee)){var t=ee;ee=null,t()}}function re(e){s.onAbort&&s.onAbort(e),_(e+=""),S=!0,e="abort("+e+"). Build with -s ASSERTIONS=1 for more info.";var t=new WebAssembly.RuntimeError(e);throw a(t),t}function ae(e,t){return String.prototype.startsWith?e.startsWith(t):0===e.indexOf(t)}s.preloadedImages={},s.preloadedAudios={};var se="data:application/octet-stream;base64,";function oe(e){return ae(e,se)}var ie="file://";function ue(e){return ae(e,ie)}var ce="tfjs-backend-wasm.wasm";function le(e){try{if(e==ce&&v)return new Uint8Array(v);if(m)return m(e);throw"both async and sync fetching of the wasm failed"}catch(e){re(e)}}function pe(){if(!v&&(c||l)){if("function"==typeof fetch&&!ue(ce))return fetch(ce,{credentials:"same-origin"}).then((function(e){if(!e.ok)throw"failed to load wasm binary file at '"+ce+"'";return e.arrayBuffer()})).catch((function(){return le(ce)}));if(f)return new Promise((function(e,t){f(ce,(function(t){e(new Uint8Array(t))}),t)}))}return Promise.resolve().then((function(){return le(ce)}))}function de(){var e={a:Ee};function t(e,t){var n=e.exports;s.asm=n,L((x=s.asm.i).buffer),q=s.asm.o,ne()}function n(e){t(e.instance)}function r(t){return pe().then((function(t){return WebAssembly.instantiate(t,e)})).then(t,(function(e){_("failed to asynchronously prepare wasm: "+e),re(e)}))}if(te(),s.instantiateWasm)try{return s.instantiateWasm(e,t)}catch(e){return _("Module.instantiateWasm callback failed with error: "+e),!1}return(v||"function"!=typeof WebAssembly.instantiateStreaming||oe(ce)||ue(ce)||"function"!=typeof fetch?r(n):fetch(ce,{credentials:"same-origin"}).then((function(t){return WebAssembly.instantiateStreaming(t,e).then(n,(function(e){return _("wasm streaming compile failed: "+e),_("falling back to ArrayBuffer instantiation"),r(n)}))}))).catch(a),{}}function he(e){for(;e.length>0;){var t=e.shift();if("function"!=typeof t){var n=t.func;"number"==typeof n?void 0===t.arg?q.get(n)():q.get(n)(t.arg):n(void 0===t.arg?null:t.arg)}else t(s)}}function fe(){re()}function me(e,t,n){M.copyWithin(e,t,t+n)}function ye(){return M.length}function ge(e){try{return x.grow(e-O.byteLength+65535>>>16),L(x.buffer),1}catch(e){}}function be(e){var t=ye(),n=2147483648;if(e>n)return!1;for(var r=1;r<=4;r*=2){var a=t*(1+.2/r);if(a=Math.min(a,e+100663296),ge(Math.min(n,B(Math.max(e,a),65536))))return!0}return!1}oe(ce)||(ce=w(ce));var we={mappings:{},buffers:[null,[],[]],printChar:function(e,t){var n=we.buffers[e];0===t||10===t?((1===e?k:_)(D(n,0)),n.length=0):n.push(t)},varargs:void 0,get:function(){return we.varargs+=4,C[we.varargs-4>>2]},getStr:function(e){return F(e)},get64:function(e,t){return e}};function ve(e){return 0}function xe(e,t,n,r,a){}function ke(e,t,n,r){for(var a=0,s=0;s<n;s++){for(var o=C[t+8*s>>2],i=C[t+(8*s+4)>>2],u=0;u<i;u++)we.printChar(e,M[o+u]);a+=i}return C[r>>2]=a,0}function _e(){return 6}function Se(e){return C[Oe()>>2]=e,e}function Ne(e){switch(e){case 30:return 16384;case 85:return 131072;case 132:case 133:case 12:case 137:case 138:case 15:case 235:case 16:case 17:case 18:case 19:case 20:case 149:case 13:case 10:case 236:case 153:case 9:case 21:case 22:case 159:case 154:case 14:case 77:case 78:case 139:case 82:case 68:case 67:case 164:case 11:case 29:case 47:case 48:case 95:case 52:case 51:case 46:return 200809;case 27:case 246:case 127:case 128:case 23:case 24:case 160:case 161:case 181:case 182:case 242:case 183:case 184:case 243:case 244:case 245:case 165:case 178:case 179:case 49:case 50:case 168:case 169:case 175:case 170:case 171:case 172:case 97:case 76:case 32:case 173:case 35:case 80:case 81:case 79:return-1;case 176:case 177:case 7:case 155:case 8:case 157:case 125:case 126:case 92:case 93:case 129:case 130:case 131:case 94:case 91:return 1;case 74:case 60:case 69:case 70:case 4:return 1024;case 31:case 42:case 72:return 32;case 87:case 26:case 33:return 2147483647;case 34:case 1:return 47839;case 38:case 36:return 99;case 43:case 37:return 2048;case 0:return 2097152;case 3:return 65536;case 28:return 32768;case 44:return 32767;case 75:return 16384;case 39:return 1e3;case 89:return 700;case 71:return 256;case 40:return 255;case 2:return 100;case 180:return 64;case 25:return 20;case 5:return 16;case 6:return 6;case 73:return 4;case 84:return"object"==typeof navigator&&navigator.hardwareConcurrency||1}return Se(28),-1}var Te,Ee={a:fe,d:me,e:be,f:ve,c:xe,b:ke,g:_e,h:Ne},Ie=(de(),s.___wasm_call_ctors=function(){return(Ie=s.___wasm_call_ctors=s.asm.j).apply(null,arguments)}),Oe=(s._init=function(){return(s._init=s.asm.k).apply(null,arguments)},s._register_tensor=function(){return(s._register_tensor=s.asm.l).apply(null,arguments)},s._dispose_data=function(){return(s._dispose_data=s.asm.m).apply(null,arguments)},s._dispose=function(){return(s._dispose=s.asm.n).apply(null,arguments)},s._Abs=function(){return(s._Abs=s.asm.p).apply(null,arguments)},s._Add=function(){return(s._Add=s.asm.q).apply(null,arguments)},s._AddN=function(){return(s._AddN=s.asm.r).apply(null,arguments)},s._All=function(){return(s._All=s.asm.s).apply(null,arguments)},s._Any=function(){return(s._Any=s.asm.t).apply(null,arguments)},s._ArgMax=function(){return(s._ArgMax=s.asm.u).apply(null,arguments)},s._AvgPool=function(){return(s._AvgPool=s.asm.v).apply(null,arguments)},s._BatchMatMul=function(){return(s._BatchMatMul=s.asm.w).apply(null,arguments)},s._Ceil=function(){return(s._Ceil=s.asm.x).apply(null,arguments)},s._ClipByValue=function(){return(s._ClipByValue=s.asm.y).apply(null,arguments)},s._Conv2D=function(){return(s._Conv2D=s.asm.z).apply(null,arguments)},s._Conv2DBackpropInput=function(){return(s._Conv2DBackpropInput=s.asm.A).apply(null,arguments)},s._Cos=function(){return(s._Cos=s.asm.B).apply(null,arguments)},s._Cosh=function(){return(s._Cosh=s.asm.C).apply(null,arguments)},s._CropAndResize=function(){return(s._CropAndResize=s.asm.D).apply(null,arguments)},s._Cumsum=function(){return(s._Cumsum=s.asm.E).apply(null,arguments)},s._DepthToSpace=function(){return(s._DepthToSpace=s.asm.F).apply(null,arguments)},s._DepthwiseConv2dNative=function(){return(s._DepthwiseConv2dNative=s.asm.G).apply(null,arguments)},s._Elu=function(){return(s._Elu=s.asm.H).apply(null,arguments)},s._Equal=function(){return(s._Equal=s.asm.I).apply(null,arguments)},s._Exp=function(){return(s._Exp=s.asm.J).apply(null,arguments)},s._FlipLeftRight=function(){return(s._FlipLeftRight=s.asm.K).apply(null,arguments)},s._Floor=function(){return(s._Floor=s.asm.L).apply(null,arguments)},s._FloorDiv=function(){return(s._FloorDiv=s.asm.M).apply(null,arguments)},s._FusedBatchNorm=function(){return(s._FusedBatchNorm=s.asm.N).apply(null,arguments)},s._FusedConv2D=function(){return(s._FusedConv2D=s.asm.O).apply(null,arguments)},s._FusedDepthwiseConv2D=function(){return(s._FusedDepthwiseConv2D=s.asm.P).apply(null,arguments)},s._Gather=function(){return(s._Gather=s.asm.Q).apply(null,arguments)},s._GatherNd=function(){return(s._GatherNd=s.asm.R).apply(null,arguments)},s._Greater=function(){return(s._Greater=s.asm.S).apply(null,arguments)},s._GreaterEqual=function(){return(s._GreaterEqual=s.asm.T).apply(null,arguments)},s._LeakyRelu=function(){return(s._LeakyRelu=s.asm.U).apply(null,arguments)},s._Less=function(){return(s._Less=s.asm.V).apply(null,arguments)},s._LessEqual=function(){return(s._LessEqual=s.asm.W).apply(null,arguments)},s._Log=function(){return(s._Log=s.asm.X).apply(null,arguments)},s._LogicalAnd=function(){return(s._LogicalAnd=s.asm.Y).apply(null,arguments)},s._Max=function(){return(s._Max=s.asm.Z).apply(null,arguments)},s._MaxPool=function(){return(s._MaxPool=s.asm._).apply(null,arguments)},s._Maximum=function(){return(s._Maximum=s.asm.$).apply(null,arguments)},s._Mean=function(){return(s._Mean=s.asm.aa).apply(null,arguments)},s._Min=function(){return(s._Min=s.asm.ba).apply(null,arguments)},s._Minimum=function(){return(s._Minimum=s.asm.ca).apply(null,arguments)},s._MirrorPad=function(){return(s._MirrorPad=s.asm.da).apply(null,arguments)},s._Multiply=function(){return(s._Multiply=s.asm.ea).apply(null,arguments)},s._Neg=function(){return(s._Neg=s.asm.fa).apply(null,arguments)},s._NonMaxSuppressionV3=function(){return(s._NonMaxSuppressionV3=s.asm.ga).apply(null,arguments)},s._NonMaxSuppressionV4=function(){return(s._NonMaxSuppressionV4=s.asm.ha).apply(null,arguments)},s._NonMaxSuppressionV5=function(){return(s._NonMaxSuppressionV5=s.asm.ia).apply(null,arguments)},s._NotEqual=function(){return(s._NotEqual=s.asm.ja).apply(null,arguments)},s._OneHot=function(){return(s._OneHot=s.asm.ka).apply(null,arguments)},s._PadV2=function(){return(s._PadV2=s.asm.la).apply(null,arguments)},s._Pow=function(){return(s._Pow=s.asm.ma).apply(null,arguments)},s._Prelu=function(){return(s._Prelu=s.asm.na).apply(null,arguments)},s._Prod=function(){return(s._Prod=s.asm.oa).apply(null,arguments)},s._RealDiv=function(){return(s._RealDiv=s.asm.pa).apply(null,arguments)},s._Relu=function(){return(s._Relu=s.asm.qa).apply(null,arguments)},s._Relu6=function(){return(s._Relu6=s.asm.ra).apply(null,arguments)},s._ResizeBilinear=function(){return(s._ResizeBilinear=s.asm.sa).apply(null,arguments)},s._Reverse=function(){return(s._Reverse=s.asm.ta).apply(null,arguments)},s._RotateWithOffset=function(){return(s._RotateWithOffset=s.asm.ua).apply(null,arguments)},s._Round=function(){return(s._Round=s.asm.va).apply(null,arguments)},s._Rsqrt=function(){return(s._Rsqrt=s.asm.wa).apply(null,arguments)},s._ScatterNd=function(){return(s._ScatterNd=s.asm.xa).apply(null,arguments)},s._SelectV2=function(){return(s._SelectV2=s.asm.ya).apply(null,arguments)},s._Sigmoid=function(){return(s._Sigmoid=s.asm.za).apply(null,arguments)},s._Sin=function(){return(s._Sin=s.asm.Aa).apply(null,arguments)},s._Softmax=function(){return(s._Softmax=s.asm.Ba).apply(null,arguments)},s._Sqrt=function(){return(s._Sqrt=s.asm.Ca).apply(null,arguments)},s._Square=function(){return(s._Square=s.asm.Da).apply(null,arguments)},s._SquaredDifference=function(){return(s._SquaredDifference=s.asm.Ea).apply(null,arguments)},s._Step=function(){return(s._Step=s.asm.Fa).apply(null,arguments)},s._StridedSlice=function(){return(s._StridedSlice=s.asm.Ga).apply(null,arguments)},s._Sub=function(){return(s._Sub=s.asm.Ha).apply(null,arguments)},s._Sum=function(){return(s._Sum=s.asm.Ia).apply(null,arguments)},s._Tan=function(){return(s._Tan=s.asm.Ja).apply(null,arguments)},s._Tanh=function(){return(s._Tanh=s.asm.Ka).apply(null,arguments)},s._Tile=function(){return(s._Tile=s.asm.La).apply(null,arguments)},s._TopK=function(){return(s._TopK=s.asm.Ma).apply(null,arguments)},s._Transform=function(){return(s._Transform=s.asm.Na).apply(null,arguments)},s._Transpose=function(){return(s._Transpose=s.asm.Oa).apply(null,arguments)},s.__FusedMatMul=function(){return(s.__FusedMatMul=s.asm.Pa).apply(null,arguments)},s._malloc=function(){return(s._malloc=s.asm.Qa).apply(null,arguments)},s._free=function(){return(s._free=s.asm.Ra).apply(null,arguments)},s.___errno_location=function(){return(Oe=s.___errno_location=s.asm.Sa).apply(null,arguments)}),Ae=s.stackSave=function(){return(Ae=s.stackSave=s.asm.Ta).apply(null,arguments)},Me=s.stackRestore=function(){return(Me=s.stackRestore=s.asm.Ua).apply(null,arguments)},Ce=s.stackAlloc=function(){return(Ce=s.stackAlloc=s.asm.Va).apply(null,arguments)};function Re(e){this.name="ExitStatus",this.message="Program terminated with exit("+e+")",this.status=e}function De(e){function n(){Te||(Te=!0,s.calledRun=!0,S||(K(),G(),t(s),s.onRuntimeInitialized&&s.onRuntimeInitialized(),J()))}e=e||u,Z>0||(U(),Z>0||(s.setStatus?(s.setStatus("Running..."),setTimeout((function(){setTimeout((function(){s.setStatus("")}),1),n()}),1)):n()))}if(s.cwrap=I,ee=function e(){Te||De(),Te||(ee=e)},s.run=De,s.preInit)for("function"==typeof s.preInit&&(s.preInit=[s.preInit]);s.preInit.length>0;)s.preInit.pop()();return De(),e.ready});e.exports=a},8072:function(e){e.exports=n;var t=null;try{t=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(e){}function n(e,t,n){this.low=0|e,this.high=0|t,this.unsigned=!!n}function r(e){return!0===(e&&e.__isLong__)}n.prototype.__isLong__,Object.defineProperty(n.prototype,"__isLong__",{value:!0}),n.isLong=r;var a={},s={};function o(e,t){var n,r,o;return t?(o=0<=(e>>>=0)&&e<256)&&(r=s[e])?r:(n=u(e,(0|e)<0?-1:0,!0),o&&(s[e]=n),n):(o=-128<=(e|=0)&&e<128)&&(r=a[e])?r:(n=u(e,e<0?-1:0,!1),o&&(a[e]=n),n)}function i(e,t){if(isNaN(e))return t?g:y;if(t){if(e<0)return g;if(e>=h)return k}else{if(e<=-f)return _;if(e+1>=f)return x}return e<0?i(-e,t).neg():u(e%d|0,e/d|0,t)}function u(e,t,r){return new n(e,t,r)}n.fromInt=o,n.fromNumber=i,n.fromBits=u;var c=Math.pow;function l(e,t,n){if(0===e.length)throw Error("empty string");if("NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return y;if("number"==typeof t?(n=t,t=!1):t=!!t,(n=n||10)<2||36<n)throw RangeError("radix");var r;if((r=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===r)return l(e.substring(1),t,n).neg();for(var a=i(c(n,8)),s=y,o=0;o<e.length;o+=8){var u=Math.min(8,e.length-o),p=parseInt(e.substring(o,o+u),n);if(u<8){var d=i(c(n,u));s=s.mul(d).add(i(p))}else s=(s=s.mul(a)).add(i(p))}return s.unsigned=t,s}function p(e,t){return"number"==typeof e?i(e,t):"string"==typeof e?l(e,t):u(e.low,e.high,"boolean"==typeof t?t:e.unsigned)}n.fromString=l,n.fromValue=p;var d=4294967296,h=d*d,f=h/2,m=o(1<<24),y=o(0);n.ZERO=y;var g=o(0,!0);n.UZERO=g;var b=o(1);n.ONE=b;var w=o(1,!0);n.UONE=w;var v=o(-1);n.NEG_ONE=v;var x=u(-1,2147483647,!1);n.MAX_VALUE=x;var k=u(-1,-1,!0);n.MAX_UNSIGNED_VALUE=k;var _=u(0,-2147483648,!1);n.MIN_VALUE=_;var S=n.prototype;S.toInt=function(){return this.unsigned?this.low>>>0:this.low},S.toNumber=function(){return this.unsigned?(this.high>>>0)*d+(this.low>>>0):this.high*d+(this.low>>>0)},S.toString=function(e){if((e=e||10)<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(_)){var t=i(e),n=this.div(t),r=n.mul(t).sub(this);return n.toString(e)+r.toInt().toString(e)}return"-"+this.neg().toString(e)}for(var a=i(c(e,6),this.unsigned),s=this,o="";;){var u=s.div(a),l=(s.sub(u.mul(a)).toInt()>>>0).toString(e);if((s=u).isZero())return l+o;for(;l.length<6;)l="0"+l;o=""+l+o}},S.getHighBits=function(){return this.high},S.getHighBitsUnsigned=function(){return this.high>>>0},S.getLowBits=function(){return this.low},S.getLowBitsUnsigned=function(){return this.low>>>0},S.getNumBitsAbs=function(){if(this.isNegative())return this.eq(_)?64:this.neg().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;t>0&&0==(e&1<<t);t--);return 0!=this.high?t+33:t+1},S.isZero=function(){return 0===this.high&&0===this.low},S.eqz=S.isZero,S.isNegative=function(){return!this.unsigned&&this.high<0},S.isPositive=function(){return this.unsigned||this.high>=0},S.isOdd=function(){return 1==(1&this.low)},S.isEven=function(){return 0==(1&this.low)},S.equals=function(e){return r(e)||(e=p(e)),(this.unsigned===e.unsigned||this.high>>>31!=1||e.high>>>31!=1)&&this.high===e.high&&this.low===e.low},S.eq=S.equals,S.notEquals=function(e){return!this.eq(e)},S.neq=S.notEquals,S.ne=S.notEquals,S.lessThan=function(e){return this.comp(e)<0},S.lt=S.lessThan,S.lessThanOrEqual=function(e){return this.comp(e)<=0},S.lte=S.lessThanOrEqual,S.le=S.lessThanOrEqual,S.greaterThan=function(e){return this.comp(e)>0},S.gt=S.greaterThan,S.greaterThanOrEqual=function(e){return this.comp(e)>=0},S.gte=S.greaterThanOrEqual,S.ge=S.greaterThanOrEqual,S.compare=function(e){if(r(e)||(e=p(e)),this.eq(e))return 0;var t=this.isNegative(),n=e.isNegative();return t&&!n?-1:!t&&n?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},S.comp=S.compare,S.negate=function(){return!this.unsigned&&this.eq(_)?_:this.not().add(b)},S.neg=S.negate,S.add=function(e){r(e)||(e=p(e));var t=this.high>>>16,n=65535&this.high,a=this.low>>>16,s=65535&this.low,o=e.high>>>16,i=65535&e.high,c=e.low>>>16,l=0,d=0,h=0,f=0;return h+=(f+=s+(65535&e.low))>>>16,d+=(h+=a+c)>>>16,l+=(d+=n+i)>>>16,l+=t+o,u((h&=65535)<<16|(f&=65535),(l&=65535)<<16|(d&=65535),this.unsigned)},S.subtract=function(e){return r(e)||(e=p(e)),this.add(e.neg())},S.sub=S.subtract,S.multiply=function(e){if(this.isZero())return y;if(r(e)||(e=p(e)),t)return u(t.mul(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned);if(e.isZero())return y;if(this.eq(_))return e.isOdd()?_:y;if(e.eq(_))return this.isOdd()?_:y;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(m)&&e.lt(m))return i(this.toNumber()*e.toNumber(),this.unsigned);var n=this.high>>>16,a=65535&this.high,s=this.low>>>16,o=65535&this.low,c=e.high>>>16,l=65535&e.high,d=e.low>>>16,h=65535&e.low,f=0,g=0,b=0,w=0;return b+=(w+=o*h)>>>16,g+=(b+=s*h)>>>16,b&=65535,g+=(b+=o*d)>>>16,f+=(g+=a*h)>>>16,g&=65535,f+=(g+=s*d)>>>16,g&=65535,f+=(g+=o*l)>>>16,f+=n*h+a*d+s*l+o*c,u((b&=65535)<<16|(w&=65535),(f&=65535)<<16|(g&=65535),this.unsigned)},S.mul=S.multiply,S.divide=function(e){if(r(e)||(e=p(e)),e.isZero())throw Error("division by zero");var n,a,s;if(t)return this.unsigned||-2147483648!==this.high||-1!==e.low||-1!==e.high?u((this.unsigned?t.div_u:t.div_s)(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?g:y;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return g;if(e.gt(this.shru(1)))return w;s=g}else{if(this.eq(_))return e.eq(b)||e.eq(v)?_:e.eq(_)?b:(n=this.shr(1).div(e).shl(1)).eq(y)?e.isNegative()?b:v:(a=this.sub(e.mul(n)),s=n.add(a.div(e)));if(e.eq(_))return this.unsigned?g:y;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();s=y}for(a=this;a.gte(e);){n=Math.max(1,Math.floor(a.toNumber()/e.toNumber()));for(var o=Math.ceil(Math.log(n)/Math.LN2),l=o<=48?1:c(2,o-48),d=i(n),h=d.mul(e);h.isNegative()||h.gt(a);)h=(d=i(n-=l,this.unsigned)).mul(e);d.isZero()&&(d=b),s=s.add(d),a=a.sub(h)}return s},S.div=S.divide,S.modulo=function(e){return r(e)||(e=p(e)),t?u((this.unsigned?t.rem_u:t.rem_s)(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned):this.sub(this.div(e).mul(e))},S.mod=S.modulo,S.rem=S.modulo,S.not=function(){return u(~this.low,~this.high,this.unsigned)},S.and=function(e){return r(e)||(e=p(e)),u(this.low&e.low,this.high&e.high,this.unsigned)},S.or=function(e){return r(e)||(e=p(e)),u(this.low|e.low,this.high|e.high,this.unsigned)},S.xor=function(e){return r(e)||(e=p(e)),u(this.low^e.low,this.high^e.high,this.unsigned)},S.shiftLeft=function(e){return r(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?u(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):u(0,this.low<<e-32,this.unsigned)},S.shl=S.shiftLeft,S.shiftRight=function(e){return r(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?u(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):u(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},S.shr=S.shiftRight,S.shiftRightUnsigned=function(e){if(r(e)&&(e=e.toInt()),0==(e&=63))return this;var t=this.high;return e<32?u(this.low>>>e|t<<32-e,t>>>e,this.unsigned):u(32===e?t:t>>>e-32,0,this.unsigned)},S.shru=S.shiftRightUnsigned,S.shr_u=S.shiftRightUnsigned,S.toSigned=function(){return this.unsigned?u(this.low,this.high,!1):this},S.toUnsigned=function(){return this.unsigned?this:u(this.low,this.high,!0)},S.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},S.toBytesLE=function(){var e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24,255&e,e>>>8&255,e>>>16&255,e>>>24]},S.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,255&e,t>>>24,t>>>16&255,t>>>8&255,255&t]},n.fromBytes=function(e,t,r){return r?n.fromBytesLE(e,t):n.fromBytesBE(e,t)},n.fromBytesLE=function(e,t){return new n(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)},n.fromBytesBE=function(e,t){return new n(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)}},8841:function(e,t,n){"use strict";e.exports=n(5493)},5493:function(e,t,n){"use strict";var r=t;function a(){r.util._configure(),r.Writer._configure(r.BufferWriter),r.Reader._configure(r.BufferReader)}r.build="minimal",r.Writer=n(9061),r.BufferWriter=n(4842),r.Reader=n(5321),r.BufferReader=n(7084),r.util=n(5848),r.rpc=n(841),r.roots=n(3874),r.configure=a,a()},5321:function(e,t,n){"use strict";e.exports=u;var r,a=n(5848),s=a.LongBits,o=a.utf8;function i(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function u(e){this.buf=e,this.pos=0,this.len=e.length}var c,l="undefined"!=typeof Uint8Array?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new u(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new u(e);throw Error("illegal buffer")},p=function(){return a.Buffer?function(e){return(u.create=function(e){return a.Buffer.isBuffer(e)?new r(e):l(e)})(e)}:l};function d(){var e=new s(0,0),t=0;if(!(this.len-this.pos>4)){for(;t<3;++t){if(this.pos>=this.len)throw i(this);if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(127&this.buf[this.pos++])<<7*t)>>>0,e}for(;t<4;++t)if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(127&this.buf[this.pos])<<28)>>>0,e.hi=(e.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return e;if(t=0,this.len-this.pos>4){for(;t<5;++t)if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw i(this);if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}function h(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}function f(){if(this.pos+8>this.len)throw i(this,8);return new s(h(this.buf,this.pos+=4),h(this.buf,this.pos+=4))}u.create=p(),u.prototype._slice=a.Array.prototype.subarray||a.Array.prototype.slice,u.prototype.uint32=(c=4294967295,function(){if(c=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128)return c;if(c=(c|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)return c;if(c=(c|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)return c;if(c=(c|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)return c;if(c=(c|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)return c;if((this.pos+=5)>this.len)throw this.pos=this.len,i(this,10);return c}),u.prototype.int32=function(){return 0|this.uint32()},u.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(1&e)|0},u.prototype.bool=function(){return 0!==this.uint32()},u.prototype.fixed32=function(){if(this.pos+4>this.len)throw i(this,4);return h(this.buf,this.pos+=4)},u.prototype.sfixed32=function(){if(this.pos+4>this.len)throw i(this,4);return 0|h(this.buf,this.pos+=4)},u.prototype.float=function(){if(this.pos+4>this.len)throw i(this,4);var e=a.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e},u.prototype.double=function(){if(this.pos+8>this.len)throw i(this,4);var e=a.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e},u.prototype.bytes=function(){var e=this.uint32(),t=this.pos,n=this.pos+e;if(n>this.len)throw i(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(t,n):t===n?new this.buf.constructor(0):this._slice.call(this.buf,t,n)},u.prototype.string=function(){var e=this.bytes();return o.read(e,0,e.length)},u.prototype.skip=function(e){if("number"==typeof e){if(this.pos+e>this.len)throw i(this,e);this.pos+=e}else do{if(this.pos>=this.len)throw i(this)}while(128&this.buf[this.pos++]);return this},u.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(e=7&this.uint32());)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this},u._configure=function(e){r=e,u.create=p(),r._configure();var t=a.Long?"toLong":"toNumber";a.merge(u.prototype,{int64:function(){return d.call(this)[t](!1)},uint64:function(){return d.call(this)[t](!0)},sint64:function(){return d.call(this).zzDecode()[t](!1)},fixed64:function(){return f.call(this)[t](!0)},sfixed64:function(){return f.call(this)[t](!1)}})}},7084:function(e,t,n){"use strict";e.exports=s;var r=n(5321);(s.prototype=Object.create(r.prototype)).constructor=s;var a=n(5848);function s(e){r.call(this,e)}s._configure=function(){a.Buffer&&(s.prototype._slice=a.Buffer.prototype.slice)},s.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))},s._configure()},3874:function(e){"use strict";e.exports={}},841:function(e,t,n){"use strict";t.Service=n(4112)},4112:function(e,t,n){"use strict";e.exports=a;var r=n(5848);function a(e,t,n){if("function"!=typeof e)throw TypeError("rpcImpl must be a function");r.EventEmitter.call(this),this.rpcImpl=e,this.requestDelimited=Boolean(t),this.responseDelimited=Boolean(n)}(a.prototype=Object.create(r.EventEmitter.prototype)).constructor=a,a.prototype.rpcCall=function e(t,n,a,s,o){if(!s)throw TypeError("request must be specified");var i=this;if(!o)return r.asPromise(e,i,t,n,a,s);if(i.rpcImpl)try{return i.rpcImpl(t,n[i.requestDelimited?"encodeDelimited":"encode"](s).finish(),(function(e,n){if(e)return i.emit("error",e,t),o(e);if(null!==n){if(!(n instanceof a))try{n=a[i.responseDelimited?"decodeDelimited":"decode"](n)}catch(e){return i.emit("error",e,t),o(e)}return i.emit("data",n,t),o(null,n)}i.end(!0)}))}catch(e){return i.emit("error",e,t),void setTimeout((function(){o(e)}),0)}else setTimeout((function(){o(Error("already ended"))}),0)},a.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}},3311:function(e,t,n){"use strict";e.exports=a;var r=n(5848);function a(e,t){this.lo=e>>>0,this.hi=t>>>0}var s=a.zero=new a(0,0);s.toNumber=function(){return 0},s.zzEncode=s.zzDecode=function(){return this},s.length=function(){return 1};var o=a.zeroHash="\0\0\0\0\0\0\0\0";a.fromNumber=function(e){if(0===e)return s;var t=e<0;t&&(e=-e);var n=e>>>0,r=(e-n)/4294967296>>>0;return t&&(r=~r>>>0,n=~n>>>0,++n>4294967295&&(n=0,++r>4294967295&&(r=0))),new a(n,r)},a.from=function(e){if("number"==typeof e)return a.fromNumber(e);if(r.isString(e)){if(!r.Long)return a.fromNumber(parseInt(e,10));e=r.Long.fromString(e)}return e.low||e.high?new a(e.low>>>0,e.high>>>0):s},a.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=1+~this.lo>>>0,n=~this.hi>>>0;return t||(n=n+1>>>0),-(t+4294967296*n)}return this.lo+4294967296*this.hi},a.prototype.toLong=function(e){return r.Long?new r.Long(0|this.lo,0|this.hi,Boolean(e)):{low:0|this.lo,high:0|this.hi,unsigned:Boolean(e)}};var i=String.prototype.charCodeAt;a.fromHash=function(e){return e===o?s:new a((i.call(e,0)|i.call(e,1)<<8|i.call(e,2)<<16|i.call(e,3)<<24)>>>0,(i.call(e,4)|i.call(e,5)<<8|i.call(e,6)<<16|i.call(e,7)<<24)>>>0)},a.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},a.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this},a.prototype.zzDecode=function(){var e=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this},a.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return 0===n?0===t?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:n<128?9:10}},5848:function(e,t,n){"use strict";var r=t;function a(e,t,n){for(var r=Object.keys(t),a=0;a<r.length;++a)void 0!==e[r[a]]&&n||(e[r[a]]=t[r[a]]);return e}function s(e){function t(e,n){if(!(this instanceof t))return new t(e,n);Object.defineProperty(this,"message",{get:function(){return e}}),Error.captureStackTrace?Error.captureStackTrace(this,t):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),n&&a(this,n)}return(t.prototype=Object.create(Error.prototype)).constructor=t,Object.defineProperty(t.prototype,"name",{get:function(){return e}}),t.prototype.toString=function(){return this.name+": "+this.message},t}r.asPromise=n(8732),r.base64=n(2340),r.EventEmitter=n(8023),r.float=n(7417),r.inquire=n(4199),r.utf8=n(8421),r.pool=n(1474),r.LongBits=n(3311),r.isNode=Boolean(void 0!==n.g&&n.g&&n.g.process&&n.g.process.versions&&n.g.process.versions.node),r.global=r.isNode&&n.g||"undefined"!=typeof window&&window||"undefined"!=typeof self&&self||this,r.emptyArray=Object.freeze?Object.freeze([]):[],r.emptyObject=Object.freeze?Object.freeze({}):{},r.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},r.isString=function(e){return"string"==typeof e||e instanceof String},r.isObject=function(e){return e&&"object"==typeof e},r.isset=r.isSet=function(e,t){var n=e[t];return!(null==n||!e.hasOwnProperty(t))&&("object"!=typeof n||(Array.isArray(n)?n.length:Object.keys(n).length)>0)},r.Buffer=function(){try{var e=r.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null}catch(e){return null}}(),r._Buffer_from=null,r._Buffer_allocUnsafe=null,r.newBuffer=function(e){return"number"==typeof e?r.Buffer?r._Buffer_allocUnsafe(e):new r.Array(e):r.Buffer?r._Buffer_from(e):"undefined"==typeof Uint8Array?e:new Uint8Array(e)},r.Array="undefined"!=typeof Uint8Array?Uint8Array:Array,r.Long=r.global.dcodeIO&&r.global.dcodeIO.Long||r.global.Long||r.inquire("long"),r.key2Re=/^true|false|0|1$/,r.key32Re=/^-?(?:0|[1-9][0-9]*)$/,r.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,r.longToHash=function(e){return e?r.LongBits.from(e).toHash():r.LongBits.zeroHash},r.longFromHash=function(e,t){var n=r.LongBits.fromHash(e);return r.Long?r.Long.fromBits(n.lo,n.hi,t):n.toNumber(Boolean(t))},r.merge=a,r.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)},r.newError=s,r.ProtocolError=s("ProtocolError"),r.oneOfGetter=function(e){for(var t={},n=0;n<e.length;++n)t[e[n]]=1;return function(){for(var e=Object.keys(this),n=e.length-1;n>-1;--n)if(1===t[e[n]]&&void 0!==this[e[n]]&&null!==this[e[n]])return e[n]}},r.oneOfSetter=function(e){return function(t){for(var n=0;n<e.length;++n)e[n]!==t&&delete this[e[n]]}},r.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},r._configure=function(){var e=r.Buffer;e?(r._Buffer_from=e.from!==Uint8Array.from&&e.from||function(t,n){return new e(t,n)},r._Buffer_allocUnsafe=e.allocUnsafe||function(t){return new e(t)}):r._Buffer_from=r._Buffer_allocUnsafe=null}},9061:function(e,t,n){"use strict";e.exports=p;var r,a=n(5848),s=a.LongBits,o=a.base64,i=a.utf8;function u(e,t,n){this.fn=e,this.len=t,this.next=void 0,this.val=n}function c(){}function l(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function p(){this.len=0,this.head=new u(c,0,0),this.tail=this.head,this.states=null}var d=function(){return a.Buffer?function(){return(p.create=function(){return new r})()}:function(){return new p}};function h(e,t,n){t[n]=255&e}function f(e,t){this.len=e,this.next=void 0,this.val=t}function m(e,t,n){for(;e.hi;)t[n++]=127&e.lo|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[n++]=127&e.lo|128,e.lo=e.lo>>>7;t[n++]=e.lo}function y(e,t,n){t[n]=255&e,t[n+1]=e>>>8&255,t[n+2]=e>>>16&255,t[n+3]=e>>>24}p.create=d(),p.alloc=function(e){return new a.Array(e)},a.Array!==Array&&(p.alloc=a.pool(p.alloc,a.Array.prototype.subarray)),p.prototype._push=function(e,t,n){return this.tail=this.tail.next=new u(e,t,n),this.len+=t,this},f.prototype=Object.create(u.prototype),f.prototype.fn=function(e,t,n){for(;e>127;)t[n++]=127&e|128,e>>>=7;t[n]=e},p.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new f((e>>>=0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this},p.prototype.int32=function(e){return e<0?this._push(m,10,s.fromNumber(e)):this.uint32(e)},p.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)},p.prototype.uint64=function(e){var t=s.from(e);return this._push(m,t.length(),t)},p.prototype.int64=p.prototype.uint64,p.prototype.sint64=function(e){var t=s.from(e).zzEncode();return this._push(m,t.length(),t)},p.prototype.bool=function(e){return this._push(h,1,e?1:0)},p.prototype.fixed32=function(e){return this._push(y,4,e>>>0)},p.prototype.sfixed32=p.prototype.fixed32,p.prototype.fixed64=function(e){var t=s.from(e);return this._push(y,4,t.lo)._push(y,4,t.hi)},p.prototype.sfixed64=p.prototype.fixed64,p.prototype.float=function(e){return this._push(a.float.writeFloatLE,4,e)},p.prototype.double=function(e){return this._push(a.float.writeDoubleLE,8,e)};var g=a.Array.prototype.set?function(e,t,n){t.set(e,n)}:function(e,t,n){for(var r=0;r<e.length;++r)t[n+r]=e[r]};p.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(h,1,0);if(a.isString(e)){var n=p.alloc(t=o.length(e));o.decode(e,n,0),e=n}return this.uint32(t)._push(g,t,e)},p.prototype.string=function(e){var t=i.length(e);return t?this.uint32(t)._push(i.write,t,e):this._push(h,1,0)},p.prototype.fork=function(){return this.states=new l(this),this.head=this.tail=new u(c,0,0),this.len=0,this},p.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new u(c,0,0),this.len=0),this},p.prototype.ldelim=function(){var e=this.head,t=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=e.next,this.tail=t,this.len+=n),this},p.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),n=0;e;)e.fn(e.val,t,n),n+=e.len,e=e.next;return t},p._configure=function(e){r=e,p.create=d(),r._configure()}},4842:function(e,t,n){"use strict";e.exports=s;var r=n(9061);(s.prototype=Object.create(r.prototype)).constructor=s;var a=n(5848);function s(){r.call(this)}function o(e,t,n){e.length<40?a.utf8.write(e,t,n):t.utf8Write?t.utf8Write(e,n):t.write(e,n)}s._configure=function(){s.alloc=a._Buffer_allocUnsafe,s.writeBytesBuffer=a.Buffer&&a.Buffer.prototype instanceof Uint8Array&&"set"===a.Buffer.prototype.set.name?function(e,t,n){t.set(e,n)}:function(e,t,n){if(e.copy)e.copy(t,n,0,e.length);else for(var r=0;r<e.length;)t[n++]=e[r++]}},s.prototype.bytes=function(e){a.isString(e)&&(e=a._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(s.writeBytesBuffer,t,e),this},s.prototype.string=function(e){var t=a.Buffer.byteLength(e);return this.uint32(t),t&&this._push(o,t,e),this},s._configure()},2474:function(e,t,n){var r=n(5898),a=n(776),s=n(920),o=n(2707),i=n(9655),u=n(4668),c=n(2064);c.alea=r,c.xor128=a,c.xorwow=s,c.xorshift7=o,c.xor4096=i,c.tychei=u,e.exports=c},5898:function(e,t,n){var r;!function(e,a,s){function o(e){var t,n=this,r=(t=4022871197,function(e){e=e.toString();for(var n=0;n<e.length;n++){var r=.02519603282416938*(t+=e.charCodeAt(n));r-=t=r>>>0,t=(r*=t)>>>0,t+=4294967296*(r-=t)}return 2.3283064365386963e-10*(t>>>0)});n.next=function(){var e=2091639*n.s0+2.3283064365386963e-10*n.c;return n.s0=n.s1,n.s1=n.s2,n.s2=e-(n.c=0|e)},n.c=1,n.s0=r(" "),n.s1=r(" "),n.s2=r(" "),n.s0-=r(e),n.s0<0&&(n.s0+=1),n.s1-=r(e),n.s1<0&&(n.s1+=1),n.s2-=r(e),n.s2<0&&(n.s2+=1),r=null}function i(e,t){return t.c=e.c,t.s0=e.s0,t.s1=e.s1,t.s2=e.s2,t}function u(e,t){var n=new o(e),r=t&&t.state,a=n.next;return a.int32=function(){return 4294967296*n.next()|0},a.double=function(){return a()+11102230246251565e-32*(2097152*a()|0)},a.quick=a,r&&("object"==typeof r&&i(r,n),a.state=function(){return i(n,{})}),a}a&&a.exports?a.exports=u:n.amdD&&n.amdO?void 0===(r=function(){return u}.call(t,n,t,a))||(a.exports=r):this.alea=u}(0,e=n.nmd(e),n.amdD)},4668:function(e,t,n){var r;!function(e,a,s){function o(e){var t=this,n="";t.next=function(){var e=t.b,n=t.c,r=t.d,a=t.a;return e=e<<25^e>>>7^n,n=n-r|0,r=r<<24^r>>>8^a,a=a-e|0,t.b=e=e<<20^e>>>12^n,t.c=n=n-r|0,t.d=r<<16^n>>>16^a,t.a=a-e|0},t.a=0,t.b=0,t.c=-1640531527,t.d=1367130551,e===Math.floor(e)?(t.a=e/4294967296|0,t.b=0|e):n+=e;for(var r=0;r<n.length+20;r++)t.b^=0|n.charCodeAt(r),t.next()}function i(e,t){return t.a=e.a,t.b=e.b,t.c=e.c,t.d=e.d,t}function u(e,t){var n=new o(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&("object"==typeof r&&i(r,n),a.state=function(){return i(n,{})}),a}a&&a.exports?a.exports=u:n.amdD&&n.amdO?void 0===(r=function(){return u}.call(t,n,t,a))||(a.exports=r):this.tychei=u}(0,e=n.nmd(e),n.amdD)},776:function(e,t,n){var r;!function(e,a,s){function o(e){var t=this,n="";t.x=0,t.y=0,t.z=0,t.w=0,t.next=function(){var e=t.x^t.x<<11;return t.x=t.y,t.y=t.z,t.z=t.w,t.w^=t.w>>>19^e^e>>>8},e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),t.next()}function i(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t}function u(e,t){var n=new o(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&("object"==typeof r&&i(r,n),a.state=function(){return i(n,{})}),a}a&&a.exports?a.exports=u:n.amdD&&n.amdO?void 0===(r=function(){return u}.call(t,n,t,a))||(a.exports=r):this.xor128=u}(0,e=n.nmd(e),n.amdD)},9655:function(e,t,n){var r;!function(e,a,s){function o(e){var t=this;t.next=function(){var e,n,r=t.w,a=t.X,s=t.i;return t.w=r=r+1640531527|0,n=a[s+34&127],e=a[s=s+1&127],n^=n<<13,e^=e<<17,n^=n>>>15,e^=e>>>12,n=a[s]=n^e,t.i=s,n+(r^r>>>16)|0},function(e,t){var n,r,a,s,o,i=[],u=128;for(t===(0|t)?(r=t,t=null):(t+="\0",r=0,u=Math.max(u,t.length)),a=0,s=-32;s<u;++s)t&&(r^=t.charCodeAt((s+32)%t.length)),0===s&&(o=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,s>=0&&(o=o+1640531527|0,a=0==(n=i[127&s]^=r+o)?a+1:0);for(a>=128&&(i[127&(t&&t.length||0)]=-1),a=127,s=512;s>0;--s)r=i[a+34&127],n=i[a=a+1&127],r^=r<<13,n^=n<<17,r^=r>>>15,n^=n>>>12,i[a]=r^n;e.w=o,e.X=i,e.i=a}(t,e)}function i(e,t){return t.i=e.i,t.w=e.w,t.X=e.X.slice(),t}function u(e,t){null==e&&(e=+new Date);var n=new o(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&(r.X&&i(r,n),a.state=function(){return i(n,{})}),a}a&&a.exports?a.exports=u:n.amdD&&n.amdO?void 0===(r=function(){return u}.call(t,n,t,a))||(a.exports=r):this.xor4096=u}(0,e=n.nmd(e),n.amdD)},2707:function(e,t,n){var r;!function(e,a,s){function o(e){var t=this;t.next=function(){var e,n,r=t.x,a=t.i;return e=r[a],n=(e^=e>>>7)^e<<24,n^=(e=r[a+1&7])^e>>>10,n^=(e=r[a+3&7])^e>>>3,n^=(e=r[a+4&7])^e<<7,e=r[a+7&7],n^=(e^=e<<13)^e<<9,r[a]=n,t.i=a+1&7,n},function(e,t){var n,r=[];if(t===(0|t))r[0]=t;else for(t=""+t,n=0;n<t.length;++n)r[7&n]=r[7&n]<<15^t.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n?r[7]=-1:r[n],e.x=r,e.i=0,n=256;n>0;--n)e.next()}(t,e)}function i(e,t){return t.x=e.x.slice(),t.i=e.i,t}function u(e,t){null==e&&(e=+new Date);var n=new o(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&(r.x&&i(r,n),a.state=function(){return i(n,{})}),a}a&&a.exports?a.exports=u:n.amdD&&n.amdO?void 0===(r=function(){return u}.call(t,n,t,a))||(a.exports=r):this.xorshift7=u}(0,e=n.nmd(e),n.amdD)},920:function(e,t,n){var r;!function(e,a,s){function o(e){var t=this,n="";t.next=function(){var e=t.x^t.x>>>2;return t.x=t.y,t.y=t.z,t.z=t.w,t.w=t.v,(t.d=t.d+362437|0)+(t.v=t.v^t.v<<4^e^e<<1)|0},t.x=0,t.y=0,t.z=0,t.w=0,t.v=0,e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),r==n.length&&(t.d=t.x<<10^t.x>>>4),t.next()}function i(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t.v=e.v,t.d=e.d,t}function u(e,t){var n=new o(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&("object"==typeof r&&i(r,n),a.state=function(){return i(n,{})}),a}a&&a.exports?a.exports=u:n.amdD&&n.amdO?void 0===(r=function(){return u}.call(t,n,t,a))||(a.exports=r):this.xorwow=u}(0,e=n.nmd(e),n.amdD)},2064:function(e,t,n){var r;!function(a,s){var o,i=this,u=256,c=s.pow(u,6),l=s.pow(2,52),p=2*l,d=255;function h(e,t,n){var r=[],d=g(y((t=1==t?{entropy:!0}:t||{}).entropy?[e,b(a)]:null==e?function(){try{var e;return o&&(e=o.randomBytes)?e=e(u):(e=new Uint8Array(u),(i.crypto||i.msCrypto).getRandomValues(e)),b(e)}catch(e){var t=i.navigator,n=t&&t.plugins;return[+new Date,i,n,i.screen,b(a)]}}():e,3),r),h=new f(r),w=function(){for(var e=h.g(6),t=c,n=0;e<l;)e=(e+n)*u,t*=u,n=h.g(1);for(;e>=p;)e/=2,t/=2,n>>>=1;return(e+n)/t};return w.int32=function(){return 0|h.g(4)},w.quick=function(){return h.g(4)/4294967296},w.double=w,g(b(h.S),a),(t.pass||n||function(e,t,n,r){return r&&(r.S&&m(r,h),e.state=function(){return m(h,{})}),n?(s.random=e,t):e})(w,d,"global"in t?t.global:this==s,t.state)}function f(e){var t,n=e.length,r=this,a=0,s=r.i=r.j=0,o=r.S=[];for(n||(e=[n++]);a<u;)o[a]=a++;for(a=0;a<u;a++)o[a]=o[s=d&s+e[a%n]+(t=o[a])],o[s]=t;(r.g=function(e){for(var t,n=0,a=r.i,s=r.j,o=r.S;e--;)t=o[a=d&a+1],n=n*u+o[d&(o[a]=o[s=d&s+t])+(o[s]=t)];return r.i=a,r.j=s,n})(u)}function m(e,t){return t.i=e.i,t.j=e.j,t.S=e.S.slice(),t}function y(e,t){var n,r=[],a=typeof e;if(t&&"object"==a)for(n in e)try{r.push(y(e[n],t-1))}catch(e){}return r.length?r:"string"==a?e:e+"\0"}function g(e,t){for(var n,r=e+"",a=0;a<r.length;)t[d&a]=d&(n^=19*t[d&a])+r.charCodeAt(a++);return b(t)}function b(e){return String.fromCharCode.apply(0,e)}if(s.seedrandom=h,g(s.random(),a),e.exports){e.exports=h;try{o=n(5042)}catch(e){}}else void 0===(r=function(){return h}.call(t,n,t,e))||(e.exports=r)}([],Math)},4864:function(e,t,n){"use strict";n.d(t,{t:function(){return bh}});var r={};n.r(r),n.d(r,{json:function(){return Ac}});var a={};n.r(a),n.d(a,{json:function(){return Mc}});var s={};n.r(s),n.d(s,{json:function(){return Cc}});var o={};n.r(o),n.d(o,{json:function(){return Rc}});var i={};n.r(i),n.d(i,{json:function(){return Dc}});var u={};n.r(u),n.d(u,{json:function(){return Fc}});var c={};n.r(c),n.d(c,{json:function(){return $c}});var l={};n.r(l),n.d(l,{json:function(){return Pc}});var p={};n.r(p),n.d(p,{json:function(){return jc}});var d={};n.r(d),n.d(d,{json:function(){return Bc}});var h={};n.r(h),n.d(h,{json:function(){return Lc}});var f={};n.r(f),n.d(f,{json:function(){return qc}});var m={};n.r(m),n.d(m,{json:function(){return zc}});var y={};n.r(y),n.d(y,{json:function(){return Vc}});var g={};n.r(g),n.d(g,{json:function(){return Wc}});var b={};n.r(b),n.d(b,{json:function(){return Hc}});var w={};n.r(w),n.d(w,{json:function(){return Uc}});var v={};n.r(v),n.d(v,{json:function(){return Kc}});var x={};n.r(x),n.d(x,{json:function(){return Gc}});var k=n(8841);const _=k.Reader,S=k.Writer,N=k.util,T=k.roots.default||(k.roots.default={}),E=T.ServerRequest=(e=>{function e(e){if(e)for(let t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}let t;return e.prototype.id="",e.prototype.verified=!1,e.prototype.finish=null,e.prototype.faceText=null,e.prototype.faceAgreement=null,e.prototype.faceMovement=null,e.prototype.idCard=null,e.prototype.error=null,e.prototype.jobs=null,e.prototype.pong=null,Object.defineProperty(e.prototype,"data",{get:N.oneOfGetter(t=["finish","faceText","faceAgreement","faceMovement","idCard","error","jobs","pong"]),set:N.oneOfSetter(t)}),e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=S.create()),null!=e.id&&Object.hasOwnProperty.call(e,"id")&&t.uint32(10).string(e.id),null!=e.verified&&Object.hasOwnProperty.call(e,"verified")&&t.uint32(16).bool(e.verified),null!=e.finish&&Object.hasOwnProperty.call(e,"finish")&&T.ServerRequest.Finish.encode(e.finish,t.uint32(42).fork()).ldelim(),null!=e.faceText&&Object.hasOwnProperty.call(e,"faceText")&&T.ServerRequest.FaceText.encode(e.faceText,t.uint32(50).fork()).ldelim(),null!=e.faceAgreement&&Object.hasOwnProperty.call(e,"faceAgreement")&&T.ServerRequest.FaceAgreement.encode(e.faceAgreement,t.uint32(58).fork()).ldelim(),null!=e.faceMovement&&Object.hasOwnProperty.call(e,"faceMovement")&&T.ServerRequest.FaceMovement.encode(e.faceMovement,t.uint32(66).fork()).ldelim(),null!=e.idCard&&Object.hasOwnProperty.call(e,"idCard")&&T.ServerRequest.IdCard.encode(e.idCard,t.uint32(74).fork()).ldelim(),null!=e.error&&Object.hasOwnProperty.call(e,"error")&&T.ServerRequest.Error.encode(e.error,t.uint32(82).fork()).ldelim(),null!=e.jobs&&Object.hasOwnProperty.call(e,"jobs")&&T.ServerRequest.Jobs.encode(e.jobs,t.uint32(90).fork()).ldelim(),null!=e.pong&&Object.hasOwnProperty.call(e,"pong")&&T.ServerRequest.Pong.encode(e.pong,t.uint32(98).fork()).ldelim(),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof _||(e=_.create(e));let n=void 0===t?e.len:e.pos+t,r=new T.ServerRequest;for(;e.pos<n;){let t=e.uint32();switch(t>>>3){case 1:r.id=e.string();break;case 2:r.verified=e.bool();break;case 5:r.finish=T.ServerRequest.Finish.decode(e,e.uint32());break;case 6:r.faceText=T.ServerRequest.FaceText.decode(e,e.uint32());break;case 7:r.faceAgreement=T.ServerRequest.FaceAgreement.decode(e,e.uint32());break;case 8:r.faceMovement=T.ServerRequest.FaceMovement.decode(e,e.uint32());break;case 9:r.idCard=T.ServerRequest.IdCard.decode(e,e.uint32());break;case 10:r.error=T.ServerRequest.Error.decode(e,e.uint32());break;case 11:r.jobs=T.ServerRequest.Jobs.decode(e,e.uint32());break;case 12:r.pong=T.ServerRequest.Pong.decode(e,e.uint32());break;default:e.skipType(7&t)}}return r},e.decodeDelimited=function(e){return e instanceof _||(e=new _(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";let t={};if(null!=e.id&&e.hasOwnProperty("id")&&!N.isString(e.id))return"id: string expected";if(null!=e.verified&&e.hasOwnProperty("verified")&&"boolean"!=typeof e.verified)return"verified: boolean expected";if(null!=e.finish&&e.hasOwnProperty("finish")){t.data=1;{let t=T.ServerRequest.Finish.verify(e.finish);if(t)return"finish."+t}}if(null!=e.faceText&&e.hasOwnProperty("faceText")){if(1===t.data)return"data: multiple values";t.data=1;{let t=T.ServerRequest.FaceText.verify(e.faceText);if(t)return"faceText."+t}}if(null!=e.faceAgreement&&e.hasOwnProperty("faceAgreement")){if(1===t.data)return"data: multiple values";t.data=1;{let t=T.ServerRequest.FaceAgreement.verify(e.faceAgreement);if(t)return"faceAgreement."+t}}if(null!=e.faceMovement&&e.hasOwnProperty("faceMovement")){if(1===t.data)return"data: multiple values";t.data=1;{let t=T.ServerRequest.FaceMovement.verify(e.faceMovement);if(t)return"faceMovement."+t}}if(null!=e.idCard&&e.hasOwnProperty("idCard")){if(1===t.data)return"data: multiple values";t.data=1;{let t=T.ServerRequest.IdCard.verify(e.idCard);if(t)return"idCard."+t}}if(null!=e.error&&e.hasOwnProperty("error")){if(1===t.data)return"data: multiple values";t.data=1;{let t=T.ServerRequest.Error.verify(e.error);if(t)return"error."+t}}if(null!=e.jobs&&e.hasOwnProperty("jobs")){if(1===t.data)return"data: multiple values";t.data=1;{let t=T.ServerRequest.Jobs.verify(e.jobs);if(t)return"jobs."+t}}if(null!=e.pong&&e.hasOwnProperty("pong")){if(1===t.data)return"data: multiple values";t.data=1;{let t=T.ServerRequest.Pong.verify(e.pong);if(t)return"pong."+t}}return null},e.fromObject=function(e){if(e instanceof T.ServerRequest)return e;let t=new T.ServerRequest;if(null!=e.id&&(t.id=String(e.id)),null!=e.verified&&(t.verified=Boolean(e.verified)),null!=e.finish){if("object"!=typeof e.finish)throw TypeError(".ServerRequest.finish: object expected");t.finish=T.ServerRequest.Finish.fromObject(e.finish)}if(null!=e.faceText){if("object"!=typeof e.faceText)throw TypeError(".ServerRequest.faceText: object expected");t.faceText=T.ServerRequest.FaceText.fromObject(e.faceText)}if(null!=e.faceAgreement){if("object"!=typeof e.faceAgreement)throw TypeError(".ServerRequest.faceAgreement: object expected");t.faceAgreement=T.ServerRequest.FaceAgreement.fromObject(e.faceAgreement)}if(null!=e.faceMovement){if("object"!=typeof e.faceMovement)throw TypeError(".ServerRequest.faceMovement: object expected");t.faceMovement=T.ServerRequest.FaceMovement.fromObject(e.faceMovement)}if(null!=e.idCard){if("object"!=typeof e.idCard)throw TypeError(".ServerRequest.idCard: object expected");t.idCard=T.ServerRequest.IdCard.fromObject(e.idCard)}if(null!=e.error){if("object"!=typeof e.error)throw TypeError(".ServerRequest.error: object expected");t.error=T.ServerRequest.Error.fromObject(e.error)}if(null!=e.jobs){if("object"!=typeof e.jobs)throw TypeError(".ServerRequest.jobs: object expected");t.jobs=T.ServerRequest.Jobs.fromObject(e.jobs)}if(null!=e.pong){if("object"!=typeof e.pong)throw TypeError(".ServerRequest.pong: object expected");t.pong=T.ServerRequest.Pong.fromObject(e.pong)}return t},e.toObject=function(e,t){t||(t={});let n={};return t.defaults&&(n.id="",n.verified=!1),null!=e.id&&e.hasOwnProperty("id")&&(n.id=e.id),null!=e.verified&&e.hasOwnProperty("verified")&&(n.verified=e.verified),null!=e.finish&&e.hasOwnProperty("finish")&&(n.finish=T.ServerRequest.Finish.toObject(e.finish,t),t.oneofs&&(n.data="finish")),null!=e.faceText&&e.hasOwnProperty("faceText")&&(n.faceText=T.ServerRequest.FaceText.toObject(e.faceText,t),t.oneofs&&(n.data="faceText")),null!=e.faceAgreement&&e.hasOwnProperty("faceAgreement")&&(n.faceAgreement=T.ServerRequest.FaceAgreement.toObject(e.faceAgreement,t),t.oneofs&&(n.data="faceAgreement")),null!=e.faceMovement&&e.hasOwnProperty("faceMovement")&&(n.faceMovement=T.ServerRequest.FaceMovement.toObject(e.faceMovement,t),t.oneofs&&(n.data="faceMovement")),null!=e.idCard&&e.hasOwnProperty("idCard")&&(n.idCard=T.ServerRequest.IdCard.toObject(e.idCard,t),t.oneofs&&(n.data="idCard")),null!=e.error&&e.hasOwnProperty("error")&&(n.error=T.ServerRequest.Error.toObject(e.error,t),t.oneofs&&(n.data="error")),null!=e.jobs&&e.hasOwnProperty("jobs")&&(n.jobs=T.ServerRequest.Jobs.toObject(e.jobs,t),t.oneofs&&(n.data="jobs")),null!=e.pong&&e.hasOwnProperty("pong")&&(n.pong=T.ServerRequest.Pong.toObject(e.pong,t),t.oneofs&&(n.data="pong")),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,k.util.toJSONOptions)},e.Finish=function(e){function e(e){if(e)for(let t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=S.create()),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof _||(e=_.create(e));let n=void 0===t?e.len:e.pos+t,r=new T.ServerRequest.Finish;for(;e.pos<n;){let t=e.uint32();e.skipType(7&t)}return r},e.decodeDelimited=function(e){return e instanceof _||(e=new _(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null},e.fromObject=function(e){return e instanceof T.ServerRequest.Finish?e:new T.ServerRequest.Finish},e.toObject=function(){return{}},e.prototype.toJSON=function(){return this.constructor.toObject(this,k.util.toJSONOptions)},e}(e.Finish||{}),e.Job=function(e){function e(e){if(e)for(let t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.id="",e.prototype.action="",e.prototype.verified=!1,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=S.create()),null!=e.id&&Object.hasOwnProperty.call(e,"id")&&t.uint32(10).string(e.id),null!=e.action&&Object.hasOwnProperty.call(e,"action")&&t.uint32(18).string(e.action),null!=e.verified&&Object.hasOwnProperty.call(e,"verified")&&t.uint32(24).bool(e.verified),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof _||(e=_.create(e));let n=void 0===t?e.len:e.pos+t,r=new T.ServerRequest.Job;for(;e.pos<n;){let t=e.uint32();switch(t>>>3){case 1:r.id=e.string();break;case 2:r.action=e.string();break;case 3:r.verified=e.bool();break;default:e.skipType(7&t)}}return r},e.decodeDelimited=function(e){return e instanceof _||(e=new _(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.id&&e.hasOwnProperty("id")&&!N.isString(e.id)?"id: string expected":null!=e.action&&e.hasOwnProperty("action")&&!N.isString(e.action)?"action: string expected":null!=e.verified&&e.hasOwnProperty("verified")&&"boolean"!=typeof e.verified?"verified: boolean expected":null},e.fromObject=function(e){if(e instanceof T.ServerRequest.Job)return e;let t=new T.ServerRequest.Job;return null!=e.id&&(t.id=String(e.id)),null!=e.action&&(t.action=String(e.action)),null!=e.verified&&(t.verified=Boolean(e.verified)),t},e.toObject=function(e,t){t||(t={});let n={};return t.defaults&&(n.id="",n.action="",n.verified=!1),null!=e.id&&e.hasOwnProperty("id")&&(n.id=e.id),null!=e.action&&e.hasOwnProperty("action")&&(n.action=e.action),null!=e.verified&&e.hasOwnProperty("verified")&&(n.verified=e.verified),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,k.util.toJSONOptions)},e}(e.Job||{}),e.Jobs=function(e){function e(e){if(this.job=[],e)for(let t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.job=N.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=S.create()),null!=e.job&&e.job.length)for(let n=0;n<e.job.length;++n)T.ServerRequest.Job.encode(e.job[n],t.uint32(10).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof _||(e=_.create(e));let n=void 0===t?e.len:e.pos+t,r=new T.ServerRequest.Jobs;for(;e.pos<n;){let t=e.uint32();switch(t>>>3){case 1:r.job&&r.job.length||(r.job=[]),r.job.push(T.ServerRequest.Job.decode(e,e.uint32()));break;default:e.skipType(7&t)}}return r},e.decodeDelimited=function(e){return e instanceof _||(e=new _(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.job&&e.hasOwnProperty("job")){if(!Array.isArray(e.job))return"job: array expected";for(let t=0;t<e.job.length;++t){let n=T.ServerRequest.Job.verify(e.job[t]);if(n)return"job."+n}}return null},e.fromObject=function(e){if(e instanceof T.ServerRequest.Jobs)return e;let t=new T.ServerRequest.Jobs;if(e.job){if(!Array.isArray(e.job))throw TypeError(".ServerRequest.Jobs.job: array expected");t.job=[];for(let n=0;n<e.job.length;++n){if("object"!=typeof e.job[n])throw TypeError(".ServerRequest.Jobs.job: object expected");t.job[n]=T.ServerRequest.Job.fromObject(e.job[n])}}return t},e.toObject=function(e,t){t||(t={});let n={};if((t.arrays||t.defaults)&&(n.job=[]),e.job&&e.job.length){n.job=[];for(let r=0;r<e.job.length;++r)n.job[r]=T.ServerRequest.Job.toObject(e.job[r],t)}return n},e.prototype.toJSON=function(){return this.constructor.toObject(this,k.util.toJSONOptions)},e}(e.Jobs||{}),e.FaceText=function(e){function e(e){if(e)for(let t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.text="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=S.create()),null!=e.text&&Object.hasOwnProperty.call(e,"text")&&t.uint32(18).string(e.text),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof _||(e=_.create(e));let n=void 0===t?e.len:e.pos+t,r=new T.ServerRequest.FaceText;for(;e.pos<n;){let t=e.uint32();switch(t>>>3){case 2:r.text=e.string();break;default:e.skipType(7&t)}}return r},e.decodeDelimited=function(e){return e instanceof _||(e=new _(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.text&&e.hasOwnProperty("text")&&!N.isString(e.text)?"text: string expected":null},e.fromObject=function(e){if(e instanceof T.ServerRequest.FaceText)return e;let t=new T.ServerRequest.FaceText;return null!=e.text&&(t.text=String(e.text)),t},e.toObject=function(e,t){t||(t={});let n={};return t.defaults&&(n.text=""),null!=e.text&&e.hasOwnProperty("text")&&(n.text=e.text),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,k.util.toJSONOptions)},e}(e.FaceText||{}),e.FaceAgreement=function(e){function e(e){if(e)for(let t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.text="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=S.create()),null!=e.text&&Object.hasOwnProperty.call(e,"text")&&t.uint32(18).string(e.text),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof _||(e=_.create(e));let n=void 0===t?e.len:e.pos+t,r=new T.ServerRequest.FaceAgreement;for(;e.pos<n;){let t=e.uint32();switch(t>>>3){case 2:r.text=e.string();break;default:e.skipType(7&t)}}return r},e.decodeDelimited=function(e){return e instanceof _||(e=new _(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.text&&e.hasOwnProperty("text")&&!N.isString(e.text)?"text: string expected":null},e.fromObject=function(e){if(e instanceof T.ServerRequest.FaceAgreement)return e;let t=new T.ServerRequest.FaceAgreement;return null!=e.text&&(t.text=String(e.text)),t},e.toObject=function(e,t){t||(t={});let n={};return t.defaults&&(n.text=""),null!=e.text&&e.hasOwnProperty("text")&&(n.text=e.text),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,k.util.toJSONOptions)},e}(e.FaceAgreement||{}),e.FaceMovement=function(e){function e(e){if(this.directions={},e)for(let t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.directions=N.emptyObject,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=S.create()),null!=e.directions&&Object.hasOwnProperty.call(e,"directions"))for(let n=Object.keys(e.directions),r=0;r<n.length;++r)t.uint32(18).fork().uint32(8).int32(n[r]).uint32(16).int32(e.directions[n[r]]).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof _||(e=_.create(e));let n,r=void 0===t?e.len:e.pos+t,a=new T.ServerRequest.FaceMovement;for(;e.pos<r;){let t=e.uint32();switch(t>>>3){case 2:e.skip().pos++,a.directions===N.emptyObject&&(a.directions={}),n=e.int32(),e.pos++,a.directions[n]=e.int32();break;default:e.skipType(7&t)}}return a},e.decodeDelimited=function(e){return e instanceof _||(e=new _(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.directions&&e.hasOwnProperty("directions")){if(!N.isObject(e.directions))return"directions: object expected";let t=Object.keys(e.directions);for(let n=0;n<t.length;++n){if(!N.key32Re.test(t[n]))return"directions: integer key{k:int32} expected";switch(e.directions[t[n]]){default:return"directions: enum value{k:int32} expected";case 0:case 1:case 2:case 3:}}}return null},e.fromObject=function(e){if(e instanceof T.ServerRequest.FaceMovement)return e;let t=new T.ServerRequest.FaceMovement;if(e.directions){if("object"!=typeof e.directions)throw TypeError(".ServerRequest.FaceMovement.directions: object expected");t.directions={};for(let n=Object.keys(e.directions),r=0;r<n.length;++r)switch(e.directions[n[r]]){case"UP":case 0:t.directions[n[r]]=0;break;case"DOWN":case 1:t.directions[n[r]]=1;break;case"LEFT":case 2:t.directions[n[r]]=2;break;case"RIGHT":case 3:t.directions[n[r]]=3}}return t},e.toObject=function(e,t){t||(t={});let n,r={};if((t.objects||t.defaults)&&(r.directions={}),e.directions&&(n=Object.keys(e.directions)).length){r.directions={};for(let a=0;a<n.length;++a)r.directions[n[a]]=t.enums===String?T.ServerRequest.FaceMovement.Direction[e.directions[n[a]]]:e.directions[n[a]]}return r},e.prototype.toJSON=function(){return this.constructor.toObject(this,k.util.toJSONOptions)},e.Direction=function(){const e={},t=Object.create(e);return t[e[0]="UP"]=0,t[e[1]="DOWN"]=1,t[e[2]="LEFT"]=2,t[e[3]="RIGHT"]=3,t}(),e}(e.FaceMovement||{}),e.IdCard=function(e){function e(e){if(e)for(let t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.placeholder="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=S.create()),null!=e.placeholder&&Object.hasOwnProperty.call(e,"placeholder")&&t.uint32(18).string(e.placeholder),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof _||(e=_.create(e));let n=void 0===t?e.len:e.pos+t,r=new T.ServerRequest.IdCard;for(;e.pos<n;){let t=e.uint32();switch(t>>>3){case 2:r.placeholder=e.string();break;default:e.skipType(7&t)}}return r},e.decodeDelimited=function(e){return e instanceof _||(e=new _(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.placeholder&&e.hasOwnProperty("placeholder")&&!N.isString(e.placeholder)?"placeholder: string expected":null},e.fromObject=function(e){if(e instanceof T.ServerRequest.IdCard)return e;let t=new T.ServerRequest.IdCard;return null!=e.placeholder&&(t.placeholder=String(e.placeholder)),t},e.toObject=function(e,t){t||(t={});let n={};return t.defaults&&(n.placeholder=""),null!=e.placeholder&&e.hasOwnProperty("placeholder")&&(n.placeholder=e.placeholder),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,k.util.toJSONOptions)},e}(e.IdCard||{}),e.Error=function(e){function e(e){if(e)for(let t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.code="",e.prototype.Message="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=S.create()),null!=e.code&&Object.hasOwnProperty.call(e,"code")&&t.uint32(10).string(e.code),null!=e.Message&&Object.hasOwnProperty.call(e,"Message")&&t.uint32(18).string(e.Message),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof _||(e=_.create(e));let n=void 0===t?e.len:e.pos+t,r=new T.ServerRequest.Error;for(;e.pos<n;){let t=e.uint32();switch(t>>>3){case 1:r.code=e.string();break;case 2:r.Message=e.string();break;default:e.skipType(7&t)}}return r},e.decodeDelimited=function(e){return e instanceof _||(e=new _(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.code&&e.hasOwnProperty("code")&&!N.isString(e.code)?"code: string expected":null!=e.Message&&e.hasOwnProperty("Message")&&!N.isString(e.Message)?"Message: string expected":null},e.fromObject=function(e){if(e instanceof T.ServerRequest.Error)return e;let t=new T.ServerRequest.Error;return null!=e.code&&(t.code=String(e.code)),null!=e.Message&&(t.Message=String(e.Message)),t},e.toObject=function(e,t){t||(t={});let n={};return t.defaults&&(n.code="",n.Message=""),null!=e.code&&e.hasOwnProperty("code")&&(n.code=e.code),null!=e.Message&&e.hasOwnProperty("Message")&&(n.Message=e.Message),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,k.util.toJSONOptions)},e}(e.Error||{}),e.Pong=function(e){function e(e){if(e)for(let t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=S.create()),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof _||(e=_.create(e));let n=void 0===t?e.len:e.pos+t,r=new T.ServerRequest.Pong;for(;e.pos<n;){let t=e.uint32();e.skipType(7&t)}return r},e.decodeDelimited=function(e){return e instanceof _||(e=new _(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null},e.fromObject=function(e){return e instanceof T.ServerRequest.Pong?e:new T.ServerRequest.Pong},e.toObject=function(){return{}},e.prototype.toJSON=function(){return this.constructor.toObject(this,k.util.toJSONOptions)},e}(e.Pong||{}),e})(T.ServerRequest||{}),I=(T.ServerRequestList=(e=>{function e(e){if(this.serverRequests=[],e)for(let t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.serverRequests=N.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=S.create()),null!=e.serverRequests&&e.serverRequests.length)for(let n=0;n<e.serverRequests.length;++n)T.ServerRequest.encode(e.serverRequests[n],t.uint32(10).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof _||(e=_.create(e));let n=void 0===t?e.len:e.pos+t,r=new T.ServerRequestList;for(;e.pos<n;){let t=e.uint32();switch(t>>>3){case 1:r.serverRequests&&r.serverRequests.length||(r.serverRequests=[]),r.serverRequests.push(T.ServerRequest.decode(e,e.uint32()));break;default:e.skipType(7&t)}}return r},e.decodeDelimited=function(e){return e instanceof _||(e=new _(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.serverRequests&&e.hasOwnProperty("serverRequests")){if(!Array.isArray(e.serverRequests))return"serverRequests: array expected";for(let t=0;t<e.serverRequests.length;++t){let n=T.ServerRequest.verify(e.serverRequests[t]);if(n)return"serverRequests."+n}}return null},e.fromObject=function(e){if(e instanceof T.ServerRequestList)return e;let t=new T.ServerRequestList;if(e.serverRequests){if(!Array.isArray(e.serverRequests))throw TypeError(".ServerRequestList.serverRequests: array expected");t.serverRequests=[];for(let n=0;n<e.serverRequests.length;++n){if("object"!=typeof e.serverRequests[n])throw TypeError(".ServerRequestList.serverRequests: object expected");t.serverRequests[n]=T.ServerRequest.fromObject(e.serverRequests[n])}}return t},e.toObject=function(e,t){t||(t={});let n={};if((t.arrays||t.defaults)&&(n.serverRequests=[]),e.serverRequests&&e.serverRequests.length){n.serverRequests=[];for(let r=0;r<e.serverRequests.length;++r)n.serverRequests[r]=T.ServerRequest.toObject(e.serverRequests[r],t)}return n},e.prototype.toJSON=function(){return this.constructor.toObject(this,k.util.toJSONOptions)},e})(T.ServerRequestList||{}),T.ClientRequest=(e=>{function e(e){if(e)for(let t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}let t;return e.prototype.id="",e.prototype.start=null,e.prototype.faceText=null,e.prototype.faceAgreement=null,e.prototype.faceMovement=null,e.prototype.idCard=null,e.prototype.error=null,e.prototype.ping=null,Object.defineProperty(e.prototype,"data",{get:N.oneOfGetter(t=["start","faceText","faceAgreement","faceMovement","idCard","error","ping"]),set:N.oneOfSetter(t)}),e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=S.create()),null!=e.id&&Object.hasOwnProperty.call(e,"id")&&t.uint32(10).string(e.id),null!=e.start&&Object.hasOwnProperty.call(e,"start")&&T.ClientRequest.Start.encode(e.start,t.uint32(42).fork()).ldelim(),null!=e.faceText&&Object.hasOwnProperty.call(e,"faceText")&&T.ClientRequest.FaceText.encode(e.faceText,t.uint32(50).fork()).ldelim(),null!=e.faceAgreement&&Object.hasOwnProperty.call(e,"faceAgreement")&&T.ClientRequest.FaceAgreement.encode(e.faceAgreement,t.uint32(58).fork()).ldelim(),null!=e.faceMovement&&Object.hasOwnProperty.call(e,"faceMovement")&&T.ClientRequest.FaceMovement.encode(e.faceMovement,t.uint32(66).fork()).ldelim(),null!=e.idCard&&Object.hasOwnProperty.call(e,"idCard")&&T.ClientRequest.IdCard.encode(e.idCard,t.uint32(74).fork()).ldelim(),null!=e.error&&Object.hasOwnProperty.call(e,"error")&&T.ClientRequest.Error.encode(e.error,t.uint32(82).fork()).ldelim(),null!=e.ping&&Object.hasOwnProperty.call(e,"ping")&&T.ClientRequest.Ping.encode(e.ping,t.uint32(98).fork()).ldelim(),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof _||(e=_.create(e));let n=void 0===t?e.len:e.pos+t,r=new T.ClientRequest;for(;e.pos<n;){let t=e.uint32();switch(t>>>3){case 1:r.id=e.string();break;case 5:r.start=T.ClientRequest.Start.decode(e,e.uint32());break;case 6:r.faceText=T.ClientRequest.FaceText.decode(e,e.uint32());break;case 7:r.faceAgreement=T.ClientRequest.FaceAgreement.decode(e,e.uint32());break;case 8:r.faceMovement=T.ClientRequest.FaceMovement.decode(e,e.uint32());break;case 9:r.idCard=T.ClientRequest.IdCard.decode(e,e.uint32());break;case 10:r.error=T.ClientRequest.Error.decode(e,e.uint32());break;case 12:r.ping=T.ClientRequest.Ping.decode(e,e.uint32());break;default:e.skipType(7&t)}}return r},e.decodeDelimited=function(e){return e instanceof _||(e=new _(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";let t={};if(null!=e.id&&e.hasOwnProperty("id")&&!N.isString(e.id))return"id: string expected";if(null!=e.start&&e.hasOwnProperty("start")){t.data=1;{let t=T.ClientRequest.Start.verify(e.start);if(t)return"start."+t}}if(null!=e.faceText&&e.hasOwnProperty("faceText")){if(1===t.data)return"data: multiple values";t.data=1;{let t=T.ClientRequest.FaceText.verify(e.faceText);if(t)return"faceText."+t}}if(null!=e.faceAgreement&&e.hasOwnProperty("faceAgreement")){if(1===t.data)return"data: multiple values";t.data=1;{let t=T.ClientRequest.FaceAgreement.verify(e.faceAgreement);if(t)return"faceAgreement."+t}}if(null!=e.faceMovement&&e.hasOwnProperty("faceMovement")){if(1===t.data)return"data: multiple values";t.data=1;{let t=T.ClientRequest.FaceMovement.verify(e.faceMovement);if(t)return"faceMovement."+t}}if(null!=e.idCard&&e.hasOwnProperty("idCard")){if(1===t.data)return"data: multiple values";t.data=1;{let t=T.ClientRequest.IdCard.verify(e.idCard);if(t)return"idCard."+t}}if(null!=e.error&&e.hasOwnProperty("error")){if(1===t.data)return"data: multiple values";t.data=1;{let t=T.ClientRequest.Error.verify(e.error);if(t)return"error."+t}}if(null!=e.ping&&e.hasOwnProperty("ping")){if(1===t.data)return"data: multiple values";t.data=1;{let t=T.ClientRequest.Ping.verify(e.ping);if(t)return"ping."+t}}return null},e.fromObject=function(e){if(e instanceof T.ClientRequest)return e;let t=new T.ClientRequest;if(null!=e.id&&(t.id=String(e.id)),null!=e.start){if("object"!=typeof e.start)throw TypeError(".ClientRequest.start: object expected");t.start=T.ClientRequest.Start.fromObject(e.start)}if(null!=e.faceText){if("object"!=typeof e.faceText)throw TypeError(".ClientRequest.faceText: object expected");t.faceText=T.ClientRequest.FaceText.fromObject(e.faceText)}if(null!=e.faceAgreement){if("object"!=typeof e.faceAgreement)throw TypeError(".ClientRequest.faceAgreement: object expected");t.faceAgreement=T.ClientRequest.FaceAgreement.fromObject(e.faceAgreement)}if(null!=e.faceMovement){if("object"!=typeof e.faceMovement)throw TypeError(".ClientRequest.faceMovement: object expected");t.faceMovement=T.ClientRequest.FaceMovement.fromObject(e.faceMovement)}if(null!=e.idCard){if("object"!=typeof e.idCard)throw TypeError(".ClientRequest.idCard: object expected");t.idCard=T.ClientRequest.IdCard.fromObject(e.idCard)}if(null!=e.error){if("object"!=typeof e.error)throw TypeError(".ClientRequest.error: object expected");t.error=T.ClientRequest.Error.fromObject(e.error)}if(null!=e.ping){if("object"!=typeof e.ping)throw TypeError(".ClientRequest.ping: object expected");t.ping=T.ClientRequest.Ping.fromObject(e.ping)}return t},e.toObject=function(e,t){t||(t={});let n={};return t.defaults&&(n.id=""),null!=e.id&&e.hasOwnProperty("id")&&(n.id=e.id),null!=e.start&&e.hasOwnProperty("start")&&(n.start=T.ClientRequest.Start.toObject(e.start,t),t.oneofs&&(n.data="start")),null!=e.faceText&&e.hasOwnProperty("faceText")&&(n.faceText=T.ClientRequest.FaceText.toObject(e.faceText,t),t.oneofs&&(n.data="faceText")),null!=e.faceAgreement&&e.hasOwnProperty("faceAgreement")&&(n.faceAgreement=T.ClientRequest.FaceAgreement.toObject(e.faceAgreement,t),t.oneofs&&(n.data="faceAgreement")),null!=e.faceMovement&&e.hasOwnProperty("faceMovement")&&(n.faceMovement=T.ClientRequest.FaceMovement.toObject(e.faceMovement,t),t.oneofs&&(n.data="faceMovement")),null!=e.idCard&&e.hasOwnProperty("idCard")&&(n.idCard=T.ClientRequest.IdCard.toObject(e.idCard,t),t.oneofs&&(n.data="idCard")),null!=e.error&&e.hasOwnProperty("error")&&(n.error=T.ClientRequest.Error.toObject(e.error,t),t.oneofs&&(n.data="error")),null!=e.ping&&e.hasOwnProperty("ping")&&(n.ping=T.ClientRequest.Ping.toObject(e.ping,t),t.oneofs&&(n.data="ping")),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,k.util.toJSONOptions)},e.Start=function(e){function e(e){if(e)for(let t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.identifier="",e.prototype.appName="",e.prototype.packageName="",e.prototype.manufacturer="",e.prototype.platform="",e.prototype.platformVersion="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=S.create()),null!=e.identifier&&Object.hasOwnProperty.call(e,"identifier")&&t.uint32(10).string(e.identifier),null!=e.appName&&Object.hasOwnProperty.call(e,"appName")&&t.uint32(18).string(e.appName),null!=e.packageName&&Object.hasOwnProperty.call(e,"packageName")&&t.uint32(26).string(e.packageName),null!=e.manufacturer&&Object.hasOwnProperty.call(e,"manufacturer")&&t.uint32(34).string(e.manufacturer),null!=e.platform&&Object.hasOwnProperty.call(e,"platform")&&t.uint32(42).string(e.platform),null!=e.platformVersion&&Object.hasOwnProperty.call(e,"platformVersion")&&t.uint32(50).string(e.platformVersion),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof _||(e=_.create(e));let n=void 0===t?e.len:e.pos+t,r=new T.ClientRequest.Start;for(;e.pos<n;){let t=e.uint32();switch(t>>>3){case 1:r.identifier=e.string();break;case 2:r.appName=e.string();break;case 3:r.packageName=e.string();break;case 4:r.manufacturer=e.string();break;case 5:r.platform=e.string();break;case 6:r.platformVersion=e.string();break;default:e.skipType(7&t)}}return r},e.decodeDelimited=function(e){return e instanceof _||(e=new _(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.identifier&&e.hasOwnProperty("identifier")&&!N.isString(e.identifier)?"identifier: string expected":null!=e.appName&&e.hasOwnProperty("appName")&&!N.isString(e.appName)?"appName: string expected":null!=e.packageName&&e.hasOwnProperty("packageName")&&!N.isString(e.packageName)?"packageName: string expected":null!=e.manufacturer&&e.hasOwnProperty("manufacturer")&&!N.isString(e.manufacturer)?"manufacturer: string expected":null!=e.platform&&e.hasOwnProperty("platform")&&!N.isString(e.platform)?"platform: string expected":null!=e.platformVersion&&e.hasOwnProperty("platformVersion")&&!N.isString(e.platformVersion)?"platformVersion: string expected":null},e.fromObject=function(e){if(e instanceof T.ClientRequest.Start)return e;let t=new T.ClientRequest.Start;return null!=e.identifier&&(t.identifier=String(e.identifier)),null!=e.appName&&(t.appName=String(e.appName)),null!=e.packageName&&(t.packageName=String(e.packageName)),null!=e.manufacturer&&(t.manufacturer=String(e.manufacturer)),null!=e.platform&&(t.platform=String(e.platform)),null!=e.platformVersion&&(t.platformVersion=String(e.platformVersion)),t},e.toObject=function(e,t){t||(t={});let n={};return t.defaults&&(n.identifier="",n.appName="",n.packageName="",n.manufacturer="",n.platform="",n.platformVersion=""),null!=e.identifier&&e.hasOwnProperty("identifier")&&(n.identifier=e.identifier),null!=e.appName&&e.hasOwnProperty("appName")&&(n.appName=e.appName),null!=e.packageName&&e.hasOwnProperty("packageName")&&(n.packageName=e.packageName),null!=e.manufacturer&&e.hasOwnProperty("manufacturer")&&(n.manufacturer=e.manufacturer),null!=e.platform&&e.hasOwnProperty("platform")&&(n.platform=e.platform),null!=e.platformVersion&&e.hasOwnProperty("platformVersion")&&(n.platformVersion=e.platformVersion),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,k.util.toJSONOptions)},e}(e.Start||{}),e.FaceText=function(e){function e(e){if(e)for(let t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.video=N.newBuffer([]),e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=S.create()),null!=e.video&&Object.hasOwnProperty.call(e,"video")&&t.uint32(10).bytes(e.video),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof _||(e=_.create(e));let n=void 0===t?e.len:e.pos+t,r=new T.ClientRequest.FaceText;for(;e.pos<n;){let t=e.uint32();switch(t>>>3){case 1:r.video=e.bytes();break;default:e.skipType(7&t)}}return r},e.decodeDelimited=function(e){return e instanceof _||(e=new _(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.video&&e.hasOwnProperty("video")&&!(e.video&&"number"==typeof e.video.length||N.isString(e.video))?"video: buffer expected":null},e.fromObject=function(e){if(e instanceof T.ClientRequest.FaceText)return e;let t=new T.ClientRequest.FaceText;return null!=e.video&&("string"==typeof e.video?N.base64.decode(e.video,t.video=N.newBuffer(N.base64.length(e.video)),0):e.video.length&&(t.video=e.video)),t},e.toObject=function(e,t){t||(t={});let n={};return t.defaults&&(t.bytes===String?n.video="":(n.video=[],t.bytes!==Array&&(n.video=N.newBuffer(n.video)))),null!=e.video&&e.hasOwnProperty("video")&&(n.video=t.bytes===String?N.base64.encode(e.video,0,e.video.length):t.bytes===Array?Array.prototype.slice.call(e.video):e.video),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,k.util.toJSONOptions)},e}(e.FaceText||{}),e.FaceAgreement=function(e){function e(e){if(e)for(let t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.video=N.newBuffer([]),e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=S.create()),null!=e.video&&Object.hasOwnProperty.call(e,"video")&&t.uint32(10).bytes(e.video),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof _||(e=_.create(e));let n=void 0===t?e.len:e.pos+t,r=new T.ClientRequest.FaceAgreement;for(;e.pos<n;){let t=e.uint32();switch(t>>>3){case 1:r.video=e.bytes();break;default:e.skipType(7&t)}}return r},e.decodeDelimited=function(e){return e instanceof _||(e=new _(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.video&&e.hasOwnProperty("video")&&!(e.video&&"number"==typeof e.video.length||N.isString(e.video))?"video: buffer expected":null},e.fromObject=function(e){if(e instanceof T.ClientRequest.FaceAgreement)return e;let t=new T.ClientRequest.FaceAgreement;return null!=e.video&&("string"==typeof e.video?N.base64.decode(e.video,t.video=N.newBuffer(N.base64.length(e.video)),0):e.video.length&&(t.video=e.video)),t},e.toObject=function(e,t){t||(t={});let n={};return t.defaults&&(t.bytes===String?n.video="":(n.video=[],t.bytes!==Array&&(n.video=N.newBuffer(n.video)))),null!=e.video&&e.hasOwnProperty("video")&&(n.video=t.bytes===String?N.base64.encode(e.video,0,e.video.length):t.bytes===Array?Array.prototype.slice.call(e.video):e.video),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,k.util.toJSONOptions)},e}(e.FaceAgreement||{}),e.FaceMovement=function(e){function e(e){if(e)for(let t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.video=N.newBuffer([]),e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=S.create()),null!=e.video&&Object.hasOwnProperty.call(e,"video")&&t.uint32(10).bytes(e.video),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof _||(e=_.create(e));let n=void 0===t?e.len:e.pos+t,r=new T.ClientRequest.FaceMovement;for(;e.pos<n;){let t=e.uint32();switch(t>>>3){case 1:r.video=e.bytes();break;default:e.skipType(7&t)}}return r},e.decodeDelimited=function(e){return e instanceof _||(e=new _(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.video&&e.hasOwnProperty("video")&&!(e.video&&"number"==typeof e.video.length||N.isString(e.video))?"video: buffer expected":null},e.fromObject=function(e){if(e instanceof T.ClientRequest.FaceMovement)return e;let t=new T.ClientRequest.FaceMovement;return null!=e.video&&("string"==typeof e.video?N.base64.decode(e.video,t.video=N.newBuffer(N.base64.length(e.video)),0):e.video.length&&(t.video=e.video)),t},e.toObject=function(e,t){t||(t={});let n={};return t.defaults&&(t.bytes===String?n.video="":(n.video=[],t.bytes!==Array&&(n.video=N.newBuffer(n.video)))),null!=e.video&&e.hasOwnProperty("video")&&(n.video=t.bytes===String?N.base64.encode(e.video,0,e.video.length):t.bytes===Array?Array.prototype.slice.call(e.video):e.video),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,k.util.toJSONOptions)},e}(e.FaceMovement||{}),e.IdCard=function(e){function e(e){if(e)for(let t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.image=N.newBuffer([]),e.prototype.faceBox=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=S.create()),null!=e.image&&Object.hasOwnProperty.call(e,"image")&&t.uint32(10).bytes(e.image),null!=e.faceBox&&Object.hasOwnProperty.call(e,"faceBox")&&T.ClientRequest.box.encode(e.faceBox,t.uint32(18).fork()).ldelim(),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof _||(e=_.create(e));let n=void 0===t?e.len:e.pos+t,r=new T.ClientRequest.IdCard;for(;e.pos<n;){let t=e.uint32();switch(t>>>3){case 1:r.image=e.bytes();break;case 2:r.faceBox=T.ClientRequest.box.decode(e,e.uint32());break;default:e.skipType(7&t)}}return r},e.decodeDelimited=function(e){return e instanceof _||(e=new _(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.image&&e.hasOwnProperty("image")&&!(e.image&&"number"==typeof e.image.length||N.isString(e.image)))return"image: buffer expected";if(null!=e.faceBox&&e.hasOwnProperty("faceBox")){let t=T.ClientRequest.box.verify(e.faceBox);if(t)return"faceBox."+t}return null},e.fromObject=function(e){if(e instanceof T.ClientRequest.IdCard)return e;let t=new T.ClientRequest.IdCard;if(null!=e.image&&("string"==typeof e.image?N.base64.decode(e.image,t.image=N.newBuffer(N.base64.length(e.image)),0):e.image.length&&(t.image=e.image)),null!=e.faceBox){if("object"!=typeof e.faceBox)throw TypeError(".ClientRequest.IdCard.faceBox: object expected");t.faceBox=T.ClientRequest.box.fromObject(e.faceBox)}return t},e.toObject=function(e,t){t||(t={});let n={};return t.defaults&&(t.bytes===String?n.image="":(n.image=[],t.bytes!==Array&&(n.image=N.newBuffer(n.image))),n.faceBox=null),null!=e.image&&e.hasOwnProperty("image")&&(n.image=t.bytes===String?N.base64.encode(e.image,0,e.image.length):t.bytes===Array?Array.prototype.slice.call(e.image):e.image),null!=e.faceBox&&e.hasOwnProperty("faceBox")&&(n.faceBox=T.ClientRequest.box.toObject(e.faceBox,t)),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,k.util.toJSONOptions)},e}(e.IdCard||{}),e.box=function(e){function e(e){if(e)for(let t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.x=0,e.prototype.y=0,e.prototype.w=0,e.prototype.h=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=S.create()),null!=e.x&&Object.hasOwnProperty.call(e,"x")&&t.uint32(8).int32(e.x),null!=e.y&&Object.hasOwnProperty.call(e,"y")&&t.uint32(16).int32(e.y),null!=e.w&&Object.hasOwnProperty.call(e,"w")&&t.uint32(24).int32(e.w),null!=e.h&&Object.hasOwnProperty.call(e,"h")&&t.uint32(32).int32(e.h),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof _||(e=_.create(e));let n=void 0===t?e.len:e.pos+t,r=new T.ClientRequest.box;for(;e.pos<n;){let t=e.uint32();switch(t>>>3){case 1:r.x=e.int32();break;case 2:r.y=e.int32();break;case 3:r.w=e.int32();break;case 4:r.h=e.int32();break;default:e.skipType(7&t)}}return r},e.decodeDelimited=function(e){return e instanceof _||(e=new _(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.x&&e.hasOwnProperty("x")&&!N.isInteger(e.x)?"x: integer expected":null!=e.y&&e.hasOwnProperty("y")&&!N.isInteger(e.y)?"y: integer expected":null!=e.w&&e.hasOwnProperty("w")&&!N.isInteger(e.w)?"w: integer expected":null!=e.h&&e.hasOwnProperty("h")&&!N.isInteger(e.h)?"h: integer expected":null},e.fromObject=function(e){if(e instanceof T.ClientRequest.box)return e;let t=new T.ClientRequest.box;return null!=e.x&&(t.x=0|e.x),null!=e.y&&(t.y=0|e.y),null!=e.w&&(t.w=0|e.w),null!=e.h&&(t.h=0|e.h),t},e.toObject=function(e,t){t||(t={});let n={};return t.defaults&&(n.x=0,n.y=0,n.w=0,n.h=0),null!=e.x&&e.hasOwnProperty("x")&&(n.x=e.x),null!=e.y&&e.hasOwnProperty("y")&&(n.y=e.y),null!=e.w&&e.hasOwnProperty("w")&&(n.w=e.w),null!=e.h&&e.hasOwnProperty("h")&&(n.h=e.h),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,k.util.toJSONOptions)},e}(e.box||{}),e.Error=function(e){function e(e){if(e)for(let t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.code="",e.prototype.Message="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=S.create()),null!=e.code&&Object.hasOwnProperty.call(e,"code")&&t.uint32(10).string(e.code),null!=e.Message&&Object.hasOwnProperty.call(e,"Message")&&t.uint32(18).string(e.Message),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof _||(e=_.create(e));let n=void 0===t?e.len:e.pos+t,r=new T.ClientRequest.Error;for(;e.pos<n;){let t=e.uint32();switch(t>>>3){case 1:r.code=e.string();break;case 2:r.Message=e.string();break;default:e.skipType(7&t)}}return r},e.decodeDelimited=function(e){return e instanceof _||(e=new _(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.code&&e.hasOwnProperty("code")&&!N.isString(e.code)?"code: string expected":null!=e.Message&&e.hasOwnProperty("Message")&&!N.isString(e.Message)?"Message: string expected":null},e.fromObject=function(e){if(e instanceof T.ClientRequest.Error)return e;let t=new T.ClientRequest.Error;return null!=e.code&&(t.code=String(e.code)),null!=e.Message&&(t.Message=String(e.Message)),t},e.toObject=function(e,t){t||(t={});let n={};return t.defaults&&(n.code="",n.Message=""),null!=e.code&&e.hasOwnProperty("code")&&(n.code=e.code),null!=e.Message&&e.hasOwnProperty("Message")&&(n.Message=e.Message),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,k.util.toJSONOptions)},e}(e.Error||{}),e.Ping=function(e){function e(e){if(e)for(let t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=S.create()),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof _||(e=_.create(e));let n=void 0===t?e.len:e.pos+t,r=new T.ClientRequest.Ping;for(;e.pos<n;){let t=e.uint32();e.skipType(7&t)}return r},e.decodeDelimited=function(e){return e instanceof _||(e=new _(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null},e.fromObject=function(e){return e instanceof T.ClientRequest.Ping?e:new T.ClientRequest.Ping},e.toObject=function(){return{}},e.prototype.toJSON=function(){return this.constructor.toObject(this,k.util.toJSONOptions)},e}(e.Ping||{}),e})(T.ClientRequest||{}));var O=function(){function e(e,t){if(this.identifier=e,this.serverAdder=t,this.events={},this.sendChannel=[],this.closed=!1,!this.serverAdder){var n="https:"===window.location.protocol?"wss:":"ws:";this.serverAdder=n+"//"+window.location.host+"/ws"}}return e.prototype.start=function(){this.connect(this.serverAdder)},e.prototype.connect=function(e){var t=this;this.client=new WebSocket(e),this.client.binaryType="arraybuffer";var n=this;this.client.onopen=function(){var e=I.create({id:"",start:{identifier:n.identifier}}),t=I.encode(e).finish();n.client.send(t),console.log("connection ready."),n.wsWorker()},this.client.onmessage=function(e){var t=E.decode(new Uint8Array(e.data));if("pong"!=t.data)return n.events[t.data]?(console.log("handling: ",t.data),void n.events[t.data](t)):void console.log("handler not found: ",t.data)},this.pingInterval=setInterval((function(){t.send(I.encode(I.create({ping:{}})).finish())}),1e4),this.client.onclose=function(r){t.closed||(clearInterval(t.pingInterval),t.pingInterval=null,console.log("Socket is closed. Reconnect will be attempted in 1 second.",r.reason),setTimeout((function(){n.connect(e)}),1e3))},this.client.onerror=function(e){console.error("Socket encountered error, Closing socket.",e,"Closing socket"),n.client.close()}},e.prototype.waitForSocketConnection=function(e){var t=this;setTimeout((function(){1===t.client.readyState?e():t.waitForSocketConnection(e)}),40)},e.prototype.connectionReady=function(){var e=this;return new Promise((function(t){e.waitForSocketConnection((function(){t()}))}))},e.prototype.registerEvent=function(e,t){this.events[e]=t},e.prototype.send=function(e){this.sendChannel.push(e)},e.prototype.wsWorker=function(){var e=this,t=function(){return n=e,r=void 0,s=function(){return function(e,t){var n,r,a,s,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function i(s){return function(i){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&s[0]?r.return:s[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,s[1])).done)return a;switch(r=0,a&&(s=[2&s[0],a.value]),s[0]){case 0:case 1:a=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((a=(a=o.trys).length>0&&a[a.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!a||s[1]>a[0]&&s[1]<a[3])){o.label=s[1];break}if(6===s[0]&&o.label<a[1]){o.label=a[1],a=s;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(s);break}a[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],r=0}finally{n=a=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,i])}}}(this,(function(e){switch(e.label){case 0:return[4,this.connectionReady()];case 1:return e.sent(),this.sendChannel.length>0&&this.client.send(this.sendChannel.pop()),setTimeout(t,100),[2]}}))},new((a=void 0)||(a=Promise))((function(e,t){function o(e){try{u(s.next(e))}catch(e){t(e)}}function i(e){try{u(s.throw(e))}catch(e){t(e)}}function u(t){var n;t.done?e(t.value):(n=t.value,n instanceof a?n:new a((function(e){e(n)}))).then(o,i)}u((s=s.apply(n,r||[])).next())}));var n,r,a,s};t()},e.prototype.close=function(){this.client.close(),this.closed=!0},e}(),A=function(){function e(e,t,n,r){this.serverRequest=e,this.ws=t,this.container=n,this.eventManager=r,this.draw()}return e.prototype.getJobId=function(){return this.serverRequest.id},e.prototype.draw=function(){},e.prototype.retry=function(){},e}(),M=function(){function e(e){this.video=e}return e.prototype.setup=function(e){return void 0===e&&(e="user"),t=this,n=void 0,a=function(){var t,n,r=this;return function(e,t){var n,r,a,s,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function i(s){return function(i){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&s[0]?r.return:s[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,s[1])).done)return a;switch(r=0,a&&(s=[2&s[0],a.value]),s[0]){case 0:case 1:a=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((a=(a=o.trys).length>0&&a[a.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!a||s[1]>a[0]&&s[1]<a[3])){o.label=s[1];break}if(6===s[0]&&o.label<a[1]){o.label=a[1],a=s;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(s);break}a[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],r=0}finally{n=a=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,i])}}}(this,(function(a){switch(a.label){case 0:return this.video.muted=!0,t=this.video,n=this,[4,navigator.mediaDevices.getUserMedia({audio:!0,video:{facingMode:e}})];case 1:return t.srcObject=n.cameraStream=a.sent(),[2,new Promise((function(e){r.video&&(r.video.onloadeddata=function(){r.video&&e(r.video)})}))]}}))},new((r=void 0)||(r=Promise))((function(e,s){function o(e){try{u(a.next(e))}catch(e){s(e)}}function i(e){try{u(a.throw(e))}catch(e){s(e)}}function u(t){var n;t.done?e(t.value):(n=t.value,n instanceof r?n:new r((function(e){e(n)}))).then(o,i)}u((a=a.apply(t,n||[])).next())}));var t,n,r,a},e.prototype.capture=function(){var e=this;return new Promise((function(t){var n,r=document.createElement("canvas");r.width=e.video.videoWidth,r.height=e.video.videoHeight,null===(n=r.getContext("2d"))||void 0===n||n.drawImage(e.video,0,0,e.video.videoWidth,e.video.videoHeight),r.toBlob((function(e){t(e)}))}))},e.prototype.cleanup=function(){this.cameraStream&&this.cameraStream.getTracks().forEach((function(e){return e.stop()})),this.video.pause(),this.video.srcObject=null},e.prototype.getStream=function(){return this.cameraStream},e}();class C{constructor(e,t){this.backend=e,this.dataMover=t,this.data=new WeakMap,this.dataIdsCount=0}get(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}set(e,t){this.dataIdsCount++,this.data.set(e,t)}has(e){return this.data.has(e)}delete(e){return this.dataIdsCount--,this.data.delete(e)}numDataIds(){return this.dataIdsCount}}class R{refCount(e){return D("refCount")}incRef(e){return D("incRef")}timerAvailable(){return!0}time(e){return D("time")}read(e){return D("read")}readSync(e){return D("readSync")}numDataIds(){return D("numDataIds")}disposeData(e,t){return D("disposeData")}write(e,t,n){return D("write")}move(e,t,n,r,a){return D("move")}memory(){return D("memory")}floatPrecision(){return D("floatPrecision")}epsilon(){return 32===this.floatPrecision()?1e-7:1e-4}dispose(){return D("dispose")}}function D(e){throw new Error(`'${e}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}function F(e,t,n){return Math.max(e,Math.min(t,n))}function $(e,t){if(!e)throw new Error("string"==typeof t?t:t())}function P(e,t,n=""){$(q(e,t),(()=>n+` Shapes ${e} and ${t} must match`))}function j(e){$(null!=e,(()=>"The input to the tensor constructor must be a non-null value."))}function B(e,t=[],n=!1){if(null==t&&(t=[]),Array.isArray(e)||U(e)&&!n)for(let r=0;r<e.length;++r)B(e[r],t,n);else t.push(e);return t}function L(e){if(0===e.length)return 1;let t=e[0];for(let n=1;n<e.length;n++)t*=e[n];return t}function q(e,t){if(e===t)return!0;if(null==e||null==t)return!1;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function z(e){return e%1==0}function V(e,t){return t<=e.length?e:e+" ".repeat(t-e.length)}function W(e,t){const n=t.length;return $((e=null==e?t.map(((e,t)=>t)):[].concat(e)).every((e=>e>=-n&&e<n)),(()=>`All values in axis param must be in range [-${n}, ${n}) but got axis ${e}`)),$(e.every((e=>z(e))),(()=>`All values in axis param must be integers but got axis ${e}`)),e.map((e=>e<0?n+e:e))}function H(e,t){let n=null;if(null==e||"float32"===e)n=new Float32Array(t);else if("int32"===e)n=new Int32Array(t);else if("bool"===e)n=new Uint8Array(t);else{if("string"!==e)throw new Error(`Unknown data type ${e}`);n=new Array(t)}return n}function U(e){return e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array}function K(e){if("float32"===e||"int32"===e)return 4;if("complex64"===e)return 8;if("bool"===e)return 1;throw new Error(`Unknown dtype ${e}`)}function G(e){return"string"==typeof e||e instanceof String}function J(e){return Array.isArray(e)?J(e[0]):e instanceof Float32Array?"float32":e instanceof Int32Array||e instanceof Uint8Array?"int32":"number"==typeof e?"float32":G(e)?"string":"boolean"==typeof e?"bool":"float32"}function Y(e){return!!(e&&e.constructor&&e.call&&e.apply)}function X(e){const t=e.length;if(t<2)return[];const n=new Array(t-1);n[t-2]=e[t-1];for(let r=t-3;r>=0;--r)n[r]=n[r+1]*e[r+1];return n}function Z(e,t,n,r=!1){const a=new Array;if(1===t.length){const s=t[0]*(r?2:1);for(let t=0;t<s;t++)a[t]=n[e+t]}else{const s=t[0],o=t.slice(1),i=o.reduce(((e,t)=>e*t))*(r?2:1);for(let t=0;t<s;t++)a[t]=Z(e+t*i,o,n,r)}return a}function Q(e,t,n=!1){if(0===e.length)return t[0];const r=e.reduce(((e,t)=>e*t))*(n?2:1);if(0===r)return[];if(r!==t.length)throw new Error(`[${e}] does not match the input size ${t.length}${n?" for a complex tensor":""}.`);return Z(0,e,t,n)}function ee(e,t){const n=te(e,t);for(let e=0;e<n.length;e++)n[e]=1;return n}function te(e,t){if(null==t||"float32"===t||"complex64"===t)return new Float32Array(e);if("int32"===t)return new Int32Array(e);if("bool"===t)return new Uint8Array(e);throw new Error(`Unknown data type ${t}`)}function ne(e){e.forEach((t=>{$(Number.isInteger(t)&&t>=0,(()=>`Tensor must have a shape comprised of positive integers but got shape [${e}].`))}))}function re(e){return e&&e.then&&"function"==typeof e.then}function ae(...e){ie().getBool("IS_TEST")||ie().getBool("PROD")||console.warn(...e)}class se{constructor(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=oe,this.populateURLFlags()}setPlatform(e,t){null!=this.platform&&ae(`Platform ${this.platformName} has already been set. Overwriting the platform with ${t}.`),this.platformName=e,this.platform=t}registerFlag(e,t,n){if(this.flagRegistry[e]={evaluationFn:t,setHook:n},null!=this.urlFlags[e]){const t=this.urlFlags[e];ae(`Setting feature override from URL ${e}: ${t}.`),this.set(e,t)}}async getAsync(e){return e in this.flags||(this.flags[e]=await this.evaluateFlag(e)),this.flags[e]}get(e){if(e in this.flags)return this.flags[e];const t=this.evaluateFlag(e);if(re(t))throw new Error(`Flag ${e} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[e]=t,this.flags[e]}getNumber(e){return this.get(e)}getBool(e){return this.get(e)}getFlags(){return this.flags}get features(){return this.flags}set(e,t){if(null==this.flagRegistry[e])throw new Error(`Cannot set flag ${e} as it has not been registered.`);this.flags[e]=t,null!=this.flagRegistry[e].setHook&&this.flagRegistry[e].setHook(t)}evaluateFlag(e){if(null==this.flagRegistry[e])throw new Error(`Cannot evaluate flag '${e}': no evaluation function found.`);return this.flagRegistry[e].evaluationFn()}setFlags(e){this.flags=Object.assign({},e)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(void 0===this.global||void 0===this.global.location||void 0===this.global.location.search)return;const e=this.getQueryParams(this.global.location.search);"tfjsflags"in e&&e.tfjsflags.split(",").forEach((e=>{const[t,n]=e.split(":");this.urlFlags[t]=function(e,t){if("true"===(t=t.toLowerCase())||"false"===t)return"true"===t;if(""+ +t===t)return+t;throw new Error(`Could not parse value flag value ${t} for flag ${e}.`)}(t,n)}))}}function oe(e){const t={};return e.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,((e,...n)=>(function(e,t,n){e[decodeURIComponent(t)]=decodeURIComponent(n||"")}(t,n[0],n[1]),n.join("=")))),t}function ie(){return ce}let ue,ce=null;function le(){if(null==ue){let e;if("undefined"!=typeof window)e=window;else if(void 0!==n.g)e=n.g;else if("undefined"!=typeof process)e=process;else{if("undefined"==typeof self)throw new Error("Could not find a global object");e=self}ue=e}return ue}function pe(e,t){const n=function(){const e=le();return null==e._tfGlobals&&(e._tfGlobals=new Map),e._tfGlobals}();if(n.has(e))return n.get(e);{const r=t();return n.set(e,r),n.get(e)}}const de="Add",he="AddN",fe="All",me="Any",ye="ArgMax",ge="AvgPool",be="BatchMatMul",we="BatchToSpaceND",ve="Cast",xe="Ceil",ke="ClipByValue",_e="Concat",Se="Conv2D",Ne="Conv2DBackpropInput",Te="Cosh",Ee="Cumsum",Ie="CropAndResize",Oe="DepthToSpace",Ae="DepthwiseConv2dNative",Me="RealDiv",Ce="Equal",Re="ExpandDims",De="Fill",Fe="FlipLeftRight",$e="Floor",Pe="FloorDiv",je="FusedBatchNorm",Be="GatherV2",Le="GatherNd",qe="Greater",ze="GreaterEqual",Ve="Identity",We="LeakyRelu",He="Less",Ue="LessEqual",Ke="LogicalAnd",Ge="Max",Je="Maximum",Ye="MaxPool",Xe="Mean",Ze="Min",Qe="Minimum",et="MirrorPad",tt="Multiply",nt="NotEqual",rt="NonMaxSuppressionV3",at="NonMaxSuppressionV4",st="NonMaxSuppressionV5",ot="OnesLike",it="OneHot",ut="Pack",ct="PadV2",lt="Prelu",pt="Prod",dt="Range",ht="Relu",ft="Reshape",mt="ResizeBilinear",yt="Relu6",gt="Reverse",bt="Round",wt="Rsqrt",vt="ScatterNd",xt="Select",kt="Slice",_t="Sigmoid",St="Sqrt",Nt="Sum",Tt="SpaceToBatchND",Et="SplitV",It="Softmax",Ot="SquaredDifference",At="StridedSlice",Mt="Tanh",Ct="Tile",Rt="TopK",Dt="Transform",Ft="Transpose",$t="Unpack",Pt="ZerosLike",jt="Step",Bt="FromPixels",Lt="RotateWithOffset",qt="_FusedMatMul",zt="FusedConv2D",Vt="FusedDepthwiseConv2D",Wt=pe("kernelRegistry",(()=>new Map)),Ht=pe("gradRegistry",(()=>new Map));function Ut(e,t){const n=Yt(e,t);return Wt.get(n)}function Kt(e){return Ht.get(e)}function Gt(e){const t=Wt.entries(),n=[];for(;;){const{done:r,value:a}=t.next();if(r)break;const[s,o]=a,[i]=s.split("_");i===e&&n.push(o)}return n}function Jt(e){const{kernelName:t,backendName:n}=e,r=Yt(t,n);Wt.has(r)&&ae(`The kernel '${t}' for backend '${n}' is already registered`),Wt.set(r,e)}function Yt(e,t){return`${t}_${e}`}var Xt=n(8072);const Zt=n.n(Xt)()||Xt;function Qt(e){return Zt.fromString(e,!0,16)}function en(e,t){if("string"===t)throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(e)&&(e=B(e)),ie().getBool("DEBUG")&&function(e,t){for(let n=0;n<e.length;n++){const r=e[n];if(isNaN(r)||!isFinite(r))throw Error(`A tensor of type ${t} being uploaded contains ${r}.`)}}(e,t),function(e,t){return e instanceof Float32Array&&"float32"===t||e instanceof Int32Array&&"int32"===t||e instanceof Uint8Array&&"bool"===t}(e,t))return e;if(null==t||"float32"===t||"complex64"===t)return new Float32Array(e);if("int32"===t)return new Int32Array(e);if("bool"===t){const t=new Uint8Array(e.length);for(let n=0;n<t.length;++n)0!==Math.round(e[n])&&(t[n]=1);return t}throw new Error(`Unknown data type ${t}`)}function tn(){return ie().platform.now()}function nn(e,t="utf-8"){return t=t||"utf-8",ie().platform.encode(e,t)}function rn(e,t="utf-8"){return t=t||"utf-8",ie().platform.decode(e,t)}Qt("c3a5c85c97cb3127"),Qt("b492b66fbe98f273"),Qt("9ae16a3b2f90404f");class an{constructor(e,t){this.backendTimer=e,this.logger=t,null==t&&(this.logger=new on)}profileKernel(e,t,n){let r;const a=()=>{r=n()};let s;const o=tn();if(this.backendTimer.timerAvailable())s=this.backendTimer.time(a);else{a();for(const e of r)e.dataSync();s=Promise.resolve({kernelMs:tn()-o})}if(ie().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let t=0;t<r.length;t++){const n=r[t];n.data().then((t=>{sn(t,n.dtype,e)}))}return{kernelName:e,outputs:r,inputs:t,timeMs:s.then((e=>e.kernelMs)),extraInfo:s.then((e=>null!=e.getExtraProfileInfo?e.getExtraProfileInfo():""))}}logKernelProfile(e){const{kernelName:t,outputs:n,timeMs:r,inputs:a,extraInfo:s}=e;n.forEach((e=>{Promise.all([e.data(),r,s]).then((n=>{this.logger.logKernelProfile(t,e,n[0],n[1],a,n[2])}))}))}}function sn(e,t,n){if("float32"!==t)return!1;for(let t=0;t<e.length;t++){const r=e[t];if(isNaN(r)||!isFinite(r))return console.warn(`Found ${r} in the result of '${n}'`),!0}return!1}class on{logKernelProfile(e,t,n,r,a,s){const o="number"==typeof r?V(`${r}ms`,9):r.error,i=V(e,25),u=t.rank,c=t.size,l=V(t.shape.toString(),14);let p="";for(const e in a){const n=a[e];if(null!=n){const r=n.shape||t.shape,a=r.length;p+=`${e}: ${a}D ${a>0?r:""} `}}console.log(`%c${i}\t%c${o}\t%c${u}D ${l}\t%c${c}\t%c${p}\t%c${s}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}function un(e,t,n,r){const a=X(t),s=function(e,t,n,r){const a=L(t),s=r[r.length-1],o=new Array(s).fill(0),i=t.length,u="complex64"===n?dn(e):e;if(i>1)for(let e=0;e<a/s;e++){const t=e*s;for(let e=0;e<s;e++)o[e]=Math.max(o[e],cn(u[t+e],0,n).length)}return o}(e,t,n,a),o=t.length,i=pn(e,t,n,a,s),u=["Tensor"];return r&&(u.push(`  dtype: ${n}`),u.push(`  rank: ${o}`),u.push(`  shape: [${t}]`),u.push("  values:")),u.push(i.map((e=>"    "+e)).join("\n")),u.join("\n")}function cn(e,t,n){let r;return r=Array.isArray(e)?`${parseFloat(e[0].toFixed(7))} + ${parseFloat(e[1].toFixed(7))}j`:G(e)?`'${e}'`:"bool"===n?ln(e):parseFloat(e.toFixed(7)).toString(),V(r,t)}function ln(e){return 0===e?"false":"true"}function pn(e,t,n,r,a,s=!0){const o="complex64"===n?2:1,i=t[0],u=t.length;if(0===u)return"complex64"===n?[cn(dn(e)[0],0,n)]:"bool"===n?[ln(e[0])]:[e[0].toString()];if(1===u){if(i>20){const t=3*o;let r=Array.from(e.slice(0,t)),s=Array.from(e.slice((i-3)*o,i*o));return"complex64"===n&&(r=dn(r),s=dn(s)),["["+r.map(((e,t)=>cn(e,a[t],n))).join(", ")+", ..., "+s.map(((e,t)=>cn(e,a[i-3+t],n))).join(", ")+"]"]}return["["+("complex64"===n?dn(e):Array.from(e)).map(((e,t)=>cn(e,a[t],n))).join(", ")+"]"]}const c=t.slice(1),l=r.slice(1),p=r[0]*o,d=[];if(i>20){for(let t=0;t<3;t++){const r=t*p,s=r+p;d.push(...pn(e.slice(r,s),c,n,l,a,!1))}d.push("...");for(let t=i-3;t<i;t++){const r=t*p,s=r+p;d.push(...pn(e.slice(r,s),c,n,l,a,t===i-1))}}else for(let t=0;t<i;t++){const r=t*p,s=r+p;d.push(...pn(e.slice(r,s),c,n,l,a,t===i-1))}const h=2===u?",":"";d[0]="["+d[0]+h;for(let e=1;e<d.length-1;e++)d[e]=" "+d[e]+h;let f=",\n";for(let e=2;e<u;e++)f+="\n";return d[d.length-1]=" "+d[d.length-1]+"]"+(s?"":f),d}function dn(e){const t=[];for(let n=0;n<e.length;n+=2)t.push([e[n],e[n+1]]);return t}class hn{constructor(e,t,n){if(this.dtype=t,this.shape=e.slice(),this.size=L(e),null!=n){const e=n.length;$(e===this.size,(()=>`Length of values '${e}' does not match the size inferred by the shape '${this.size}'.`))}if("complex64"===t)throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=n||H(t,this.size),this.strides=X(e)}set(e,...t){0===t.length&&(t=[0]),$(t.length===this.rank,(()=>`The number of provided coordinates (${t.length}) must match the rank (${this.rank})`));const n=this.locToIndex(t);this.values[n]=e}get(...e){0===e.length&&(e=[0]);let t=0;for(const n of e){if(n<0||n>=this.shape[t]){const t=`Requested out of range element at ${e}.   Buffer shape=${this.shape}`;throw new Error(t)}t++}let n=e[e.length-1];for(let t=0;t<e.length-1;++t)n+=this.strides[t]*e[t];return this.values[n]}locToIndex(e){if(0===this.rank)return 0;if(1===this.rank)return e[0];let t=e[e.length-1];for(let n=0;n<e.length-1;++n)t+=this.strides[n]*e[n];return t}indexToLoc(e){if(0===this.rank)return[];if(1===this.rank)return[e];const t=new Array(this.shape.length);for(let n=0;n<t.length-1;++n)t[n]=Math.floor(e/this.strides[n]),e-=t[n]*this.strides[n];return t[t.length-1]=e,t}get rank(){return this.shape.length}toTensor(){return fn().makeTensor(this.values,this.shape,this.dtype)}}let fn=null,mn=null,yn=null;class gn{constructor(e,t,n,r){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=t||"float32",this.size=L(e),this.strides=X(e),this.dataId=n,this.id=r,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const e=await this.data();return mn.buffer(this.shape,this.dtype,e)}bufferSync(){return mn.buffer(this.shape,this.dtype,this.dataSync())}async array(){const e=await this.data();return Q(this.shape,e,"complex64"===this.dtype)}arraySync(){return Q(this.shape,this.dataSync(),"complex64"===this.dtype)}async data(){this.throwIfDisposed();const e=fn().read(this.dataId);if("string"===this.dtype){const t=await e;try{return t.map((e=>rn(e)))}catch(e){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return e}dataSync(){this.throwIfDisposed();const e=fn().readSync(this.dataId);if("string"===this.dtype)try{return e.map((e=>rn(e)))}catch(e){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}async bytes(){this.throwIfDisposed();const e=await fn().read(this.dataId);return"string"===this.dtype?e:new Uint8Array(e.buffer)}dispose(){this.isDisposed||(fn().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(e=!1){return mn.print(this,e)}clone(){return this.throwIfDisposed(),mn.clone(this)}toString(e=!1){return un(this.dataSync(),this.shape,this.dtype,e)}cast(e){return this.throwIfDisposed(),mn.cast(this,e)}variable(e=!0,t,n){return this.throwIfDisposed(),fn().makeVariable(this,e,t,n)}}Object.defineProperty(gn,Symbol.hasInstance,{value:e=>!!e&&null!=e.data&&null!=e.dataSync&&null!=e.throwIfDisposed}),pe("Tensor",(()=>gn));class bn extends gn{constructor(e,t,n,r){super(e.shape,e.dtype,e.dataId,r),this.trainable=t,this.name=n}assign(e){if(e.dtype!==this.dtype)throw new Error(`dtype of the new value (${e.dtype}) and previous value (${this.dtype}) must match`);if(!q(e.shape,this.shape))throw new Error(`shape of the new value (${e.shape}) and previous value (${this.shape}) must match`);fn().disposeTensor(this),this.dataId=e.dataId,fn().incRef(this,null)}dispose(){fn().disposeVariable(this),this.isDisposedInternal=!0}}var wn,vn,xn,kn,_n;Object.defineProperty(bn,Symbol.hasInstance,{value:e=>e instanceof gn&&null!=e.assign&&e.assign instanceof Function}),function(e){e.R0="R0",e.R1="R1",e.R2="R2",e.R3="R3",e.R4="R4",e.R5="R5",e.R6="R6"}(wn||(wn={})),function(e){e.float32="float32",e.int32="int32",e.bool="int32",e.complex64="complex64"}(vn||(vn={})),function(e){e.float32="float32",e.int32="int32",e.bool="bool",e.complex64="complex64"}(xn||(xn={})),function(e){e.float32="float32",e.int32="float32",e.bool="float32",e.complex64="complex64"}(kn||(kn={})),function(e){e.float32="complex64",e.int32="complex64",e.bool="complex64",e.complex64="complex64"}(_n||(_n={}));const Sn={float32:kn,int32:vn,bool:xn,complex64:_n};function Nn(e,t){if(e.dtype===t.dtype)return[e,t];const n=function(e,t){if("string"===e||"string"===t){if("string"===e&&"string"===t)return"string";throw new Error(`Can not upcast ${e} with ${t}`)}return Sn[e][t]}(e.dtype,t.dtype);return[e.cast(n),t.cast(n)]}function Tn(e){const t=[];return En(e,t,new Set),t}function En(e,t,n){if(null==e)return;if(e instanceof gn)return void t.push(e);if(r=e,!Array.isArray(r)&&"object"!=typeof r)return;var r;const a=e;for(const e in a){const r=a[e];n.has(r)||(n.add(r),En(r,t,n))}}function In(e){return null!=e.kernelName}class On{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map((e=>e.name))))}}}dispose(){for(const e in this.registeredVariables)this.registeredVariables[e].dispose()}}class An{constructor(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new On}async ready(){if(null!=this.pendingBackendInit)return this.pendingBackendInit.then((()=>{}));if(null!=this.backendInstance)return;const e=this.getSortedBackends();for(let t=0;t<e.length;t++){const n=e[t];if(await this.initializeBackend(n).success)return void await this.setBackend(n)}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(null!=this.pendingBackendInit)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(null==this.backendInstance){const{name:e,asyncInit:t}=this.initializeBackendsAndReturnBest();if(t)throw new Error(`The highest priority backend '${e}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(e)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(e){if(!(e in this.registry)){if(!(e in this.registryFactory))return null;{const{asyncInit:t}=this.initializeBackend(e);if(t)return null}}return this.registry[e]}findBackendFactory(e){return e in this.registryFactory?this.registryFactory[e].factory:null}registerBackend(e,t,n=1){return e in this.registryFactory?(ae(`${e} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[e]={factory:t,priority:n},!0)}async setBackend(e){if(null==this.registryFactory[e])throw new Error(`Backend name '${e}' not found in registry`);if(this.backendName=e,null==this.registry[e]){this.backendInstance=null;const{success:t,asyncInit:n}=this.initializeBackend(e);if(!(n?await t:t))return!1}return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new an(this.backendInstance),!0}setupRegisteredKernels(){Gt(this.backendName).forEach((e=>{null!=e.setupFunc&&e.setupFunc(this.backendInstance)}))}disposeRegisteredKernels(e){Gt(e).forEach((t=>{null!=t.disposeFunc&&t.disposeFunc(this.registry[e])}))}initializeBackend(e){const t=this.registryFactory[e];if(null==t)throw new Error(`Cannot initialize backend ${e}, no registration found.`);try{const n=t.factory();if(!n||n instanceof R||"function"!=typeof n.then)return this.registry[e]=n,{success:!0,asyncInit:!1};{const t=++this.pendingBackendInitId,r=n.then((n=>!(t<this.pendingBackendInitId||(this.registry[e]=n,this.pendingBackendInit=null,0)))).catch((n=>(t<this.pendingBackendInitId||(this.pendingBackendInit=null,ae(`Initialization of backend ${e} failed`),ae(n.stack||n.message)),!1)));return this.pendingBackendInit=r,{success:r,asyncInit:!0}}}catch(t){return ae(`Initialization of backend ${e} failed`),ae(t.stack||t.message),{success:!1,asyncInit:!1}}}removeBackend(e){if(!(e in this.registryFactory))throw new Error(`${e} backend not found in registry`);this.backendName===e&&null!=this.pendingBackendInit&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(0===Object.keys(this.registryFactory).length)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort(((e,t)=>this.registryFactory[t].priority-this.registryFactory[e].priority))}initializeBackendsAndReturnBest(){const e=this.getSortedBackends();for(let t=0;t<e.length;t++){const n=e[t],{success:r,asyncInit:a}=this.initializeBackend(n);if(a||r)return{name:n,asyncInit:a}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(e,t){const n=this.state.tensorInfo.get(t),r=n.backend,a=this.readSync(t),s=r.refCount(t);r.disposeData(t,!0),n.backend=e,e.move(t,a,n.shape,n.dtype,s),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(e,t){let n,r=null;if(null==t){if("function"!=typeof e)throw new Error("Please provide a function to tidy()");t=e}else{if("string"!=typeof e&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if("function"!=typeof t)throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");r=e}return this.scopedRun((()=>this.startScope(r)),(()=>this.endScope(n)),(()=>(n=t(),n instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),n)))}scopedRun(e,t,n){e();try{const e=n();return t(),e}catch(e){throw t(),e}}nextTensorId(){return An.nextTensorId++}nextVariableId(){return An.nextVariableId++}clone(e){const t=Cn.runKernel(Ve,{x:e}),n={x:e};return this.addTapeNode(this.state.activeScope.name,n,[t],(e=>({x:()=>{const t={x:e};return Cn.runKernel(ve,t,{dtype:"float32"})}})),[],{}),t}runKernel(e,t,n){if(null==this.backendName&&this.backend,null==Ut(e,this.backendName))throw new Error(`Kernel '${e}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:e,inputs:t,attrs:n})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(e,t,n){const r=this.backend.numDataIds();let a=0;n.forEach((e=>{a+="complex64"===e.dtype?3:1}));const s=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],o=r-t-a-s;if(o>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${o} data ids) after running '${e}'`)}runKernelFunc(e){let t,n=[];const r=this.isTapeOn(),a=this.state.numBytes,s=this.state.numTensors;let o,i;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0),null==this.backendName&&this.backend;const u=In(e)?e.kernelName:null!=this.state.activeScope?this.state.activeScope.name:"";if(In(e)){const{kernelName:t,inputs:a,attrs:s}=e;null==this.backendName&&this.backend;const u=Ut(t,this.backendName);$(null!=u,(()=>`Cannot find registered kernel '${t}' for backend '${this.backendName}'`)),o=()=>{const e=this.backend.numDataIds();i=u.kernelFunc({inputs:a,attrs:s,backend:this.backend});const o=Array.isArray(i)?i:[i];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(t,e,o);const c=o.map((e=>{if(null!=e.rank)return e;const{dataId:t,shape:n,dtype:r}=e;return this.makeTensorFromDataId(t,n,r)}));if(r){const e=this.getTensorsForGradient(t,a,c);n=this.saveTensorsForBackwardMode(e)}return c}}else{const{forwardFunc:t}=e,a=e=>{r&&(n=e.map((e=>this.keep(this.clone(e)))))};o=()=>{const e=this.backend.numDataIds();i=this.tidy((()=>t(this.backend,a)));const n=Array.isArray(i)?i:[i];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(u,e,n),n}}const{inputs:c,attrs:l}=e,p=In(e)?null:e.backwardsFunc;let d;return this.scopedRun((()=>this.state.kernelDepth++),(()=>this.state.kernelDepth--),(()=>{this.ENV.getBool("DEBUG")||this.state.profiling?(d=this.profiler.profileKernel(u,c,(()=>o())),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(d),t=d.outputs):t=o()})),r&&this.addTapeNode(u,c,t,p,n,l),this.state.profiling&&this.state.activeProfile.kernels.push({name:u,bytesAdded:this.state.numBytes-a,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-s,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(c).map((e=>null!=c[e]?c[e].shape:null)),outputShapes:t.map((e=>e.shape)),kernelTimeMs:d.timeMs,extraInfo:d.extraInfo}),Array.isArray(i)?t:t[0]}saveTensorsForBackwardMode(e){return e.map((e=>this.keep(this.clone(e))))}getTensorsForGradient(e,t,n){const r=Kt(e);if(null!=r){const e=r.inputsToSave||[],a=r.outputsToSave||[];let s;r.saveAllInputs?($(Array.isArray(t),(()=>"saveAllInputs is true, expected inputs to be an array.")),s=Object.keys(t).map((e=>t[e]))):s=e.map((e=>t[e]));const o=n.filter(((e,t)=>a[t]));return s.concat(o)}return[]}makeTensor(e,t,n,r){if(null==e)throw new Error("Values passed to engine.makeTensor() are null");n=n||"float32",r=r||this.backend;let a=e;"string"===n&&G(e[0])&&(a=e.map((e=>nn(e))));const s=r.write(a,t,n),o=new gn(t,n,s,this.nextTensorId());if(this.trackTensor(o,r),"string"===n){const e=this.state.tensorInfo.get(s),t=function(e){if(null==e)return 0;let t=0;return e.forEach((e=>t+=e.length)),t}(a);this.state.numBytes+=t-e.bytes,e.bytes=t}return o}makeTensorFromDataId(e,t,n,r){const a=new gn(t,n=n||"float32",e,this.nextTensorId());return this.trackTensor(a,r),a}makeVariable(e,t=!0,n,r){n=n||this.nextVariableId().toString(),null!=r&&r!==e.dtype&&(e=e.cast(r));const a=new bn(e,t,n,this.nextTensorId());if(null!=this.state.registeredVariables[a.name])throw new Error(`Variable with name ${a.name} was already registered`);return this.state.registeredVariables[a.name]=a,this.incRef(a,this.backend),a}trackTensor(e,t){this.state.numTensors++,"string"===e.dtype&&this.state.numStringTensors++;let n=0;"complex64"!==e.dtype&&"string"!==e.dtype&&(n=e.size*K(e.dtype)),this.state.numBytes+=n,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:t||this.backend,dtype:e.dtype,shape:e.shape,bytes:n})),e instanceof bn||this.track(e)}incRef(e,t){this.trackTensor(e,t),this.backend.incRef(e.dataId)}removeDataId(e,t){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===t&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)}disposeTensor(e){if(!this.state.tensorInfo.has(e.dataId))return;const t=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,"string"===e.dtype&&(this.state.numStringTensors--,this.state.numBytes-=t.bytes),"complex64"!==e.dtype&&"string"!==e.dtype){const t=e.size*K(e.dtype);this.state.numBytes-=t}t.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,t.backend)}disposeVariables(){for(const e in this.state.registeredVariables){const t=this.state.registeredVariables[e];this.disposeVariable(t)}}disposeVariable(e){this.disposeTensor(e),null!=this.state.registeredVariables[e.name]&&delete this.state.registeredVariables[e.name]}memory(){const e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,null==e.reasons&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}async profile(e){this.state.profiling=!0;const t=this.state.numBytes,n=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map((e=>e.totalBytesSnapshot))),this.state.activeProfile.newBytes=this.state.numBytes-t,this.state.activeProfile.newTensors=this.state.numTensors-n;for(const e of this.state.activeProfile.kernels)e.kernelTimeMs=await e.kernelTimeMs,e.extraInfo=await e.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&0===this.state.kernelDepth}addTapeNode(e,t,n,r,a,s){const o={id:this.state.nextTapeNodeId++,kernelName:e,inputs:t,outputs:n,saved:a},i=Kt(e);null!=i&&(r=i.gradFunc),null!=r&&(o.gradient=e=>(e=e.map(((e,t)=>{if(null==e){const e=n[t],r=te(e.size,e.dtype);return this.makeTensor(r,e.shape,e.dtype)}return e})),r(e.length>1?e:e[0],a,s))),this.state.activeTape.push(o)}keep(e){return e.kept=!0,e}startTape(){0===this.state.gradientDepth&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(e){const t={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(t.name=e),this.state.scopeStack.push(t),this.state.activeScope=t}endScope(e){const t=Tn(e),n=new Set(t.map((e=>e.id)));for(let e=0;e<this.state.activeScope.track.length;e++){const t=this.state.activeScope.track[e];t.kept||n.has(t.id)||t.dispose()}const r=this.state.scopeStack.pop();this.state.activeScope=0===this.state.scopeStack.length?null:this.state.scopeStack[this.state.scopeStack.length-1],t.forEach((e=>{e.kept||e.scopeId!==r.id||this.track(e)}))}gradients(e,t,n,r=!1){if($(t.length>0,(()=>"gradients() received an empty list of xs.")),null!=n&&"float32"!==n.dtype)throw new Error(`dy must have 'float32' dtype, but has '${n.dtype}'`);const a=this.scopedRun((()=>this.startTape()),(()=>this.endTape()),(()=>this.tidy("forward",e)));$(a instanceof gn,(()=>"The result y returned by f() must be a tensor."));const s=function(e,t,n){const r={},a={};for(let e=0;e<t.length;e++)r[t[e].id]=!0;for(let n=0;n<e.length;n++){const s=e[n],o=s.inputs;for(const e in o){const n=o[e];let i=!1;for(let e=0;e<t.length;e++)if(r[n.id]){s.outputs.forEach((e=>r[e.id]=!0)),i=!0,a[s.id]=!0;break}if(i)break}}const s={};s[n.id]=!0;const o={};for(let t=e.length-1;t>=0;t--){const n=e[t],r=n.inputs;for(let e=0;e<n.outputs.length;e++)if(s[n.outputs[e].id]){for(const e in r)s[r[e].id]=!0,o[n.id]=!0;break}}const i=[];for(let t=0;t<e.length;t++){const n=e[t];if(a[n.id]&&o[n.id]){const e={};for(const t in n.inputs){const a=n.inputs[t];r[a.id]&&(e[t]=a)}const t=Object.assign({},n);t.inputs=e,t.outputs=n.outputs,i.push(t)}}return i}(this.state.activeTape,t,a);if(!r&&0===s.length&&t.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",(()=>{const e={};e[a.id]=null==n?function(e){const t=ee(L(e),"float32");return Cn.makeTensor(t,e,"float32")}(a.shape):n,function(e,t,n,r){for(let a=t.length-1;a>=0;a--){const s=t[a],o=[];if(s.outputs.forEach((t=>{const n=e[t.id];null!=n?o.push(n):o.push(null)})),null==s.gradient)throw new Error(`Cannot compute gradient: gradient function not found for ${s.kernelName}.`);const i=s.gradient(o);for(const t in s.inputs){if(!(t in i))throw new Error(`Cannot backprop through input ${t}. Available gradients found: ${Object.keys(i)}.`);const a=n((()=>i[t]()));if("float32"!==a.dtype)throw new Error(`Error in gradient for op ${s.kernelName}. The gradient of input ${t} must have 'float32' dtype, but has '${a.dtype}'`);const o=s.inputs[t];if(!q(a.shape,o.shape))throw new Error(`Error in gradient for op ${s.kernelName}. The gradient of input '${t}' has shape '${a.shape}', which does not match the shape of the input '${o.shape}'`);if(null==e[o.id])e[o.id]=a;else{const t=e[o.id];e[o.id]=r(t,a),t.dispose()}}}}(e,s,(e=>this.tidy(e)),Rn);const r=t.map((t=>e[t.id]));return 0===this.state.gradientDepth&&(this.state.activeTape.forEach((e=>{for(const t of e.saved)t.dispose()})),this.state.activeTape=null),{value:a,grads:r}}))}customGrad(e){return $(Y(e),(()=>"The f passed in customGrad(f) must be a function.")),(...t)=>{let n;$(t.every((e=>e instanceof gn)),(()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors"));const r={};return t.forEach(((e,t)=>{r[t]=e})),this.runKernelFunc({forwardFunc:(r,a)=>(n=e(...t,a),$(n.value instanceof gn,(()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor")),$(Y(n.gradFunc),(()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function.")),n.value),backwardsFunc:(e,r)=>{const a=n.gradFunc(e,r),s=Array.isArray(a)?a:[a];$(s.length===t.length,(()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...).")),$(s.every((e=>e instanceof gn)),(()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."));const o={};return s.forEach(((e,t)=>{o[t]=()=>e})),o},inputs:r})}}readSync(e){return this.state.tensorInfo.get(e).backend.readSync(e)}read(e){return this.state.tensorInfo.get(e).backend.read(e)}async time(e){const t=tn(),n=await this.backend.time(e);return n.wallMs=tn()-t,n}track(e){return null!=this.state.activeScope&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new On;for(const e in this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}function Mn(){const e=le();if(null==e._tfengine){const t=new se(e);e._tfengine=new An(t)}var t;return t=e._tfengine.ENV,ce=t,fn=()=>e._tfengine,e._tfengine}An.nextTensorId=0,An.nextVariableId=0;const Cn=Mn();function Rn(e,t){const n={a:e,b:t};return Cn.runKernel(de,n)}const Dn=ie();function Fn(e,t){let n=e;if(U(e))return"string"===t?[]:[e.length];if(!Array.isArray(e))return[];const r=[];for(;Array.isArray(n)||U(n)&&"string"!==t;)r.push(n.length),n=n[0];return Array.isArray(e)&&ie().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&$n(e,r,[]),r}function $n(e,t,n){if(n=n||[],!Array.isArray(e)&&!U(e))return void $(0===t.length,(()=>`Element arr[${n.join("][")}] is a primitive, but should be an array/TypedArray of ${t[0]} elements`));$(t.length>0,(()=>`Element arr[${n.join("][")}] should be a primitive, but is an array of ${e.length} elements`)),$(e.length===t[0],(()=>`Element arr[${n.join("][")}] should have ${t[0]} elements, but has ${e.length} elements`));const r=t.slice(1);for(let t=0;t<e.length;++t)$n(e[t],r,n.concat(t))}function Pn(e,t,n,r){if("string_or_numeric"!==e){if(null==e)throw new Error("Expected dtype cannot be null.");if("numeric"!==e&&e!==t||"numeric"===e&&"string"===t)throw new Error(`Argument '${n}' passed to '${r}' must be ${e} tensor, but got ${t} tensor`)}}function jn(e,t,n,r="numeric"){if(e instanceof gn)return Pn(r,e.dtype,t,n),e;let a=J(e);if("string"!==a&&["bool","int32","float32"].indexOf(r)>=0&&(a=r),Pn(r,a,t,n),null==e||!U(e)&&!Array.isArray(e)&&"number"!=typeof e&&"boolean"!=typeof e&&"string"!=typeof e){const r=null==e?"null":e.constructor.name;throw new Error(`Argument '${t}' passed to '${n}' must be a Tensor or TensorLike, but got '${r}'`)}const s=Fn(e,a);U(e)||Array.isArray(e)||(e=[e]);const o="string"!==a?en(e,a):B(e,[],!0);return Cn.makeTensor(o,s,a)}function Bn(e,t,n,r="numeric"){if(!Array.isArray(e))throw new Error(`Argument ${t} passed to ${n} must be a \`Tensor[]\` or \`TensorLike[]\``);return e.map(((e,a)=>jn(e,`${t}[${a}]`,n,r)))}function Ln(e){const t=Object.keys(e);if(1!==t.length)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${t.length} keys.`);let n=t[0];const r=e[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n+="__op";const a=(...e)=>{Cn.startScope(n);try{const t=r(...e);return re(t)&&console.error("Cannot return a Promise inside of tidy."),Cn.endScope(t),t}catch(e){throw Cn.endScope(null),e}};return Object.defineProperty(a,"name",{value:n,configurable:!0}),a}Dn.registerFlag("DEBUG",(()=>!1),(e=>{e&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")})),Dn.registerFlag("IS_BROWSER",(()=>"undefined"!=typeof window&&null!=window.document||"undefined"!=typeof WorkerGlobalScope)),Dn.registerFlag("IS_NODE",(()=>"undefined"!=typeof process&&void 0!==process.versions&&void 0!==process.versions.node)),Dn.registerFlag("IS_CHROME",(()=>"undefined"!=typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor))),Dn.registerFlag("PROD",(()=>!1)),Dn.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",(()=>Dn.getBool("DEBUG"))),Dn.registerFlag("DEPRECATION_WARNINGS_ENABLED",(()=>!0)),Dn.registerFlag("IS_TEST",(()=>!1)),Dn.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",(()=>!0)),Dn.registerFlag("WRAP_TO_IMAGEBITMAP",(()=>!1));const qn=Ln({complex_:function(e,t){const n=jn(e,"real","complex"),r=jn(t,"imag","complex");P(n.shape,r.shape,`real and imag shapes, ${n.shape} and ${r.shape}, must match in call to tf.complex().`);const a={real:n,imag:r};return Cn.runKernel("Complex",a)}});function zn(e,t,n,r){if(null==r&&(r=J(e)),"complex64"===r)throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!U(e)&&!Array.isArray(e)&&"number"!=typeof e&&"boolean"!=typeof e&&"string"!=typeof e)throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(null!=t){ne(t);const e=L(t),r=L(n);$(e===r,(()=>`Based on the provided shape, [${t}], the tensor should have ${e} values but has ${r}`));for(let e=0;e<n.length;++e){const r=n[e],a=e!==n.length-1||r!==L(t.slice(e));$(n[e]===t[e]||!a,(()=>`Error creating a new Tensor. Inferred shape (${n}) does not match the provided shape (${t}). `))}}return U(e)||Array.isArray(e)||(e=[e]),t=t||n,e="string"!==r?en(e,r):B(e,[],!0),Cn.makeTensor(e,t,r)}function Vn(e,t,n){return zn(e,t,Fn(e,n),n)}const Wn={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8};const Hn="undefined"!=typeof Buffer&&("undefined"==typeof Blob||"undefined"==typeof atob||"undefined"==typeof btoa);function Un(e){return Hn?Buffer.byteLength(e):new Blob([e]).size}function Kn(e){if(1===e.length)return e[0];let t=0;e.forEach((e=>{t+=e.byteLength}));const n=new Uint8Array(t);let r=0;return e.forEach((e=>{n.set(new Uint8Array(e),r),r+=e.byteLength})),n.buffer}function Gn(e,t){const n={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,weightsManifest:t};return null!=e.signature&&(n.signature=e.signature),null!=e.userDefinedMetadata&&(n.userDefinedMetadata=e.userDefinedMetadata),null!=e.modelInitializer&&(n.modelInitializer=e.modelInitializer),null!=e.trainingConfig&&(n.trainingConfig=e.trainingConfig),n}function Jn(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:null==e.modelTopology?0:Un(JSON.stringify(e.modelTopology)),weightSpecsBytes:null==e.weightSpecs?0:Un(JSON.stringify(e.weightSpecs)),weightDataBytes:null==e.weightData?0:e.weightData.byteLength}}function Yn(){const e=function(){const e=e=>{let t=e<<13,n=0;for(;0==(8388608&t);)n-=8388608,t<<=1;return t&=-8388609,n+=947912704,t|n},t=new Uint32Array(2048);t[0]=0;for(let n=1;n<1024;n++)t[n]=e(n);for(let e=1024;e<2048;e++)t[e]=939524096+(e-1024<<13);return t}(),t=function(){const e=new Uint32Array(64);e[0]=0,e[31]=1199570944,e[32]=2147483648,e[63]=3347054592;for(let t=1;t<31;t++)e[t]=t<<23;for(let t=33;t<63;t++)e[t]=2147483648+(t-32<<23);return e}(),n=function(){const e=new Uint32Array(64);for(let t=0;t<64;t++)e[t]=1024;return e[0]=e[32]=0,e}();return r=>{const a=new ArrayBuffer(4*r.length),s=new Uint32Array(a);for(let a=0;a<r.length;a++){const o=r[a],i=e[n[o>>10]+(1023&o)]+t[o>>10];s[a]=i}return new Float32Array(a)}}class Xn{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return null==Xn.instance&&(Xn.instance=new Xn),Xn.instance}static registerSaveRouter(e){Xn.getInstance().saveRouters.push(e)}static registerLoadRouter(e){Xn.getInstance().loadRouters.push(e)}static getSaveHandlers(e){return Xn.getHandlers(e,"save")}static getLoadHandlers(e,t){return Xn.getHandlers(e,"load",t)}static getHandlers(e,t,n){const r=[];return("load"===t?Xn.getInstance().loadRouters:Xn.getInstance().saveRouters).forEach((t=>{const a=t(e,n);null!==a&&r.push(a)})),r}}const Zn="tensorflowjs",Qn="models_store",er="model_info_store";function tr(){if(!ie().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const e="undefined"==typeof window?self:window,t=e.indexedDB||e.mozIndexedDB||e.webkitIndexedDB||e.msIndexedDB||e.shimIndexedDB;if(null==t)throw new Error("The current browser does not appear to support IndexedDB.");return t}function nr(e){const t=e.result;t.createObjectStore(Qn,{keyPath:"modelPath"}),t.createObjectStore(er,{keyPath:"modelPath"})}class rr{constructor(e){if(this.indexedDB=tr(),null==e||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,e)}async load(){return this.databaseAction(this.modelPath)}databaseAction(e,t){return new Promise(((e,n)=>{const r=this.indexedDB.open(Zn,1);r.onupgradeneeded=()=>nr(r),r.onsuccess=()=>{const a=r.result;if(null==t){const t=a.transaction(Qn,"readonly"),r=t.objectStore(Qn).get(this.modelPath);r.onsuccess=()=>{if(null==r.result)return a.close(),n(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));e(r.result.modelArtifacts)},r.onerror=e=>(a.close(),n(r.error)),t.oncomplete=()=>a.close()}else{const r=Jn(t),s=a.transaction(er,"readwrite");let o=s.objectStore(er);const i=o.put({modelPath:this.modelPath,modelArtifactsInfo:r});let u;i.onsuccess=()=>{u=a.transaction(Qn,"readwrite");const i=u.objectStore(Qn).put({modelPath:this.modelPath,modelArtifacts:t,modelArtifactsInfo:r});i.onsuccess=()=>e({modelArtifactsInfo:r}),i.onerror=e=>{o=s.objectStore(er);const t=o.delete(this.modelPath);t.onsuccess=()=>(a.close(),n(i.error)),t.onerror=e=>(a.close(),n(i.error))}},i.onerror=e=>(a.close(),n(i.error)),s.oncomplete=()=>{null==u?a.close():u.oncomplete=()=>a.close()}}},r.onerror=e=>n(r.error)}))}}rr.URL_SCHEME="indexeddb://";const ar=e=>{return ie().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(rr.URL_SCHEME)?(t=e.slice(rr.URL_SCHEME.length),new rr(t)):null;var t};Xn.registerSaveRouter(ar),Xn.registerLoadRouter(ar);class sr{constructor(){this.indexedDB=tr()}async listModels(){return new Promise(((e,t)=>{const n=this.indexedDB.open(Zn,1);n.onupgradeneeded=()=>nr(n),n.onsuccess=()=>{const r=n.result,a=r.transaction(er,"readonly"),s=a.objectStore(er).getAll();s.onsuccess=()=>{const t={};for(const e of s.result)t[e.modelPath]=e.modelArtifactsInfo;e(t)},s.onerror=e=>(r.close(),t(s.error)),a.oncomplete=()=>r.close()},n.onerror=e=>t(n.error)}))}async removeModel(e){var t;return e=(t=e).startsWith(rr.URL_SCHEME)?t.slice(rr.URL_SCHEME.length):t,new Promise(((t,n)=>{const r=this.indexedDB.open(Zn,1);r.onupgradeneeded=()=>nr(r),r.onsuccess=()=>{const a=r.result,s=a.transaction(er,"readwrite"),o=s.objectStore(er),i=o.get(e);let u;i.onsuccess=()=>{if(null==i.result)return a.close(),n(new Error(`Cannot find model with path '${e}' in IndexedDB.`));{const r=o.delete(e),s=()=>{u=a.transaction(Qn,"readwrite");const r=u.objectStore(Qn).delete(e);r.onsuccess=()=>t(i.result.modelArtifactsInfo),r.onerror=e=>n(i.error)};r.onsuccess=s,r.onerror=e=>(s(),a.close(),n(i.error))}},i.onerror=e=>(a.close(),n(i.error)),s.oncomplete=()=>{null==u?a.close():u.oncomplete=()=>a.close()}},r.onerror=e=>n(r.error)}))}}const or="/",ir="tensorflowjs_models",ur="info",cr="model_topology",lr="weight_specs",pr="weight_data",dr="model_metadata";function hr(e){return{info:[ir,e,ur].join(or),topology:[ir,e,cr].join(or),weightSpecs:[ir,e,lr].join(or),weightData:[ir,e,pr].join(or),modelMetadata:[ir,e,dr].join(or)}}function fr(e){for(const t of Object.values(e))window.localStorage.removeItem(t)}function mr(e){const t=e.split(or);if(t.length<3)throw new Error(`Invalid key format: ${e}`);return t.slice(1,t.length-1).join(or)}class yr{constructor(e){if(!ie().getBool("IS_BROWSER")||"undefined"==typeof window||void 0===window.localStorage)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,null==e||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=hr(this.modelPath)}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const t=JSON.stringify(e.modelTopology),n=JSON.stringify(e.weightSpecs),r=Jn(e);try{this.LS.setItem(this.keys.info,JSON.stringify(r)),this.LS.setItem(this.keys.topology,t),this.LS.setItem(this.keys.weightSpecs,n),this.LS.setItem(this.keys.weightData,function(e){if(Hn)return Buffer.from(e).toString("base64");const t=new Uint8Array(e);let n="";for(let e=0,r=t.length;e<r;e++)n+=String.fromCharCode(t[e]);return btoa(n)}(e.weightData));const a={format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,signature:null!=e.signature?e.signature:void 0,userDefinedMetadata:null!=e.userDefinedMetadata?e.userDefinedMetadata:void 0,modelInitializer:null!=e.modelInitializer?e.modelInitializer:void 0,trainingConfig:null!=e.trainingConfig?e.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(a)),{modelArtifactsInfo:r}}catch(e){throw fr(this.keys),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${r.modelTopologyBytes}, weightSpecsBytes=${r.weightSpecsBytes}, weightDataBytes=${r.weightDataBytes}.`)}}}async load(){const e=JSON.parse(this.LS.getItem(this.keys.info));if(null==e)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if("JSON"!==e.modelTopologyType)throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const t={},n=JSON.parse(this.LS.getItem(this.keys.topology));if(null==n)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);t.modelTopology=n;const r=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(null==r)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);t.weightSpecs=r;const a=this.LS.getItem(this.keys.modelMetadata);if(null!=a){const e=JSON.parse(a);t.format=e.format,t.generatedBy=e.generatedBy,t.convertedBy=e.convertedBy,null!=e.signature&&(t.signature=e.signature),null!=e.userDefinedMetadata&&(t.userDefinedMetadata=e.userDefinedMetadata),null!=e.modelInitializer&&(t.modelInitializer=e.modelInitializer),null!=e.trainingConfig&&(t.trainingConfig=e.trainingConfig)}const s=this.LS.getItem(this.keys.weightData);if(null==s)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return t.weightData=function(e){if(Hn){const t=Buffer.from(e,"base64");return t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength)}const t=atob(e),n=new Uint8Array(t.length);for(let e=0;e<t.length;++e)n.set([t.charCodeAt(e)],e);return n.buffer}(s),t}}yr.URL_SCHEME="localstorage://";const gr=e=>{return ie().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(yr.URL_SCHEME)?(t=e.slice(yr.URL_SCHEME.length),new yr(t)):null;var t};Xn.registerSaveRouter(gr),Xn.registerLoadRouter(gr);class br{constructor(){$(ie().getBool("IS_BROWSER"),(()=>"Current environment is not a web browser")),$("undefined"==typeof window||void 0!==window.localStorage,(()=>"Current browser does not appear to support localStorage")),this.LS=window.localStorage}async listModels(){const e={},t=ir+or,n=or+ur;for(let r=0;r<this.LS.length;++r){const a=this.LS.key(r);a.startsWith(t)&&a.endsWith(n)&&(e[mr(a)]=JSON.parse(this.LS.getItem(a)))}return e}async removeModel(e){var t;const n=hr(e=(t=e).startsWith(yr.URL_SCHEME)?t.slice(yr.URL_SCHEME.length):t);if(null==this.LS.getItem(n.info))throw new Error(`Cannot find model at path '${e}'`);const r=JSON.parse(this.LS.getItem(n.info));return fr(n),r}}class wr{constructor(){this.managers={}}static getInstance(){return null==wr.instance&&(wr.instance=new wr),wr.instance}static registerManager(e,t){$(null!=e,(()=>"scheme must not be undefined or null.")),e.endsWith("://")&&(e=e.slice(0,e.indexOf("://"))),$(e.length>0,(()=>"scheme must not be an empty string."));const n=wr.getInstance();$(null==n.managers[e],(()=>`A model store manager is already registered for scheme '${e}'.`)),n.managers[e]=t}static getManager(e){const t=this.getInstance().managers[e];if(null==t)throw new Error(`Cannot find model manager for scheme '${e}'`);return t}static getSchemes(){return Object.keys(this.getInstance().managers)}}class vr{fetch(e,t){return fetch(e,t)}now(){return performance.now()}encode(e,t){if("utf-8"!==t&&"utf8"!==t)throw new Error(`Browser's encoder only supports utf-8, but got ${t}`);return null==this.textEncoder&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}decode(e,t){return new TextDecoder(t).decode(e)}}if(ie().get("IS_BROWSER")){ie().setPlatform("browser",new vr);try{wr.registerManager(yr.URL_SCHEME,new br)}catch(e){}try{wr.registerManager(rr.URL_SCHEME,new sr)}catch(e){}}let xr;function kr(e,t="float32",n){return t=t||"float32",ne(e),new hn(e,t,n)}ie().get("IS_NODE")&&ie().setPlatform("node",new class{constructor(){this.util=n(8628),this.textEncoder=new this.util.TextEncoder}fetch(e,t){return null!=ie().global.fetch?ie().global.fetch(e,t):(null==xr&&(xr=n(5410)),xr(e,t))}now(){const e=process.hrtime();return 1e3*e[0]+e[1]/1e6}encode(e,t){if("utf-8"!==t&&"utf8"!==t)throw new Error(`Node built-in encoder only supports utf-8, but got ${t}`);return this.textEncoder.encode(e)}decode(e,t){return 0===e.length?"":new this.util.TextDecoder(t).decode(e)}});const _r=Ln({cast_:function(e,t){const n=jn(e,"x","cast");if(!function(e){return"bool"===e||"complex64"===e||"float32"===e||"int32"===e||"string"===e}(t))throw new Error(`Failed to cast to unknown dtype ${t}`);if("string"===t&&"string"!==n.dtype||"string"!==t&&"string"===n.dtype)throw new Error("Only strings can be casted to strings");const r={x:n},a={dtype:t};return Cn.runKernel(ve,r,a)}}),Sr=Ln({clone_:function(e){const t={x:jn(e,"x","clone","string_or_numeric")};return Cn.runKernel(Ve,t)}});function Nr(e){return new Promise((e=>setTimeout(e))).then(e)}Mn(),mn={buffer:kr,cast:_r,clone:Sr,print:function(e,t=!1){console.log(e.toString(t))}};class Tr{constructor(e){if(!ie().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");e.startsWith(Tr.URL_SCHEME)&&(e=e.slice(Tr.URL_SCHEME.length)),null!=e&&0!==e.length||(e="model"),this.modelJsonFileName=e+".json",this.weightDataFileName=e+".weights.bin"}async save(e){if("undefined"==typeof document)throw new Error("Browser downloads are not supported in this environment since `document` is not present");const t=window.URL.createObjectURL(new Blob([e.weightData],{type:"application/octet-stream"}));if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{const n=Gn(e,[{paths:["./"+this.weightDataFileName],weights:e.weightSpecs}]),r=window.URL.createObjectURL(new Blob([JSON.stringify(n)],{type:"application/json"})),a=null==this.modelJsonAnchor?document.createElement("a"):this.modelJsonAnchor;if(a.download=this.modelJsonFileName,a.href=r,await Nr((()=>a.dispatchEvent(new MouseEvent("click")))),null!=e.weightData){const e=null==this.weightDataAnchor?document.createElement("a"):this.weightDataAnchor;e.download=this.weightDataFileName,e.href=t,await Nr((()=>e.dispatchEvent(new MouseEvent("click"))))}return{modelArtifactsInfo:Jn(e)}}}}function Er(e,t,n,r){!function(e){$(null!=e&&Array.isArray(e)&&e.length>0,(()=>"promises must be a none empty array"))}(e),function(e,t){$(e>=0&&e<=1,(()=>`Progress fraction must be in range [0, 1], but got startFraction ${e}`)),$(t>=0&&t<=1,(()=>`Progress fraction must be in range [0, 1], but got endFraction ${t}`)),$(t>=e,(()=>`startFraction must be no more than endFraction, but got startFraction ${e} and endFraction ${t}`))}(n=null==n?0:n,r=null==r?1:r);let a=0;return Promise.all(e.map((s=>(s.then((s=>{const o=n+ ++a/e.length*(r-n);return t(o),s})),s))))}async function Ir(e,t){null==t&&(t={});const n=null==t.fetchFunc?ie().platform.fetch:t.fetchFunc,r=e.map((e=>n(e,t.requestInit,{isBinary:!0}))),a=(null==t.onProgress?await Promise.all(r):await Er(r,t.onProgress,0,.5)).map((e=>e.arrayBuffer()));return null==t.onProgress?await Promise.all(a):await Er(a,t.onProgress,.5,1)}Tr.URL_SCHEME="downloads://",Xn.registerSaveRouter((e=>ie().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(Tr.URL_SCHEME)?function(e="model"){return new Tr(e)}(e.slice(Tr.URL_SCHEME.length)):null));class Or{constructor(e,t){if(this.DEFAULT_METHOD="POST",null==t&&(t={}),this.weightPathPrefix=t.weightPathPrefix,this.onProgress=t.onProgress,this.weightUrlConverter=t.weightUrlConverter,null!=t.fetchFunc?($("function"==typeof t.fetchFunc,(()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)")),this.fetch=t.fetchFunc):this.fetch=ie().platform.fetch,$(null!=e&&e.length>0,(()=>"URL path for http must not be null, undefined or empty.")),Array.isArray(e)&&$(2===e.length,(()=>`URL paths for http must have a length of 2, (actual length is ${e.length}).`)),this.path=e,null!=t.requestInit&&null!=t.requestInit.body)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=t.requestInit||{}}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");const t=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);t.body=new FormData;const n=Gn(e,[{paths:["./model.weights.bin"],weights:e.weightSpecs}]);t.body.append("model.json",new Blob([JSON.stringify(n)],{type:"application/json"}),"model.json"),null!=e.weightData&&t.body.append("model.weights.bin",new Blob([e.weightData],{type:"application/octet-stream"}),"model.weights.bin");const r=await this.fetch(this.path,t);if(r.ok)return{modelArtifactsInfo:Jn(e),responses:[r]};throw new Error(`BrowserHTTPRequest.save() failed due to HTTP response status ${r.status}.`)}async load(){const e=await this.fetch(this.path,this.requestInit);if(!e.ok)throw new Error(`Request to ${this.path} failed with status code ${e.status}. Please verify this URL points to the model JSON of the model to load.`);let t;try{t=await e.json()}catch(e){let t=`Failed to parse model JSON of response from ${this.path}.`;throw this.path.endsWith(".pb")?t+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":t+=" Please make sure the server is serving valid JSON for this request.",new Error(t)}const n=t.modelTopology,r=t.weightsManifest;if(null==n&&null==r)throw new Error(`The JSON from HTTP path ${this.path} contains neither model topology or manifest for weights.`);return async function(e,t){const n={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy};if(null!=e.trainingConfig&&(n.trainingConfig=e.trainingConfig),null!=e.weightsManifest){const[r,a]=await t(e.weightsManifest);n.weightSpecs=r,n.weightData=a}return null!=e.signature&&(n.signature=e.signature),null!=e.userDefinedMetadata&&(n.userDefinedMetadata=e.userDefinedMetadata),null!=e.modelInitializer&&(n.modelInitializer=e.modelInitializer),n}(t,(e=>this.loadWeights(e)))}async loadWeights(e){const t=Array.isArray(this.path)?this.path[1]:this.path,[n,r]=function(e){const t=e.lastIndexOf("/"),n=e.lastIndexOf("?");return[e.substring(0,t)+"/",n>t?e.substring(n):""]}(t),a=this.weightPathPrefix||n,s=[];for(const t of e)s.push(...t.weights);const o=[],i=[];for(const t of e)for(const e of t.paths)null!=this.weightUrlConverter?i.push(this.weightUrlConverter(e)):o.push(a+e+r);return this.weightUrlConverter&&o.push(...await Promise.all(i)),[s,Kn(await Ir(o,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress}))]}}function Ar(e){return null!=e.match(Or.URL_SCHEME_REGEX)}Or.URL_SCHEME_REGEX=/^https?:\/\//;const Mr=(e,t)=>{if("undefined"==typeof fetch&&(null==t||null==t.fetchFunc))return null;{let n=!0;if(n=Array.isArray(e)?e.every((e=>Ar(e))):Ar(e),n)return Cr(e,t)}return null};function Cr(e,t){return new Or(e,t)}function Rr(e,t){return Cr(e,t)}let Dr;Xn.registerSaveRouter(Mr),Xn.registerLoadRouter(Mr);const Fr=Ln({fromPixels_:function(e,t=3){if(t>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(null==e)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");let n=!1,r=!1,a=!1,s=!1,o=!1,i=!1;if(e.data instanceof Uint8Array)n=!0;else if("undefined"!=typeof ImageData&&e instanceof ImageData)r=!0;else if("undefined"!=typeof HTMLVideoElement&&e instanceof HTMLVideoElement)a=!0;else if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement)s=!0;else if(null!=e.getContext)o=!0;else{if(!("undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap))throw new Error(`pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was ${e.constructor.name}`);i=!0}if(a){const t=2;if(a&&e.readyState<t)throw new Error("The video element has not loaded data yet. Please wait for `loadeddata` event on the <video> element.")}if(null!=Ut(Bt,Cn.backendName)){const n={pixels:e},r={numChannels:t};return Cn.runKernel(Bt,n,r)}const[u,c]=a?[e.videoWidth,e.videoHeight]:[e.width,e.height];let l,p;if(o?l=e.getContext("2d").getImageData(0,0,u,c).data:r||n?l=e.data:(s||a||i)&&(null==Dr&&(Dr=document.createElement("canvas").getContext("2d")),Dr.canvas.width=u,Dr.canvas.height=c,Dr.drawImage(e,0,0,u,c),l=Dr.getImageData(0,0,u,c).data),4===t)p=new Int32Array(l);else{const e=u*c;p=new Int32Array(e*t);for(let n=0;n<e;n++)for(let e=0;e<t;++e)p[n*t+e]=l[4*n+e]}return function(e,t,n){if(j(e),null!=t&&3!==t.length)throw new Error("tensor3d() requires shape to have three numbers");const r=Fn(e,n);if(3!==r.length&&1!==r.length)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return zn(e,t,r,n)}(p,[c,u,t],"int32")}});function $r(e){const t=[];let n=0;for(;e>0;)1&e&&t.push(n),e/=2,n++;return t}function Pr(e,t,n){return n<=e?n:n-(t-1)}function jr(e,t){const n=[];for(let r=0;r<e;r++)n.push(t+r);return n}function Br(e,t,n){let r=e[t];return(n&1<<t||null==r)&&(r=1),r}function Lr(e,t,n,r,a,s){let o=t[a];const i=n[a]||1;(e&1<<a||s&1<<a||null==o)&&(o=i>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);const u=r[a];return o<0&&(o+=u),o=F(0,o,u-1),o}function qr(e,t,n,r,a,s){let o=t[a];const i=n[a]||1;(e&1<<a||s&1<<a||null==o)&&(o=i>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);const u=r[a];return o<0&&(o+=u),o=i>0?F(0,o,u):F(-1,o,u-1),o}function zr(e,t,n){let r=n.length;for(let e=0;e<n.length;e++)if(n[e]>1){r=e;break}for(let a=r+1;a<n.length;a++)if(t[a]>0||n[a]!==e[a])return!1;return!0}function Vr(e,t){let n=e.length>0?e[e.length-1]:1;for(let r=0;r<e.length-1;r++)n+=e[r]*t[r];return n}const Wr=Ln({add_:function(e,t){let n=jn(e,"a","add"),r=jn(t,"b","add");[n,r]=Nn(n,r);const a={a:n,b:r};return Cn.runKernel(de,a)}}),Hr=Ln({concat_:function(e,t=0){$(e.length>=1,(()=>"Pass at least one tensor to concat"));const n=Bn(e,"tensors","concat","string_or_numeric");if("complex64"===n[0].dtype&&n.forEach((e=>{if("complex64"!==e.dtype)throw new Error(`Cannot concatenate complex64 tensors with a tensor\n          with dtype ${e.dtype}. `)})),1===n.length)return Sr(n[0]);const r=n,a={axis:t};return Cn.runKernel(_e,r,a)}}),Ur=Ln({concat2d_:function(e,t){return Hr(e,t)}}),Kr=Ln({floorDiv_:function(e,t){let n=jn(e,"a","floorDiv"),r=jn(t,"b","floorDiv");[n,r]=Nn(n,r);const a={a:n,b:r};return Cn.runKernel(Pe,a)}}),Gr=Ln({div_:function(e,t){let n=jn(e,"a","div"),r=jn(t,"b","div");if([n,r]=Nn(n,r),"int32"===n.dtype&&"int32"===r.dtype)return Kr(n,r);const a={a:n,b:r};return Cn.runKernel(Me,a,{})}}),Jr=Ln({expandDims_:function(e,t=0){const n=jn(e,"x","expandDims","string_or_numeric");$(t<=n.rank,(()=>"Axis must be <= rank of the tensor"));const r={input:n},a={dim:t};return Cn.runKernel(Re,r,a)}}),Yr=Ln({mul_:function(e,t){let n=jn(e,"a","mul"),r=jn(t,"b","mul");[n,r]=Nn(n,r);const a={a:n,b:r};return Cn.runKernel(tt,a)}}),Xr=Ln({reshape_:function(e,t){const n={x:jn(e,"x","reshape","string_or_numeric")},r={shape:t};return Cn.runKernel(ft,n,r)}});function Zr(e,t){if((U(e)&&"string"!==t||Array.isArray(e))&&"complex64"!==t)throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if("string"===t&&U(e)&&!(e instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return zn(e,[],[],t)}const Qr=Ln({sigmoid_:function(e){const t={x:jn(e,"x","sigmoid")};return Cn.runKernel(_t,t)}}),ea=Ln({slice_:function(e,t,n){const r=jn(e,"x","slice","string_or_numeric");if(0===r.rank)throw new Error("Slicing scalar is not possible");const a={x:r},s={begin:t,size:n};return Cn.runKernel(kt,a,s)}}),ta=Ln({squeeze_:function(e,t){const n=jn(e,"x","squeeze");return Xr(n,function(e,t){const n=[],r=[],a=null!=t&&Array.isArray(t)&&0===t.length,s=null==t||a?null:W(t,e).sort();let o=0;for(let t=0;t<e.length;++t){if(null!=s){if(s[o]===t&&1!==e[t])throw new Error(`Can't squeeze axis ${t} since its dim '${e[t]}' is not 1`);(null==s[o]||s[o]>t)&&1===e[t]&&(n.push(e[t]),r.push(t)),s[o]<=t&&o++}1!==e[t]&&(n.push(e[t]),r.push(t))}return{newShape:n,keptDims:r}}(n.shape,t).newShape)}}),na=Ln({stack_:function(e,t=0){const n=Bn(e,"tensors","stack","string_or_numeric");$(n.length>=1,(()=>"Pass at least one tensor to tf.stack")),n.length>0&&$(t<=n[0].rank,(()=>"Axis must be <= rank of the tensor"));const r=n,a={axis:t};return Cn.runKernel(ut,r,a)}}),ra=Ln({sub_:function(e,t){let n=jn(e,"a","sub"),r=jn(t,"b","sub");[n,r]=Nn(n,r);const a={a:n,b:r};return Cn.runKernel("Sub",a)}});function aa(e,t){j(e);const n=Fn(e,t);if(1!==n.length)throw new Error("tensor1d() requires values to be a flat/TypedArray");return zn(e,null,n,t)}function sa(e,t,n){if(j(e),null!=t&&2!==t.length)throw new Error("tensor2d() requires shape to have two numbers");const r=Fn(e,n);if(2!==r.length&&1!==r.length)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return zn(e,t,r,n)}const oa=Ln({unstack_:function(e,t=0){const n=jn(e,"x","unstack","string_or_numeric");$(t>=-n.shape.length&&t<n.shape.length,(()=>`Axis = ${t} is not in [-${n.shape.length}, ${n.shape.length})`));const r={value:n},a={axis:t};return Cn.runKernel($t,r,a)}}),ia=Ln({imag_:function(e){const t={input:jn(e,"input","imag")};return Cn.runKernel("Imag",t)}}),ua=Ln({real_:function(e){const t={input:jn(e,"input","real")};return Cn.runKernel("Real",t)}}),ca=Ln({split_:function(e,t,n=0){const r={x:jn(e,"x","split")},a={numOrSizeSplits:t,axis:n};return Cn.runKernel(Et,r,a)}});function la(e,t="float32"){if("complex64"===t){const t=la(e,"float32"),n=la(e,"float32");return qn(t,n)}const n=te(L(e),t);return Cn.makeTensor(n,e,t)}const pa=Ln({zerosLike_:function(e){const t={x:jn(e,"x","zerosLike")};return Cn.runKernel(Pt,t)}}),da=Ln({fft_:function(e){$("complex64"===e.dtype,(()=>`The dtype for tf.spectral.fft() must be complex64 but got ${e.dtype}.`));const t={input:e};return Cn.runKernel("FFT",t)}}),ha=Ln({rfft_:function(e,t){$("float32"===e.dtype,(()=>`The dtype for rfft() must be real value but got ${e.dtype}`));let n=e.shape[e.shape.length-1];const r=e.size/n;let a;if(null!=t&&t<n){const r=e.shape.map((e=>0)),s=e.shape.map((e=>e));s[e.shape.length-1]=t,a=ea(e,r,s),n=t}else if(null!=t&&t>n){const r=e.shape.map((e=>e));r[e.shape.length-1]=t-n,a=Hr([e,la(r)],e.shape.length-1),n=t}else a=e;const s=pa(a),o=Xr(qn(a,s),[r,n]),i=da(o),u=Math.floor(n/2)+1,c=ua(i),l=ia(i),p=ca(c,[u,n-u],c.shape.length-1),d=ca(l,[u,n-u],l.shape.length-1),h=a.shape.slice();return h[a.shape.length-1]=u,Xr(qn(p[0],d[0]),h)}}),fa=Ln({ifft_:function(e){$("complex64"===e.dtype,(()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${e.dtype}.`));const t={input:e};return Cn.runKernel("IFFT",t)}}),ma=Ln({reverse_:function(e,t){const n={x:jn(e,"x","reverse")},r={dims:t};return Cn.runKernel(gt,n,r)}}),ya=Ln({irfft_:function(e){const t=e.shape[e.shape.length-1],n=e.size/t;let r;if(t<=2){const a=Xr(e,[n,t]);r=fa(a)}else{const a=[n,2*(t-1)],s=Xr(ua(e),[n,t]),o=Xr(ia(e),[n,t]),i=ma(ea(s,[0,1],[n,t-2]),1),u=Yr(ma(ea(o,[0,1],[n,t-2]),1),Zr(-1)),c=Hr([s,i],1),l=Hr([o,u],1),p=Xr(qn(c,l),[a[0],a[1]]);r=fa(p)}if(r=ua(r),3===e.rank&&0!==e.shape[0]){const t=r,n=e.shape[0];r=Xr(r,[n,r.shape[0]/n,r.shape[1]]),t.dispose()}return r}});function ga(e,t,n){const r=1-e%2,a=new Float32Array(e);for(let s=0;s<e;++s){const o=2*Math.PI*s/(e+r-1);a[s]=t-n*Math.cos(o)}return aa(a,"float32")}Ln({hammingWindow_:function(e){return ga(e,.54,.46)}});const ba=Ln({hannWindow_:function(e){return ga(e,.5,.5)}});function wa(e,t,n){const r={shape:e,value:t,dtype:n};return Cn.runKernel(De,{},r)}const va=Ln({frame_:function(e,t,n,r=!1,a=0){let s=0;const o=[];for(;s+t<=e.size;)o.push(ea(e,s,t)),s+=n;if(r)for(;s<e.size;){const r=s+t-e.size,i=Hr([ea(e,s,t-r),wa([r],a)]);o.push(i),s+=n}return 0===o.length?sa([],[0,t]):Xr(Hr(o),[o.length,t])}});Ln({stft_:function(e,t,n,r,a=ba){var s;null==r&&(s=t,r=Math.floor(Math.pow(2,Math.ceil(Math.log(s)/Math.log(2)))));const o=va(e,t,n),i=Yr(o,a(t));return ha(i,r)}});const xa=Ln({cropAndResize_:function(e,t,n,r,a="bilinear",s=0){const o=jn(e,"image","cropAndResize"),i=jn(t,"boxes","cropAndResize","float32"),u=jn(n,"boxInd","cropAndResize","int32"),c=i.shape[0];$(4===o.rank,(()=>`Error in cropAndResize: image must be rank 4,but got rank ${o.rank}.`)),$(2===i.rank&&4===i.shape[1],(()=>`Error in cropAndResize: boxes must be have size [${c},4] but had shape ${i.shape}.`)),$(1===u.rank&&u.shape[0]===c,(()=>`Error in cropAndResize: boxInd must be have size [${c}] but had shape ${i.shape}.`)),$(2===r.length,(()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${r.length}.`)),$(r[0]>=1&&r[1]>=1,(()=>`cropSize must be atleast [1,1], but was ${r}`)),$("bilinear"===a||"nearest"===a,(()=>`method must be bilinear or nearest, but was ${a}`));const l={image:o,boxes:i,boxInd:u},p={method:a,extrapolationValue:s,cropSize:r};return Cn.runKernel(Ie,l,p)}}),ka=Ln({flipLeftRight_:function(e){const t=jn(e,"image","flipLeftRight","float32");$(4===t.rank,(()=>`Error in flipLeftRight: image must be rank 4,but got rank ${t.rank}.`));const n={image:t};return Cn.runKernel(Fe,n,{})}}),_a=Ln({tile_:function(e,t){const n=jn(e,"x","tile","string_or_numeric");$(n.rank===t.length,(()=>`Error in transpose: rank of input ${n.rank} must match length of reps ${t}.`));const r={x:n},a={reps:t};return Cn.runKernel(Ct,r,a)}}),Sa=Ln({grayscaleToRGB_:function(e){const t=jn(e,"image","grayscaleToRGB"),n=t.rank-1,r=t.shape[n];$(t.rank>=2,(()=>`Error in grayscaleToRGB: images must be at least rank 2, but got rank ${t.rank}.`)),$(1===r,(()=>`Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ${r}.`));const a=new Array(t.rank);return a.fill(1,0,n),a[n]=3,_a(t,a)}}),Na=Ln({rotateWithOffset_:function(e,t,n=0,r=.5){const a=jn(e,"image","rotateWithOffset","float32");$(4===a.rank,(()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${a.rank}.`));const s={image:a},o={radians:t,fillValue:n,center:r};return Cn.runKernel(Lt,s,o)}});function Ta(e,t,n,r,a,s){null==r&&(r=.5),null==a&&(a=Number.NEGATIVE_INFINITY),null==s&&(s=0);const o=e.shape[0];return n=Math.min(n,o),$(0<=r&&r<=1,(()=>`iouThreshold must be in [0, 1], but was '${r}'`)),$(2===e.rank,(()=>`boxes must be a 2D tensor, but was of rank '${e.rank}'`)),$(4===e.shape[1],(()=>`boxes must have 4 columns, but 2nd dimension was ${e.shape[1]}`)),$(1===t.rank,(()=>"scores must be a 1D tensor")),$(t.shape[0]===o,(()=>`scores has incompatible shape with boxes. Expected ${o}, but was ${t.shape[0]}`)),$(0<=s&&s<=1,(()=>`softNmsSigma must be in [0, 1], but was '${s}'`)),{maxOutputSize:n,iouThreshold:r,scoreThreshold:a,softNmsSigma:s}}const Ea=Ln({nonMaxSuppression_:function(e,t,n,r=.5,a=Number.NEGATIVE_INFINITY){const s=jn(e,"boxes","nonMaxSuppression"),o=jn(t,"scores","nonMaxSuppression"),i=Ta(s,o,n,r,a),u={maxOutputSize:n=i.maxOutputSize,iouThreshold:r=i.iouThreshold,scoreThreshold:a=i.scoreThreshold};return Cn.runKernel(rt,{boxes:s,scores:o},u)}});function Ia(e,t,n){const r=function(e,t,n){return function(e,t,n){let r=0,a=e.length,s=0,o=!1;for(;r<a;){s=r+(a-r>>>1);const i=n(t,e[s]);i>0?r=s+1:(a=s,o=!i)}return o?r:-r-1}(e,t,n||Oa)}(e,t,n),a=r<0?-(r+1):r;e.splice(a,0,t)}function Oa(e,t){return e>t?1:e<t?-1:0}function Aa(e,t,n,r,a,s,o=!1,i=!1,u=!1){const c=[];for(let e=0;e<t.length;e++)t[e]>a&&c.push({score:t[e],boxIndex:e,suppressBeginIndex:0});c.sort(Ra);const l=s>0?-.5/s:0,p=[],d=[];for(;p.length<n&&c.length>0;){const t=c.pop(),{score:n,boxIndex:s,suppressBeginIndex:o}=t;if(n<a)break;let i=!1;for(let n=p.length-1;n>=o;--n){const o=Ma(e,s,p[n]);if(o>=r){i=!0;break}if(t.score=t.score*Ca(r,l,o),t.score<=a)break}t.suppressBeginIndex=p.length,i||(t.score===n?(p.push(s),d.push(t.score)):t.score>a&&Ia(c,t,Ra))}const h=p.length,f=n-h;i&&f>0&&(p.push(...new Array(f).fill(0)),d.push(...new Array(f).fill(0)));const m={selectedIndices:p};return o&&(m.selectedScores=d),u&&(m.validOutputs=h),m}function Ma(e,t,n){const r=e.subarray(4*t,4*t+4),a=e.subarray(4*n,4*n+4),s=Math.min(r[0],r[2]),o=Math.min(r[1],r[3]),i=Math.max(r[0],r[2]),u=Math.max(r[1],r[3]),c=Math.min(a[0],a[2]),l=Math.min(a[1],a[3]),p=Math.max(a[0],a[2]),d=Math.max(a[1],a[3]),h=(i-s)*(u-o),f=(p-c)*(d-l);if(h<=0||f<=0)return 0;const m=Math.max(s,c),y=Math.max(o,l),g=Math.min(i,p),b=Math.min(u,d),w=Math.max(g-m,0)*Math.max(b-y,0);return w/(h+f-w)}function Ca(e,t,n){const r=Math.exp(t*n*n);return n<=e?r:0}function Ra(e,t){return e.score-t.score||e.score===t.score&&t.boxIndex-e.boxIndex}const Da=Ln({nonMaxSuppressionWithScore_:function(e,t,n,r=.5,a=Number.NEGATIVE_INFINITY,s=0){const o=jn(e,"boxes","nonMaxSuppression"),i=jn(t,"scores","nonMaxSuppression"),u=Ta(o,i,n,r,a,s),c={boxes:o,scores:i},l={maxOutputSize:n=u.maxOutputSize,iouThreshold:r=u.iouThreshold,scoreThreshold:a=u.scoreThreshold,softNmsSigma:s=u.softNmsSigma},p=Cn.runKernel(st,c,l);return{selectedIndices:p[0],selectedScores:p[1]}}}),Fa=Ln({nonMaxSuppressionPadded_:function(e,t,n,r=.5,a=Number.NEGATIVE_INFINITY,s=!1){const o=jn(e,"boxes","nonMaxSuppression"),i=jn(t,"scores","nonMaxSuppression"),u=Ta(o,i,n,r,a,null),c={boxes:o,scores:i},l={maxOutputSize:u.maxOutputSize,iouThreshold:u.iouThreshold,scoreThreshold:u.scoreThreshold,padToMaxOutputSize:s},p=Cn.runKernel(at,c,l);return{selectedIndices:p[0],validOutputs:p[1]}}}),$a=Ln({resizeBilinear_:function(e,t,n=!1,r=!1){const a=jn(e,"images","resizeBilinear");$(3===a.rank||4===a.rank,(()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${a.rank}.`)),$(2===t.length,(()=>`Error in resizeBilinear: new shape must 2D, but got shape ${t}.`)),$(!1===r||!1===n,(()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false."));let s=a,o=!1;3===a.rank&&(o=!0,s=Xr(a,[1,a.shape[0],a.shape[1],a.shape[2]]));const[]=t,i={images:s},u={alignCorners:n,halfPixelCenters:r,size:t},c=Cn.runKernel(mt,i,u);return o?Xr(c,[c.shape[1],c.shape[2],c.shape[3]]):c}}),Pa=Ln({resizeNearestNeighbor_:function(e,t,n=!1,r=!1){const a=jn(e,"images","resizeNearestNeighbor");$(3===a.rank||4===a.rank,(()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${a.rank}.`)),$(2===t.length,(()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${t}.`)),$("float32"===a.dtype||"int32"===a.dtype,(()=>"`images` must have `int32` or `float32` as dtype")),$(!1===r||!1===n,(()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false."));let s=a,o=!1;3===a.rank&&(o=!0,s=Xr(a,[1,a.shape[0],a.shape[1],a.shape[2]]));const[]=t,i={images:s},u={alignCorners:n,halfPixelCenters:r,size:t},c=Cn.runKernel("ResizeNearestNeighbor",i,u);return o?Xr(c,[c.shape[1],c.shape[2],c.shape[3]]):c}}),ja=Ln({bincount_:function(e,t,n){const r=jn(e,"x","bincount"),a=jn(t,"weights","bincount");$("int32"===r.dtype,(()=>`Error in bincount: input dtype must be int32, but got ${r.dtype}`)),$(n>=0,(()=>`size must be non-negative, but got ${n}.`)),$(a.size===r.size||0===a.size,(()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${r.shape}, weights shape: ${a.shape}.`));const s={x:r,weights:a},o={size:n};return Cn.runKernel("Bincount",s,o)}});function Ba(e,t){const n=e.length,r=[];for(let a=0;a<n;a++){const s=n-1-a,o=e[s]||1;(t[t.length-1-a]||1)>1&&1===o&&r.unshift(s)}return r}function La(e,t){const n=[],r=Math.max(e.length,t.length);for(let a=0;a<r;a++){let r=e[e.length-a-1];null==r&&(r=1);let s=t[t.length-a-1];if(null==s&&(s=1),1===r)n.unshift(s);else if(1===s)n.unshift(r);else{if(r!==s)throw Error(`Operands could not be broadcast together with shapes ${e} and ${t}.`);n.unshift(r)}}return n}const qa=Ln({lessEqual_:function(e,t){let n=jn(e,"a","lessEqual","string_or_numeric"),r=jn(t,"b","lessEqual","string_or_numeric");[n,r]=Nn(n,r),La(n.shape,r.shape);const a={a:n,b:r};return Cn.runKernel(Ue,a)}}),za=Ln({greater_:function(e,t){let n=jn(e,"a","greater","string_or_numeric"),r=jn(t,"b","greater","string_or_numeric");[n,r]=Nn(n,r),La(n.shape,r.shape);const a={a:n,b:r};return Cn.runKernel(qe,a)}}),Va=Ln({sum_:function(e,t=null,n=!1){let r=jn(e,"x","sum");"bool"===r.dtype&&(r=_r(r,"int32"));const a={x:r},s={axis:t,keepDims:n};return Cn.runKernel(Nt,a,s)}}),Wa=Ln({round_:function(e){const t={x:jn(e,"x","round")};return Cn.runKernel(bt,t)}}),Ha=Ln({broadcastTo_:function(e,t){let n=jn(e,"broadcastTo","x");const r=n.shape;if(t.some((e=>!(e>0)||e%1!=0)))throw new Error(`broadcastTo(): Invalid broadcast shape [${t}].`);if(t.length<n.rank)throw new Error(`broadcastTo(): shape.length=${t.length} < input.rank=${n.rank}.`);if(t.length>n.rank){const e=n.shape.slice();for(;e.length<t.length;)e.unshift(1);n=Xr(n,e)}const a=n.shape,s=Array.from(t);for(let e=t.length-1;e>=0;e--)if(a[e]===t[e])s[e]=1;else if(1!==n.shape[e])throw new Error(`broadcastTo(): [${r}] cannot be broadcast to [${t}].`);if(0===s.map(((e,t)=>e>1?t:-1)).filter((e=>e>=0)).length)return Sr(n);const o={x:n},i={reps:s};return Cn.runKernel(Ct,o,i)}}),Ua=Ln({where_:function(e,t,n){const r=jn(t,"a","where"),a=jn(n,"b","where"),s=jn(e,"condition","where","bool"),o=La(La(s.shape,r.shape),a.shape),i={condition:Ha(s,o),t:Ha(r,o),e:Ha(a,o)};return Cn.runKernel(xt,i)}});function Ka(e,t,n=1,r="float32"){if(0===n)throw new Error("Cannot have a step of zero");const a={start:e,stop:t,step:n,dtype:r};return Cn.runKernel(dt,{},a)}const Ga=Ln({threshold_:function(e,t="binary",n=!1,r=.5){const a=jn(e,"image","threshold"),s=a.shape[0]*a.shape[1];let o,i,u,c,l=Yr(aa([r]),255);if($(3===a.rank,(()=>`Error in threshold: image must be rank 3,but got rank ${a.rank}.`)),$(3===a.shape[2]||1===a.shape[2],(()=>`Error in threshold: image color channel must be equal to 3 or 1but got ${a.shape[2]}.`)),$("int32"===a.dtype||"float32"===a.dtype,(()=>`Error in dtype: image dtype must be int32 or float32,but got dtype ${a.dtype}.`)),$("otsu"===t||"binary"===t,(()=>`Method must be binary or otsu, but was ${t}`)),3===a.shape[2]){[o,i,u]=ca(a,[1,1,1],-1);const e=Yr(o,.2989),t=Yr(i,.587),n=Yr(u,.114);c=Wr(Wr(e,t),n)}else c=e;"otsu"===t&&(l=function(e,t){let n,r,a,s,o,i,u=aa([-1]),c=aa([0]),l=aa([0]);for(let p=0;p<e.size-1;p++){n=ea(e,0,p+1),r=ea(e,p+1),o=Gr(Va(n),t),i=Gr(Va(r),t);const d=Va(Yr(n,Ka(0,n.size)));a=Gr(d,Va(n));const h=wa(r.shape,n.size),f=Wr(Ka(0,r.size),h),m=Yr(r,f);s=Gr(Va(m),Va(r));const y=ra(a,s),g=ra(a,s),b=Yr(o,i);l=Yr(Yr(b,y),g);const w=za(l,c);c=Ua(w,l,c),u=Ua(w,aa([p]),u)}return u}(ja(_r(Wa(c),"int32"),Vn([]),256),s));const p=n?qa(c,l):za(c,l);return _r(Yr(p,255),"int32")}}),Ja=Ln({transform_:function(e,t,n="nearest",r="constant",a=0,s){const o=jn(e,"image","transform","float32"),i=jn(t,"transforms","transform","float32");$(4===o.rank,(()=>`Error in transform: image must be rank 4,but got rank ${o.rank}.`)),$(2===i.rank&&(i.shape[0]===o.shape[0]||1===i.shape[0])&&8===i.shape[1],(()=>"Error in transform: Input transform should be batch x 8 or 1 x 8")),$(null==s||2===s.length,(()=>`Error in transform: outputShape must be [height, width] or null, but got ${s}.`));const u={image:o,transforms:i},c={interpolation:n,fillMode:r,fillValue:a,outputShape:s};return Cn.runKernel(Dt,u,c)}}),Ya=Ln({greaterEqual_:function(e,t){let n=jn(e,"a","greaterEqual","string_or_numeric"),r=jn(t,"b","greaterEqual","string_or_numeric");[n,r]=Nn(n,r),La(n.shape,r.shape);const a={a:n,b:r};return Cn.runKernel(ze,a)}}),Xa=Ln({logicalAnd_:function(e,t){const n=jn(e,"a","logicalAnd","bool"),r=jn(t,"b","logicalAnd","bool");La(n.shape,r.shape);const a={a:n,b:r};return Cn.runKernel(Ke,a)}});Ln({bandPart_:function(e,t,n){$(t%1==0,(()=>`bandPart(): numLower must be an integer, got ${t}.`)),$(n%1==0,(()=>`bandPart(): numUpper must be an integer, got ${n}.`));const r=jn(e,"a","bandPart");$(r.rank>=2,(()=>`bandPart(): Rank must be at least 2, got ${r.rank}.`));const a=r.shape,[s,o]=r.shape.slice(-2);if(!(t<=s))throw new Error(`bandPart(): numLower (${t}) must not be greater than the number of rows (${s}).`);if(!(n<=o))throw new Error(`bandPart(): numUpper (${n}) must not be greater than the number of columns (${o}).`);t<0&&(t=s),n<0&&(n=o);const i=Xr(Ka(0,s,1,"int32"),[-1,1]),u=Ka(0,o,1,"int32"),c=ra(i,u),l=Xa(qa(c,Zr(+t,"int32")),Ya(c,Zr(-n,"int32"))),p=la([s,o],r.dtype);return Xr(na(oa(Xr(r,[-1,s,o])).map((e=>Ua(l,e,p)))),a)}});const Za=Ln({abs_:function(e){const t=jn(e,"x","abs");if("complex64"===t.dtype){const e={x:t};return Cn.runKernel("ComplexAbs",e)}{const e={x:t};return Cn.runKernel("Abs",e)}}});function Qa(e,t){for(let n=0;n<e.length;++n)if(e[e.length-n-1]!==t-1-n)return!1;return!0}function es(e,t){const n=[],r=e.length;for(let a=0;a<r;a++)-1===t.indexOf(a)&&n.push(e[a]);return[n,t.map((t=>e[t]))]}function ts(e,t){return function(e,t,n){const r=e.length+t.length,a=[];let s=0,o=0;for(let i=0;i<r;i++)-1===n.indexOf(i)?a.push(e[s++]):a.push(t[o++]);return a}(e,t.map((e=>1)),t)}function ns(e,t,n){$(Qa(t,n),(()=>`${e} supports only inner-most axes for now. Got axes ${t} and rank-${n} input.`))}function rs(e,t){if(Qa(e,t))return null;const n=[];for(let r=0;r<t;++r)-1===e.indexOf(r)&&n.push(r);return e.forEach((e=>n.push(e))),n}function as(e,t){const n=[];for(let r=t-e;r<t;++r)n.push(r);return n}const ss=Ln({max_:function(e,t=null,n=!1){const r={x:jn(e,"x","max")},a={reductionIndices:t,keepDims:n};return Cn.runKernel(Ge,r,a)}}),os=Ln({min_:function(e,t=null,n=!1){const r={x:jn(e,"x","min")},a={axis:t,keepDims:n};return Cn.runKernel(Ze,r,a)}}),is=Ln({pow_:function(e,t){let n=jn(e,"base","pow"),r=jn(t,"exp","pow");[n,r]=Nn(n,r);const a={a:n,b:r};return Cn.runKernel("Pow",a)}}),us=Ln({sqrt_:function(e){const t={x:jn(e,"x","sqrt")};return Cn.runKernel(St,t)}}),cs=Ln({square_:function(e){const t=jn(e,"x","square");return Cn.runKernel("Square",{x:t},{})}});function ls(e,t,n=null){if(0===e.rank)return Za(e);if(1!==e.rank&&null===n)return ls(Xr(e,[-1]),t,n);if(1===e.rank||"number"==typeof n||Array.isArray(n)&&1===n.length){if(1===t)return Va(Za(e),n);if(t===1/0)return ss(Za(e),n);if(t===-1/0)return os(Za(e),n);if("euclidean"===t||2===t)return us(Va(is(Za(e),Zr(2,"int32")),n));throw new Error(`Error in norm: invalid ord value: ${t}`)}if(Array.isArray(n)&&2===n.length){if(1===t)return ss(Va(Za(e),n[0]),n[1]-1);if(t===1/0)return ss(Va(Za(e),n[1]),n[0]);if(t===-1/0)return os(Va(Za(e),n[1]),n[0]);if("fro"===t||"euclidean"===t)return us(Va(cs(e),n));throw new Error(`Error in norm: invalid ord value: ${t}`)}throw new Error(`Error in norm: invalid axis: ${n}`)}const ps=Ln({norm_:function(e,t="euclidean",n=null,r=!1){const a=ls(e=jn(e,"x","norm"),t,n);let s=a.shape;if(r){const t=W(n,e.shape);s=ts(a.shape,t)}return Xr(a,s)}});function ds(e,t){return Cn.tidy(e,t)}function hs(e){return Cn.keep(e)}Ln({gramSchmidt_:function(e){let t;if(Array.isArray(e)){t=!1,$(null!=e&&e.length>0,(()=>"Gram-Schmidt process: input must not be null, undefined, or empty"));const n=e[0].shape[0];for(let t=1;t<e.length;++t)$(e[t].shape[0]===n,(()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${e[t].shape[0]} vs. ${n})`))}else t=!0,e=ca(e,e.shape[0],0).map((e=>ta(e,[0])));$(e.length<=e[0].shape[0],(()=>`Gram-Schmidt: Number of vectors (${e.length}) exceeds number of dimensions (${e[0].shape[0]}).`));const n=[],r=e;for(let t=0;t<e.length;++t)n.push(Cn.tidy((()=>{let e=r[t];if(t>0)for(let r=0;r<t;++r){const t=Yr(Va(Yr(n[r],e)),n[r]);e=ra(e,t)}return Gr(e,ps(e,"euclidean"))})));return t?na(n,0):n}}),yn=function(e){ie().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(e+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")};const fs=Ln({eye_:function(e,t,n,r="float32"){null==t&&(t=e);const a=kr([e,t],r),s=e<=t?e:t;for(let e=0;e<s;++e)a.set(1,e,e);const o=Xr(a.toTensor(),[e,t]);if(null==n)return o;if(1===n.length)return _a(Jr(o,0),[n[0],1,1]);if(2===n.length)return _a(Jr(Jr(o,0),0),[n[0],n[1],1,1]);if(3===n.length)return _a(Jr(Jr(Jr(o,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${n.length}D.`)}}),ms=Ln({matMul_:function(e,t,n=!1,r=!1){let a=jn(e,"a","matMul"),s=jn(t,"b","matMul");[a,s]=Nn(a,s);const o={a:a,b:s},i={transposeA:n,transposeB:r};return Cn.runKernel(be,o,i)}}),ys=Ln({neg_:function(e){const t={x:jn(e,"x","neg")};return Cn.runKernel("Neg",t)}}),gs=Ln({transpose_:function(e,t){const n=jn(e,"x","transpose");if(null==t&&(t=n.shape.map(((e,t)=>t)).reverse()),$(n.rank===t.length,(()=>`Error in transpose: rank of input ${n.rank} must match length of perm ${t}.`)),t.forEach((e=>{$(e>=0&&e<n.rank,(()=>"All entries in 'perm' must be between 0 and "+(n.rank-1)+` but got ${t}`))})),n.rank<=1)return n.clone();const r={x:n},a={perm:t};return Cn.runKernel(Ft,r,a)}});function bs(e,t=!1){return Cn.tidy((()=>{$(2===e.shape.length,(()=>`qr2d() requires a 2D Tensor, but got a ${e.shape.length}D Tensor.`));const n=e.shape[0],r=e.shape[1];let a=fs(n),s=Sr(e);const o=sa([[1]],[1,1]);let i=Sr(o);const u=n>=r?r:n;for(let e=0;e<u;++e){const t=s,u=i,c=a;[i,s,a]=Cn.tidy((()=>{const t=ea(s,[e,e],[n-e,1]),u=ps(t),c=ea(s,[e,e],[1,1]),l=Ua(za(c,0),sa([[-1]]),sa([[1]])),p=ra(c,Yr(l,u)),d=Gr(t,p);i=1===d.shape[0]?Sr(o):Hr([o,ea(d,[1,0],[d.shape[0]-1,d.shape[1]])],0);const h=ys(Gr(ms(l,p),u)),f=ea(s,[e,0],[n-e,r]),m=Yr(h,i),y=gs(i);if(0===e)s=ra(f,ms(m,ms(y,f)));else{const t=ra(f,ms(m,ms(y,f)));s=Hr([ea(s,[0,0],[e,r]),t],0)}const g=gs(m),b=ea(a,[0,e],[n,a.shape[1]-e]);if(0===e)a=ra(b,ms(ms(b,i),g));else{const t=ra(b,ms(ms(b,i),g));a=Hr([ea(a,[0,0],[n,e]),t],1)}return[i,s,a]})),Tn([t,u,c]).forEach((e=>e.dispose()))}return!t&&n>r&&(a=ea(a,[0,0],[n,r]),s=ea(s,[0,0],[r,r])),[a,s]}))}var ws;Ln({qr_:function(e,t=!1){if($(e.rank>=2,(()=>`qr() requires input tensor to have a rank >= 2, but got rank ${e.rank}`)),2===e.rank)return bs(e,t);{const n=e.shape.slice(0,e.shape.length-2).reduce(((e,t)=>e*t)),r=oa(Xr(e,[n,e.shape[e.shape.length-2],e.shape[e.shape.length-1]]),0),a=[],s=[];return r.forEach((e=>{const[n,r]=bs(e,t);a.push(n),s.push(r)})),[Xr(na(a,0),e.shape),Xr(na(s,0),e.shape)]}}}),function(e){e[e.NONE=0]="NONE",e[e.MEAN=1]="MEAN",e[e.SUM=2]="SUM",e[e.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"}(ws||(ws={}));const vs=Ln({mean_:function(e,t=null,n=!1){const r={x:jn(e,"x","mean")},a={axis:t,keepDims:n};return Cn.runKernel(Xe,r,a)}}),xs=Ln({notEqual_:function(e,t){let n=jn(e,"a","notEqual","string_or_numeric"),r=jn(t,"b","notEqual","string_or_numeric");[n,r]=Nn(n,r),La(n.shape,r.shape);const a={a:n,b:r};return Cn.runKernel(nt,a)}});function ks(e,t="float32"){if("complex64"===t){const t=ks(e,"float32"),n=la(e,"float32");return qn(t,n)}const n=ee(L(e),t);return Cn.makeTensor(n,e,t)}const _s=Ln({computeWeightedLoss_:function(e,t,n=ws.SUM_BY_NONZERO_WEIGHTS){const r=jn(e,"losses","computeWeightedLoss");let a=null;null!=t&&(a=jn(t,"weights","computeWeightedLoss"));const s=null==a?r:Yr(r,a);if(n===ws.NONE)return s;if(n===ws.SUM)return Va(s);if(n===ws.MEAN){if(null==a)return vs(s);{const e=r.size/a.size,t=Gr(Va(s),Va(a));return e>1?Gr(t,Zr(e)):t}}if(n===ws.SUM_BY_NONZERO_WEIGHTS){if(null==a)return Gr(Va(s),Zr(r.size));{const e=Yr(a,ks(r.shape)),t=_r(Va(xs(e,Zr(0))),"float32");return Gr(Va(s),t)}}throw Error(`Unknown reduction: ${n}`)}});Ln({absoluteDifference_:function(e,t,n,r=ws.SUM_BY_NONZERO_WEIGHTS){const a=jn(e,"labels","absoluteDifference"),s=jn(t,"predictions","absoluteDifference");let o=null;null!=n&&(o=jn(n,"weights","absoluteDifference")),P(a.shape,s.shape,"Error in absoluteDifference: ");const i=Za(ra(a,s));return _s(i,o,r)}}),Ln({cosineDistance_:function(e,t,n,r,a=ws.SUM_BY_NONZERO_WEIGHTS){const s=jn(e,"labels","cosineDistance"),o=jn(t,"predictions","cosineDistance");let i=null;null!=r&&(i=jn(r,"weights","cosineDistance")),P(s.shape,o.shape,"Error in cosineDistance: ");const u=Zr(1),c=ra(u,Va(Yr(s,o),n,!0));return _s(c,i,a)}});const Ss=Ln({relu_:function(e){const t={x:jn(e,"x","relu")};return Cn.runKernel(ht,t)}});Ln({hingeLoss_:function(e,t,n,r=ws.SUM_BY_NONZERO_WEIGHTS){let a=jn(e,"labels","hingeLoss");const s=jn(t,"predictions","hingeLoss");let o=null;null!=n&&(o=jn(n,"weights","hingeLoss")),P(a.shape,s.shape,"Error in hingeLoss: ");const i=Zr(1);a=ra(Yr(Zr(2),a),i);const u=Ss(ra(i,Yr(a,s)));return _s(u,o,r)}});const Ns=Ln({minimum_:function(e,t){let n=jn(e,"a","minimum"),r=jn(t,"b","minimum");[n,r]=Nn(n,r),"bool"===n.dtype&&(n=_r(n,"int32"),r=_r(r,"int32")),La(n.shape,r.shape);const a={a:n,b:r};return Cn.runKernel(Qe,a)}});Ln({huberLoss_:function(e,t,n,r=1,a=ws.SUM_BY_NONZERO_WEIGHTS){const s=jn(e,"labels","huberLoss"),o=jn(t,"predictions","huberLoss");let i=null;null!=n&&(i=jn(n,"weights","huberLoss")),P(s.shape,o.shape,"Error in huberLoss: ");const u=Zr(r),c=Za(ra(o,s)),l=Ns(c,u),p=ra(c,l),d=Wr(Yr(Zr(.5),cs(l)),Yr(u,p));return _s(d,i,a)}});const Ts=Ln({log_:function(e){const t={x:jn(e,"x","log")};return Cn.runKernel("Log",t)}});Ln({logLoss_:function(e,t,n,r=1e-7,a=ws.SUM_BY_NONZERO_WEIGHTS){const s=jn(e,"labels","logLoss"),o=jn(t,"predictions","logLoss");let i=null;null!=n&&(i=jn(n,"weights","logLoss")),P(s.shape,o.shape,"Error in logLoss: ");const u=Zr(1),c=Zr(r),l=ys(Yr(s,Ts(Wr(o,c)))),p=Yr(ra(u,s),Ts(Wr(ra(u,o),c))),d=ra(l,p);return _s(d,i,a)}});const Es=Ln({squaredDifference_:function(e,t){let n=jn(e,"a","squaredDifference"),r=jn(t,"b","squaredDifference");[n,r]=Nn(n,r),La(n.shape,r.shape);const a={a:n,b:r};return Cn.runKernel(Ot,a,{})}});Ln({meanSquaredError_:function(e,t,n,r=ws.SUM_BY_NONZERO_WEIGHTS){const a=jn(e,"labels","meanSquaredError"),s=jn(t,"predictions","meanSquaredError");let o=null;null!=n&&(o=jn(n,"weights","meanSquaredError")),P(a.shape,s.shape,"Error in meanSquaredError: ");const i=Es(a,s);return _s(i,o,r)}});const Is=Ln({exp_:function(e){const t={x:jn(e,"x","exp")};return Cn.runKernel("Exp",t)}}),Os=Ln({log1p_:function(e){const t={x:jn(e,"x","log1p")};return Cn.runKernel("Log1p",t)}});function As(e){return Cn.customGrad(e)}Ln({sigmoidCrossEntropy_:function(e,t,n,r=0,a=ws.SUM_BY_NONZERO_WEIGHTS){let s=jn(e,"multiClassLabels","sigmoidCrossEntropy");const o=jn(t,"logits","sigmoidCrossEntropy");let i=null;if(null!=n&&(i=jn(n,"weights","sigmoidCrossEntropy")),P(s.shape,o.shape,"Error in sigmoidCrossEntropy: "),r>0){const e=Zr(r),t=Zr(1),n=Zr(.5);s=Wr(Yr(s,ra(t,e)),Yr(n,e))}const u=function(e,t){const n=jn(e,"labels","sigmoidCrossEntropyWithLogits"),r=jn(t,"logits","sigmoidCrossEntropyWithLogits");P(n.shape,r.shape,"Error in sigmoidCrossEntropyWithLogits: ");const a=Ss(r),s=Yr(r,n),o=Os(Is(ys(Za(r))));return Wr(ra(a,s),o)}(s,o);return _s(u,i,a)}});const Ms=Ln({logSumExp_:function(e,t=null,n=!1){const r=jn(e,"x","logSumExp"),a=W(t,r.shape),s=ss(r,a,!0),o=ra(r,s),i=Is(o),u=Va(i,a),c=Ts(u),l=Wr(Xr(s,c.shape),c);if(n){const e=ts(l.shape,a);return Xr(l,e)}return l}});Ln({softmaxCrossEntropy_:function(e,t,n,r=0,a=ws.SUM_BY_NONZERO_WEIGHTS){let s=jn(e,"onehotLabels","softmaxCrossEntropy");const o=jn(t,"logits","softmaxCrossEntropy");let i=null;if(null!=n&&(i=jn(n,"weights","softmaxCrossEntropy")),P(s.shape,o.shape,"Error in softmaxCrossEntropy: "),r>0){const e=Zr(r),t=Zr(1),n=Zr(s.shape[1]);s=Wr(Yr(s,ra(t,e)),Gr(e,n))}const u=function(e,t,n=-1){if(-1===n&&(n=t.rank-1),n!==t.rank-1)throw Error(`Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank ${t.rank} and dim was ${n}`);return As(((e,t,r)=>{const a=Ms(t,[n],!0),s=ra(_r(t,"float32"),a);r([e,s]);const o=ys(Yr(s,e));return{value:Va(o,[n]),gradFunc:(e,t)=>{const[r,a]=t,s=ts(e.shape,[n]);return[Yr(Xr(e,s),ra(_r(r,"float32"),Is(a))),Yr(Xr(e,s),ra(Is(a),_r(r,"float32")))]}}}))(e,t)}(s,o);return _s(u,i,a)}});const Cs=Ln({sparseFillEmptyRows_:function(e,t,n,r){const a=jn(e,"indices","sparseFillEmptyRows"),s=jn(t,"values","sparseFillEmptyRows"),o=jn(n,"denseShape","sparseFillEmptyRows"),i=jn(r,"defaultValue","sparseFillEmptyRows",s.dtype);if(2!==a.rank)throw new Error(`Indices should be Tensor2D but received shape\n        ${a.shape}`);if(1!==s.rank)throw new Error(`Values should be Tensor1D but received shape ${s.shape}`);if(1!==o.rank)throw new Error(`Dense shape should be Tensor1D but received shape ${o.shape}`);if(0!==i.rank)throw new Error(`Default value should be a scalar but received shape ${i.shape}`);const u={indices:a,values:s,denseShape:o,defaultValue:i},c=Cn.runKernel("SparseFillEmptyRows",u);return{outputIndices:c[0],outputValues:c[1],emptyRowIndicator:c[2],reverseIndexMap:c[3]}}}),Rs=Ln({sparseReshape_:function(e,t,n){const r=jn(e,"inputIndices","sparseReshape"),a=jn(t,"inputShape","sparseReshape"),s=jn(n,"newShape","sparseReshape");if(2!==r.rank)throw new Error(`Input indices should be Tensor2D but received shape\n        ${r.shape}`);if(1!==a.rank)throw new Error(`Input shape should be Tensor1D but received shape ${a.shape}`);if(1!==s.rank)throw new Error(`New shape should be Tensor1D but received shape ${s.shape}`);const o={inputIndices:r,inputShape:a,newShape:s},i=Cn.runKernel("SparseReshape",o);return{outputIndices:i[0],outputShape:i[1]}}}),Ds=Ln({sparseSegmentMean_:function(e,t,n){const r=jn(e,"data","sparseSegmentMean"),a=jn(t,"indices","sparseSegmentMean"),s=jn(n,"segmentIds","sparseSegmentMean");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==a.rank)throw new Error(`Indices should be Tensor1D but received shape\n          ${a.shape}`);if(1!==s.rank)throw new Error(`Segment ids should be Tensor1D but received shape\n          ${s.shape}`);const o={data:r,indices:a,segmentIds:s};return Cn.runKernel("SparseSegmentMean",o)}}),Fs=Ln({sparseSegmentSum_:function(e,t,n){const r=jn(e,"data","sparseSegmentSum"),a=jn(t,"indices","sparseSegmentSum"),s=jn(n,"segmentIds","sparseSegmentSum");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==a.rank)throw new Error(`Indices should be Tensor1D but received shape\n         ${a.shape}`);if(1!==s.rank)throw new Error(`Segment ids should be Tensor1D but received shape\n         ${s.shape}`);const o={data:r,indices:a,segmentIds:s};return Cn.runKernel("SparseSegmentSum",o)}}),$s=Ln({stringNGrams_:function(e,t,n,r,a,s,o,i){const u=jn(e,"data","stringNGrams","string");if("string"!==u.dtype)throw new Error("Data must be of datatype string");if(1!==u.shape.length)throw new Error(`Data must be a vector, saw: ${u.shape}`);const c=jn(t,"dataSplits","stringNGrams");if("int32"!==c.dtype)throw new Error("Data splits must be of datatype int32");const l={separator:n,nGramWidths:r,leftPad:a,rightPad:s,padWidth:o,preserveShortSequences:i},p={data:u,dataSplits:c},d=Cn.runKernel("StringNGrams",p,l);return{nGrams:d[0],nGramsSplits:d[1]}}}),Ps=Ln({stringSplit_:function(e,t,n=!0){const r=jn(e,"input","stringSplit","string"),a=jn(t,"delimiter","stringSplit","string");if(1!==r.rank)throw new Error(`Input should be Tensor1D but received shape ${r.shape}`);if(0!==a.rank)throw new Error(`Delimiter should be a scalar but received shape ${a.shape}`);const s={skipEmpty:n},o={input:r,delimiter:a},i=Cn.runKernel("StringSplit",o,s);return{indices:i[0],values:i[1],shape:i[2]}}}),js=Ln({stringToHashBucketFast_:function(e,t){const n=jn(e,"input","stringToHashBucketFast","string"),r={numBuckets:t};if(t<=0)throw new Error("Number of buckets must be at least 1");const a={input:n};return Cn.runKernel("StringToHashBucketFast",a,r)}}),Bs={flipLeftRight:ka,grayscaleToRGB:Sa,resizeNearestNeighbor:Pa,resizeBilinear:$a,rotateWithOffset:Na,cropAndResize:xa,nonMaxSuppression:Ea,nonMaxSuppressionAsync:async function(e,t,n,r=.5,a=Number.NEGATIVE_INFINITY){const s=jn(e,"boxes","nonMaxSuppressionAsync"),o=jn(t,"scores","nonMaxSuppressionAsync"),i=Ta(s,o,n,r,a);n=i.maxOutputSize,r=i.iouThreshold,a=i.scoreThreshold;const u=await Promise.all([s.data(),o.data()]),c=u[0],l=u[1],{selectedIndices:p}=function(e,t,n,r,a){return Aa(e,t,n,r,a,0)}(c,l,n,r,a);return s!==e&&s.dispose(),o!==t&&o.dispose(),aa(p,"int32")},nonMaxSuppressionWithScore:Da,nonMaxSuppressionWithScoreAsync:async function(e,t,n,r=.5,a=Number.NEGATIVE_INFINITY,s=0){const o=jn(e,"boxes","nonMaxSuppressionAsync"),i=jn(t,"scores","nonMaxSuppressionAsync"),u=Ta(o,i,n,r,a,s);n=u.maxOutputSize,r=u.iouThreshold,a=u.scoreThreshold,s=u.softNmsSigma;const c=await Promise.all([o.data(),i.data()]),l=c[0],p=c[1],{selectedIndices:d,selectedScores:h}=function(e,t,n,r,a,s){return Aa(e,t,n,r,a,s,!0)}(l,p,n,r,a,s);return o!==e&&o.dispose(),i!==t&&i.dispose(),{selectedIndices:aa(d,"int32"),selectedScores:aa(h)}},nonMaxSuppressionPadded:Fa,nonMaxSuppressionPaddedAsync:async function(e,t,n,r=.5,a=Number.NEGATIVE_INFINITY,s=!1){const o=jn(e,"boxes","nonMaxSuppressionAsync"),i=jn(t,"scores","nonMaxSuppressionAsync"),u=Ta(o,i,n,r,a,null),c=u.maxOutputSize,l=u.iouThreshold,p=u.scoreThreshold,[d,h]=await Promise.all([o.data(),i.data()]),{selectedIndices:f,validOutputs:m}=function(e,t,n,r,a,s){return Aa(e,t,n,r,a,0,!1,s,!0)}(d,h,c,l,p,s);return o!==e&&o.dispose(),i!==t&&i.dispose(),{selectedIndices:aa(f,"int32"),validOutputs:Zr(m,"int32")}},threshold:Ga,transform:Ja},Ls={sparseFillEmptyRows:Cs,sparseReshape:Rs,sparseSegmentMean:Ds,sparseSegmentSum:Fs},qs={stringNGrams:$s,stringSplit:Ps,stringToHashBucketFast:js};function zs(e,t){const n=e[0].slice();for(let r=1;r<e.length;r++)n[t]+=e[r][t];return n}function Vs(e,t,n,r,a,s,o="channelsLast"){const[i,u]=Hs(t);let c;if("channelsLast"===o)c=[i,u,e[3],e[3]];else{if("channelsFirst"!==o)throw new Error(`Unknown dataFormat ${o}`);c=[i,u,e[1],e[1]]}return Ws(e,c,n,r,a,s,!1,o)}function Ws(e,t,n,r,a,s,o=!1,i="channelsLast"){let[u,c,l,p]=[-1,-1,-1,-1];if("channelsLast"===i)[u,c,l,p]=e;else{if("channelsFirst"!==i)throw new Error(`Unknown dataFormat ${i}`);[u,p,c,l]=e}const[d,h,,f]=t,[m,y]=Hs(n),[g,b]=Hs(r),w=Us(d,g),v=Us(h,b),{padInfo:x,outHeight:k,outWidth:_}=function(e,t,n,r,a,s,o,i,u){let c,l,p;if("number"==typeof e){c={top:e,bottom:e,left:e,right:e,type:0===e?"VALID":"NUMBER"};const a=function(e,t,n,r,a){null==r&&(r=function(e,t,n,r=1){const a=Us(t,r);return Math.floor((e[0]*(n-1)-n+a)/2)}(e,t,n));const s=e[1];return[Ks((e[0]-t+2*r)/n+1,a),Ks((s-t+2*r)/n+1,a)]}([t,n],s,r,e,i);l=a[0],p=a[1]}else if("same"===e){l=Math.ceil(t/r),p=Math.ceil(n/a);const e=Math.max(0,(l-1)*r+s-t),i=Math.max(0,(p-1)*a+o-n),u=Math.floor(e/2),d=e-u,h=Math.floor(i/2);c={top:u,bottom:d,left:h,right:i-h,type:"SAME"}}else if("valid"===e)c={top:0,bottom:0,left:0,right:0,type:"VALID"},l=Math.ceil((t-s+1)/r),p=Math.ceil((n-o+1)/a);else{if("object"!=typeof e)throw Error(`Unknown padding parameter: ${e}`);{const d="channelsLast"===u?e[1][0]:e[2][0],h="channelsLast"===u?e[1][1]:e[2][1],f="channelsLast"===u?e[2][0]:e[3][0],m="channelsLast"===u?e[2][1]:e[3][1];c={top:d,bottom:h,left:f,right:m,type:0===d&&0===h&&0===f&&0===m?"VALID":"EXPLICIT"},l=Ks((t-s+d+h)/r+1,i),p=Ks((n-o+f+m)/a+1,i)}}return{padInfo:c,outHeight:l,outWidth:p}}(a,c,l,m,y,w,v,s,i),S=o?f*p:f;let N;return"channelsFirst"===i?N=[u,S,k,_]:"channelsLast"===i&&(N=[u,k,_,S]),{batchSize:u,dataFormat:i,inHeight:c,inWidth:l,inChannels:p,outHeight:k,outWidth:_,outChannels:S,padInfo:x,strideHeight:m,strideWidth:y,filterHeight:d,filterWidth:h,effectiveFilterHeight:w,effectiveFilterWidth:v,dilationHeight:g,dilationWidth:b,inShape:e,outShape:N,filterShape:t}}function Hs(e){return"number"==typeof e?[e,e,e]:2===e.length?[e[0],e[1],1]:e}function Us(e,t){return t<=1?e:e+(e-1)*(t-1)}function Ks(e,t){if(!t)return Math.trunc(e);switch(t){case"round":return Math.round(e);case"ceil":return Math.ceil(e);case"floor":return Math.floor(e);default:throw new Error(`Unknown roundingMode ${t}`)}}function Gs(e){const[t,n,r]=Hs(e);return 1===t&&1===n&&1===r}function Js(e,t){return Gs(e)||Gs(t)}function Ys(e){if("NHWC"===e)return"channelsLast";if("NCHW"===e)return"channelsFirst";throw new Error(`Unknown dataFormat ${e}`)}const Xs=Ln({elu_:function(e){const t={x:jn(e,"x","elu")};return Cn.runKernel("Elu",t)}}),Zs=Ln({leakyRelu_:function(e,t=.2){const n={x:jn(e,"x","leakyRelu")},r={alpha:t};return Cn.runKernel(We,n,r)}}),Qs=Ln({prelu_:function(e,t){const n={x:jn(e,"x","prelu"),alpha:jn(t,"alpha","prelu")};return Cn.runKernel(lt,n)}}),eo=Ln({relu6_:function(e){const t={x:jn(e,"x","relu6")};return Cn.runKernel(yt,t)}}),to=Ln({step_:function(e,t=0){const n={x:jn(e,"x","step")},r={alpha:t};return Cn.runKernel(jt,n,r)}});function no(e,t,n){if(null==n||"linear"===n)return e;if("relu"===n)return Yr(e,to(t));throw new Error(`Cannot compute gradient for fused activation ${n}.`)}function ro(e,t){let n=t;const r=function(e,t){const n=[];for(let r=0;r<t.length;r++){const a=e[e.length-r-1],s=t.length-r-1,o=t[s];(null==a||1===a&&o>1)&&n.unshift(s)}return n}(e.shape,t.shape);return r.length>0&&(n=Va(n,r)),Xr(n,e.shape)}function ao(e,t,n,r){if("linear"===t)return e;if("relu"===t)return Ss(e);if("elu"===t)return Xs(e);if("relu6"===t)return eo(e);if("prelu"===t)return Qs(e,n);if("leakyrelu"===t)return Zs(e,r);if("sigmoid"===t)return Qr(e);throw new Error(`Unknown fused activation ${t}.`)}const so=(e,t)=>!(e>0)||"linear"===t;function oo(e,t,n,r=!0){let a=[];if(r)a=a.concat(t.slice(0)),a.push(e[0]/n),a=a.concat(e.slice(1));else{a=a.concat(e[0]);const n=t.length;for(let r=0;r<n;++r)a=a.concat([e[r+1]/t[r],t[r]]);a=a.concat(e.slice(n+1))}return a}function io(e,t,n=!0){const r=[];if(n){r.push(t);for(let n=t+1;n<e;++n)n<=2*t?(r.push(n),r.push(n-(t+1))):r.push(n)}else{const n=[],a=[];for(let r=1;r<e;++r)r>=2*t+1||r%2==1?a.push(r):n.push(r);r.push(...n),r.push(0),r.push(...a)}return r}function uo(e,t,n,r=!0){const a=[];r?a.push(e[0]/n):a.push(e[0]*n);for(let n=1;n<e.length;++n)n<=t.length?r?a.push(t[n-1]*e[n]):a.push(e[n]/t[n-1]):a.push(e[n]);return a}function co(e){try{return e.map((e=>rn(e)))}catch(e){throw new Error(`Failed to decode encoded string bytes into utf-8, error: ${e}`)}}function lo(e){return e.map((e=>nn(e)))}var po,ho;let fo;!function(e){e[e.float32=0]="float32",e[e.int32=1]="int32",e[e.bool=2]="bool",e[e.string=3]="string",e[e.complex64=4]="complex64"}(po||(po={})),function(e){e[e.linear=0]="linear",e[e.relu=1]="relu",e[e.relu6=2]="relu6",e[e.prelu=3]="prelu",e[e.leakyrelu=4]="leakyrelu",e[e.sigmoid=5]="sigmoid",e[e.elu=6]="elu"}(ho||(ho={}));const mo={kernelName:qt,backendName:"wasm",setupFunc:function(e){fo=e.wasm.cwrap(qt,null,["number","array","number","number","array","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{a:a,b:s,bias:o,preluActivationWeights:i}=t;if("float32"!==a.dtype||"float32"!==s.dtype)throw new Error("_FusedMatMul for non non-float32 tensors not yet supported.");const{transposeA:u,transposeB:c,activation:l,leakyreluAlpha:p}=r,d=n.dataIdMap.get(a.dataId).id,h=n.dataIdMap.get(s.dataId).id;let f=0;if(null!=o){const e=n.dataIdMap.get(o.dataId);if(1!==e.shape.length)throw new Error(`_FusedMatMul only supports rank-1 bias but got rank ${e.shape.length}.`);f=e.id}const m=null==i?0:n.dataIdMap.get(i.dataId).id,y=ho[l];if(null==y)throw new Error(`${l} activation not yet supported for FusedConv2D in the wasm backend.`);const g=u?a.shape[2]:a.shape[1],b=c?s.shape[1]:s.shape[2],w=a.shape[0],v=n.makeOutput([w,g,b],a.dtype),x=n.dataIdMap.get(v.dataId).id,k=new Uint8Array(new Int32Array(a.shape).buffer),_=new Uint8Array(new Int32Array(s.shape).buffer);return fo(d,k,a.shape.length,h,_,s.shape.length,u,c,y,f,m,p||0,x),v}};function yo(e){let t;return{kernelName:e,backendName:"wasm",setupFunc:function(n){t=n.wasm.cwrap(e,null,["number","number"])},kernelFunc:function(e){const{backend:n,inputs:{x:r}}=e,a=n.dataIdMap.get(r.dataId).id,s=n.makeOutput(r.shape,r.dtype),o=n.dataIdMap.get(s.dataId).id;return 0===L(s.shape)||t(a,o),s}}}const go=yo("Abs");function bo(e,t,n){let r;return{kernelName:e,backendName:"wasm",setupFunc:function(t){r=t.wasm.cwrap(e,null,["number","array","number","number","array","number","number","number"])},kernelFunc:function(a){const{backend:s,inputs:o}=a,{a:i,b:u}=o,c=s.dataIdMap.get(i.dataId).id,l=s.dataIdMap.get(u.dataId).id,p=null!=n?n:i.dtype,d=La(i.shape,u.shape),h=s.makeOutput(d,p);if(0===L(d))return h;const f=new Uint8Array(new Int32Array(i.shape).buffer),m=new Uint8Array(new Int32Array(u.shape).buffer),y=s.dataIdMap.get(h.dataId).id,g=()=>r(c,f,i.shape.length,l,m,u.shape.length,po[i.dtype],y);if(t&&"float32"===i.dtype)return g(),h;const b=Ba(i.shape,d),w=Ba(u.shape,d),v=b.every(((e,t)=>e===t)),x=w.every(((e,t)=>e===t));if(v&&x)return g(),h;throw new Error(`Broadcasting along outer dims is not yet supported for ${i.dtype} ${e}.`)}}}const wo=bo(de,!0);let vo;const xo={kernelName:he,backendName:"wasm",setupFunc:function(e){vo=e.wasm.cwrap(he,null,["array","number","number","number"])},kernelFunc:function(e){const{inputs:t,backend:n}=e,r=n.makeOutput(t[0].shape,t[0].dtype);if(0===L(r.shape))return r;const a=t.map((e=>n.dataIdMap.get(e.dataId).id)),s=new Uint8Array(new Int32Array(a).buffer),o=n.dataIdMap.get(r.dataId).id;return vo(s,a.length,po[r.dtype],o),r}};function ko(e){const{inputs:{x:t},backend:n}=e,r=n.makeOutput(t.shape,t.dtype),a=n.typedArrayFromHeap(t);return n.typedArrayFromHeap(r).set(a),r}const _o={kernelName:Ve,backendName:"wasm",kernelFunc:ko};let So;function No(e){const{inputs:t,backend:n,attrs:r}=e,[a,s]=function(e,t){const n=[],r=[];for(let a=0;a<e.length;++a)1!==e[a]&&n.push(e[a]),1!==e[t[a]]&&r.push(t[a]);for(let e=0;e<r.length;++e){let t=-1;for(let n=0;n<r.length;++n)r[n]>=e&&(-1===t||r[t]>r[n])&&(t=n);r[t]=e}return[n,r]}(t.x.shape,r.perm);let o=!0;for(let e=0;e<s.length;e++)s[e]!==e&&(o=!1);const i=function(e,t){const n=new Array(e.length);for(let r=0;r<n.length;r++)n[r]=e[t[r]];return n}(t.x.shape,r.perm),u={dataId:t.x.dataId,shape:a,dtype:t.x.dtype};if(o){const e=ko({inputs:t,backend:n});return e.shape=i,e}const c=n.makeOutput(i,u.dtype),l=n.dataIdMap.get(u.dataId).id,p=n.dataIdMap.get(c.dataId).id,d=new Uint8Array(new Int32Array(s).buffer),h=new Uint8Array(new Int32Array(u.shape).buffer);return So(l,h,u.shape.length,po[u.dtype],p,d,s.length),c}const To={kernelName:Ft,backendName:"wasm",kernelFunc:No,setupFunc:function(e){So=e.wasm.cwrap(Ft,null,["number","array","number","number","number","array","number"])}};function Eo(e,t,n){const r=e.shape,a=e.shape.length,s=W(t,r);let o=s;const i=rs(o,a);let u=null,c=!1;if(null!=i){const t=new Array(a);for(let e=0;e<t.length;e++)t[e]=r[i[e]];o=as(o.length,a),u=No({inputs:{x:e},attrs:{perm:i},backend:n});const s=n.dataIdMap.get(e.dataId).id;n.dataIdMap.get(u.dataId).id!==s&&(c=!0)}return{transposed:u,originalAxes:s,axes:o,inputWasTransposed:c}}let Io;const Oo={kernelName:fe,backendName:"wasm",setupFunc:function(e){Io=e.wasm.cwrap(fe,null,["number, number, number"])},kernelFunc:function(e){const{backend:t,inputs:n,attrs:r}=e,{axis:a,keepDims:s}=r,{x:o}=n;let i=t.dataIdMap.get(o.dataId).id,u=o;const{transposed:c,axes:l,originalAxes:p,inputWasTransposed:d}=Eo(o,a,t);d&&(u=c,i=t.dataIdMap.get(c.dataId).id),ns("all",l,u.shape.length);const[h,f]=es(u.shape,l),m=L(f),y=t.makeOutput(h,o.dtype);if(0!==L(u.shape)){const e=t.dataIdMap.get(y.dataId).id;Io(i,m,e)}if(d&&t.disposeData(c.dataId),s){const e=ts(y.shape,p);y.shape=e}return y}};let Ao;const Mo={kernelName:me,backendName:"wasm",setupFunc:function(e){Ao=e.wasm.cwrap(me,null,["number, number, number"])},kernelFunc:function(e){const{backend:t,inputs:n,attrs:r}=e,{axis:a,keepDims:s}=r,{x:o}=n;let i=t.dataIdMap.get(o.dataId).id,u=o;const{transposed:c,axes:l,originalAxes:p,inputWasTransposed:d}=Eo(o,a,t);d&&(u=c,i=t.dataIdMap.get(c.dataId).id),ns("any",l,u.shape.length);const[h,f]=es(u.shape,l),m=L(f),y=t.makeOutput(h,o.dtype);if(0!==L(u.shape)){const e=t.dataIdMap.get(y.dataId).id;Ao(i,m,e)}if(d&&t.disposeData(c.dataId),s){const e=ts(y.shape,p);y.shape=e}return y}};let Co;const Ro={kernelName:ye,backendName:"wasm",kernelFunc:function(e){const{backend:t,inputs:n,attrs:r}=e,{axis:a}=r,{x:s}=n,o=t.dataIdMap.get(s.dataId).id;let i=o,u=s;const{transposed:c,axes:l,inputWasTransposed:p}=Eo(s,a,t);if(p){const e=t.dataIdMap.get(c.dataId).id;e!==o&&(u=c,i=e)}const d=u.shape.slice(0,-1),h=t.makeOutput(d,"int32"),f=t.dataIdMap.get(h.dataId).id,m=L(h.shape),y=u.shape[l[0]];return Co(i,po[u.dtype],m,y,f),p&&t.disposeData(c.dataId),h},setupFunc:function(e){Co=e.wasm.cwrap(ye,null,["number","number","number","number","number"])}};let Do;const Fo={kernelName:ge,backendName:"wasm",setupFunc:function(e){Do=e.wasm.cwrap(ge,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){const{inputs:t,attrs:n,backend:r}=e,a=t.x,s=r.dataIdMap.get(a.dataId).id,{filterSize:o,strides:i,pad:u,dimRoundingMode:c}=n,l=Vs(a.shape,o,i,1,u,c),p=l.filterHeight,d=l.filterWidth,h=l.padInfo.top,f=l.padInfo.right,m=l.padInfo.bottom,y=l.padInfo.left,g=l.strideHeight,b=l.strideWidth,w=l.inChannels;if("channelsLast"!==l.dataFormat)throw new Error(`wasm backend does not support dataFormat:'${l.dataFormat}'. Please use 'channelsLast'.`);if(1!==l.dilationWidth||1!==l.dilationHeight)throw new Error(`was backend only supports average pooling with dilation = [1, 1], got [${l.dilationHeight}, ${l.dilationWidth}].`);const v=r.makeOutput(l.outShape,"float32"),x=r.dataIdMap.get(v.dataId).id;return Do(s,a.shape[0],a.shape[1],a.shape[2],p,d,h,f,m,y,g,b,w,x),v}};function $o(e){const{inputs:t,attrs:n}=e,{x:r}=t,{shape:a}=n,s=L(r.shape),o=function(e,t){let n=1,r=-1;for(let t=0;t<e.length;++t)if(e[t]>=0)n*=e[t];else if(-1===e[t]){if(-1!==r)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${r} and dim ${t}`);r=t}else if(e[t]<0)throw Error(`Shapes can not be < 0. Found ${e[t]} at dim ${t}`);if(-1===r){if(t>0&&t!==n)throw Error(`Size(${t}) must match the product of shape ${e}`);return e}if(0===n)throw Error(`Cannot infer the missing size in [${e}] when there are 0 elements`);if(t%n!=0)throw Error(`The implicit shape can't be a fractional number. Got ${t} / ${n}`);const a=e.slice();return a[r]=t/n,a}(a,s);return $(s===L(o),(()=>`new shape: ${o}, old shape: ${r.shape}. New shape and old shape must have the same number of elements.`)),e.backend.incRef(r.dataId),{dataId:r.dataId,shape:o,dtype:r.dtype}}const Po={kernelName:ft,backendName:"wasm",kernelFunc:$o};let jo;const Bo={kernelName:be,backendName:"wasm",setupFunc:function(e){jo=e.wasm.cwrap(be,null,["number","array","number","number","array","number","number","number","number"])},kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{a:a,b:s}=t,{transposeA:o,transposeB:i}=r;if("float32"!==a.dtype||"float32"!==s.dtype)throw new Error("BatchMatMul for non non-float32 tensors not yet supported.");const u=a.shape.length,c=s.shape.length,l=o?a.shape[u-2]:a.shape[u-1],p=i?s.shape[c-1]:s.shape[c-2],d=o?a.shape[u-1]:a.shape[u-2],h=i?s.shape[c-2]:s.shape[c-1],f=a.shape.slice(0,-2),m=s.shape.slice(0,-2),y=L(f),g=L(m);$(u>=2&&c>=2&&(y===g||1===y||1===g),(()=>`Error in matMul: the input batch dimensions must either be the same or at least one input batch dimension must be 1. Got input batch dimensions of (${f}) and (${m}).`));const b=(y>g?a.shape.slice(0,-2):s.shape.slice(0,-2)).concat([d,h]);$(l===p,(()=>`Error in matMul: inner shapes (${l}) and (${p}) of Tensors with shapes ${a.shape} and ${s.shape} and transposeA=${o} and transposeB=${i} must match.`));const w=i?[g,h,p]:[g,p,h],v=$o({inputs:{x:a},backend:n,attrs:{shape:o?[y,l,d]:[y,d,l]}}),x=$o({inputs:{x:s},backend:n,attrs:{shape:w}}),k=n.dataIdMap.get(v.dataId).id,_=n.dataIdMap.get(x.dataId).id,S=o?v.shape[2]:v.shape[1],N=i?x.shape[1]:x.shape[2],T=Math.max(y,g),E=n.makeOutput([T,S,N],v.dtype),I=n.dataIdMap.get(E.dataId).id,O=new Uint8Array(new Int32Array(v.shape).buffer),A=new Uint8Array(new Int32Array(x.shape).buffer);return jo(k,O,v.shape.length,_,A,x.shape.length,o,i,I),n.disposeData(v.dataId),n.disposeData(x.dataId),E.shape=b,E}};function Lo(e,t,n,r,a){const s=zr(r,t,n),o=L(n),i=X(r);if(s){const n=Vr(t,i);return"string"===a?e.slice(n,n+o):e.subarray(n,n+o)}const u=kr(r,a,"string"===a?co(e):e),c=kr(n,a);for(let e=0;e<c.size;++e){const n=c.indexToLoc(e),r=n.map(((e,n)=>e+t[n]));c.set(u.get(...r),...n)}return"string"===a?lo(c.values):c.values}function qo(e){const{inputs:{x:t},attrs:{begin:n,size:r},backend:a}=e,[s,o]=function(e,t,n){let r;const a=e.shape.length;let s;return r="number"==typeof t?[t,...new Array(a-1).fill(0)]:t.length<a?t.concat(new Array(a-t.length).fill(0)):t.slice(),r.forEach((e=>{$(-1!==e,(()=>"slice() does not support negative begin indexing."))})),s=null==n?new Array(a).fill(-1):"number"==typeof n?[n,...new Array(a-1).fill(-1)]:n.length<a?n.concat(new Array(a-n.length).fill(-1)):n,s=s.map(((t,n)=>t>=0?t:($(-1===t,(()=>`Negative size values should be exactly -1 but got ${t} for the slice() size at index ${n}.`)),e.shape[n]-r[n]))),[r,s]}(t,n,r),i=zr(t.shape,s,o),u=a.readSync(t.dataId),c=a.makeOutput(o,t.dtype),l=X(t.shape),p=a.dataIdMap.get(c.dataId);if(i){const e=Vr(s,l);return"string"===t.dtype?p.stringBytes=u.slice(e,e+L(o)):a.typedArrayFromHeap(c).set(u.subarray(e,e+L(o))),c}if("string"===t.dtype){const e=Lo(u,s,o,t.shape,t.dtype);return p.stringBytes=e,c}const d=a.typedArrayFromHeap(c),h=t.shape.length;if(2===h)!function(e,t,n,r,a){let s=0;const o=r[0],i=r[1],u=o+a[0];for(let r=o;r<u;r++){const o=r*t+i;n.set(e.subarray(o,o+a[1]),s),s+=a[1]}}(u,l[0],d,s,o);else if(3===h)!function(e,t,n,r,a,s){let o=0;const i=a[0],u=a[1],c=a[2],l=i+s[0],p=u+s[1];for(let a=i;a<l;a++)for(let i=u;i<p;i++){const u=a*t+i*n+c;r.set(e.subarray(u,u+s[2]),o),o+=s[2]}}(u,l[0],l[1],d,s,o);else if(4===h)!function(e,t,n,r,a,s,o){let i=0;const u=s[0],c=s[1],l=s[2],p=u+o[0],d=c+o[1],h=l+o[2],f=s[3];for(let s=u;s<p;s++)for(let u=c;u<d;u++)for(let c=l;c<h;c++){const l=s*t+u*n+c*r+f;a.set(e.subarray(l,l+o[3]),i),i+=o[3]}}(u,l[0],l[1],l[2],d,s,o);else{const e=Lo(u,s,o,t.shape,t.dtype);d.set(e)}return c}const zo={kernelName:kt,backendName:"wasm",kernelFunc:qo},Vo={kernelName:we,backendName:"wasm",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{blockShape:s,crops:o}=r,i=s.reduce(((e,t)=>e*t)),u=oo(a.shape,s,i),c=io(u.length,s.length),l=uo(a.shape,s,i),p=function(e,t){const n=[0];for(let r=0;r<t;++r)n.push(e[r][0]);return n}(o,s.length),d=function(e,t,n){const r=e.slice(0,1);for(let a=0;a<n;++a)r.push(e[a+1]-t[a][0]-t[a][1]);return r}(l,o,s.length),h=$o({inputs:{x:a},backend:n,attrs:{shape:u}}),f=No({inputs:{x:h},backend:n,attrs:{perm:c}}),m=qo({inputs:{x:$o({inputs:{x:f},backend:n,attrs:{shape:l}})},backend:n,attrs:{begin:p,size:d}});return n.disposeData(h.dataId),n.disposeData(f.dataId),n.disposeData(h.dataId),m}};function Wo(e){const{inputs:{x:t},attrs:{dtype:n},backend:r}=e,a=r.makeOutput(t.shape,n),s=r.typedArrayFromHeap(t);return r.typedArrayFromHeap(a).set(s),a}const Ho={kernelName:ve,backendName:"wasm",kernelFunc:Wo},Uo=yo(xe);let Ko;const Go={kernelName:ke,backendName:"wasm",setupFunc:function(e){Ko=e.wasm.cwrap(ke,null,["number","number","number","number"])},kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{clipValueMin:s,clipValueMax:o}=r,i=n.dataIdMap.get(a.dataId).id,u=n.makeOutput(a.shape,a.dtype),c=n.dataIdMap.get(u.dataId).id;return Ko(i,s,o,c),u}};function Jo(e){const{inputs:t,backend:n}=e,r=W(e.attrs.axis,t[0].shape)[0];let a=zs(t.map((e=>e.shape)),r);const s=t.filter((e=>L(e.shape)>0));if(1===s.length)return ko({inputs:{x:s[0]},backend:n});const o=n.makeOutput(a,t[0].dtype);if(0===L(a))return o;if(function(e,t){const n=e[0].length;e.forEach(((e,t)=>{$(e.length===n,(()=>`Error in concat${n}D: rank of tensors[${t}] must be the same as the rank of the rest (${n})`))})),$(t>=0&&t<n,(()=>`Error in concat${n}D: axis must be between 0 and ${n-1}.`));const r=e[0];e.forEach(((e,a)=>{for(let s=0;s<n;s++)$(s===t||e[s]===r[s],(()=>`Error in concat${n}D: Shape of tensors[${a}] (${e}) does not match the shape of the rest (${r}) along the non-concatenated axis ${a}.`))}))}(s.map((e=>e.shape)),r),"string"===s[0].dtype){const e=s.map((e=>{const t=L(e.shape.slice(r));return $o({inputs:{x:e},backend:n,attrs:{shape:[-1,t]}})})),i=e.map((e=>({vals:n.readSync(e.dataId),shape:e.shape})));a=zs(e.map((e=>e.shape)),1);const u=1===e[0].shape[0],c=function(e,t,n,r){const a=H(n,L(t));if(r&&"string"!==n){let t=0;e.forEach((e=>{const n=L(e.shape);a.set(e.vals,t),t+=n}))}else{let r=0;e.forEach((e=>{const s="string"===n?co(e.vals):e.vals;let o=0;for(let n=0;n<e.shape[0];++n){const i=n*t[1]+r;for(let t=0;t<e.shape[1];++t)a[i+t]=s[o++]}r+=e.shape[1]}))}return a}(i,a,t[0].dtype,u),l=zs(s.map((e=>e.shape)),r);return o.shape=l,n.dataIdMap.get(o.dataId).stringBytes=lo(c),e.forEach((e=>n.disposeData(e.dataId))),o}const i=L(s[0].shape.slice(0,r));let u=0;const c=s.map((e=>{const t=L(e.shape.slice(r));return u+=t,t})),l=s.map((e=>n.typedArrayFromHeap(e))),p=n.typedArrayFromHeap(o);for(let e=0;e<i;e++){let t=e*u;for(let n=0;n<l.length;n++){const r=c[n],a=e*r,s=l[n].subarray(a,a+r);p.set(s,t),t+=r}}return o}const Yo={kernelName:_e,backendName:"wasm",kernelFunc:Jo};let Xo;const Zo={kernelName:Se,backendName:"wasm",setupFunc:function(e){Xo=e.wasm.cwrap(Se,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){const{inputs:t,attrs:n,backend:r}=e,{x:a,filter:s}=t,o=r.dataIdMap.get(a.dataId).id,i=r.dataIdMap.get(s.dataId).id,{strides:u,dilations:c,pad:l,dimRoundingMode:p,dataFormat:d}=n,h=Ys(d),f=Ws(a.shape,s.shape,u,c,l,p,!1,h),m=f.filterHeight,y=f.filterWidth,g=f.padInfo.top,b=f.padInfo.right,w=f.padInfo.bottom,v=f.padInfo.left,x=f.dilationHeight,k=f.dilationWidth,_=f.strideHeight,S=f.strideWidth,N=f.inChannels,T=f.outChannels,E="SAME"===f.padInfo.type?1:0;if("channelsLast"!==f.dataFormat)throw new Error(`wasm backend Conv2D does not support dataFormat:'${f.dataFormat}'. Please use 'channelsLast'.`);const I=r.makeOutput(f.outShape,"float32"),O=r.dataIdMap.get(I.dataId).id;return Xo(o,a.shape[0],a.shape[1],a.shape[2],i,m,y,g,b,w,v,E,x,k,_,S,N,T,O),I}};let Qo;const ei={kernelName:Ne,backendName:"wasm",setupFunc:function(e){Qo=e.wasm.cwrap(Ne,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){const{backend:t,inputs:n,attrs:r}=e,{dy:a,filter:s}=n,{strides:o,pad:i,dataFormat:u,dimRoundingMode:c,inputShape:l}=r,p=Ys(u),d=Ws(l,s.shape,o,1,i,c,!1,p),{batchSize:h,filterHeight:f,filterWidth:m,inChannels:y,inHeight:g,inWidth:b,outChannels:w,outHeight:v,outWidth:x,strideHeight:k,strideWidth:_}=d,S=f-1-d.padInfo.top,N=m-1-d.padInfo.left,T="channelsLast"===d.dataFormat,E=X(d.inShape),I=X(a.shape),[O,A,M]=X(s.shape),C=E[0],R=T?E[1]:E[2],D=T?E[2]:1,F=T?1:E[1],$=I[0],P=T?I[1]:I[2],j=T?I[2]:1,B=T?1:I[1],L=t.makeOutput(d.inShape,"float32"),q=t.dataIdMap.get(L.dataId).id,z=t.dataIdMap.get(a.dataId).id,V=t.dataIdMap.get(s.dataId).id;return Qo(z,V,h,f,m,g,b,y,v,x,w,k,_,S,N,O,A,M,C,R,D,F,$,P,j,B,q),L}},ti=yo("Cos"),ni=yo(Te);var ri;let ai;!function(e){e[e.bilinear=0]="bilinear",e[e.nearest=1]="nearest"}(ri||(ri={}));const si={kernelName:Ie,backendName:"wasm",setupFunc:function(e){ai=e.wasm.cwrap(Ie,null,["number","number","number","number","array","number","number","number","number","number"])},kernelFunc:function(e){const{backend:t,inputs:n,attrs:r}=e,{method:a,extrapolationValue:s,cropSize:o}=r,{image:i,boxes:u,boxInd:c}=n,l=u.shape[0],[p,d]=o,h=[l,p,d,i.shape[3]];let f,m=t.dataIdMap.get(i.dataId);"float32"!==i.dtype&&(f=Wo({backend:t,inputs:{x:i},attrs:{dtype:"float32"}}),m=t.dataIdMap.get(f.dataId));const y=m.id,g=t.dataIdMap.get(u.dataId).id,b=t.dataIdMap.get(c.dataId).id,w=t.makeOutput(h,"float32"),v=t.dataIdMap.get(w.dataId).id,x=new Uint8Array(new Int32Array(i.shape).buffer);return ai(y,g,b,l,x,p,d,ri[a],s,v),null!=f&&t.disposeData(f.dataId),w}};let oi;const ii={kernelName:Ee,backendName:"wasm",setupFunc:function(e){oi=e.wasm.cwrap(Ee,null,["number","number","number","number","number","number"])},kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{axis:s,exclusive:o,reverse:i}=r,u=a.shape.length;$("float32"===a.dtype||"int32"===a.dtype,(()=>`cumsum does not support ${a.dtype} tensors in the WASM backend`));const c=rs([s],u);let l=a;null!==c&&(l=No({inputs:{x:a},attrs:{perm:c},backend:n}));const p=as(1,u)[0];ns("cumsum",[p],u);const d=n.makeOutput(l.shape,l.dtype),h=l.shape[p],f=n.dataIdMap.get(l.dataId).id,m=n.dataIdMap.get(d.dataId).id;oi(f,o?1:0,i?1:0,h,m,po[a.dtype]);let y=d;return null!==c&&(y=No({inputs:{x:d},attrs:{perm:c.map(((e,t)=>[t,e])).sort(((e,t)=>e[1]-t[1])).map((e=>e[0]))},backend:n}),n.disposeData(l.dataId),n.disposeData(d.dataId)),y}};let ui;const ci={kernelName:Oe,backendName:"wasm",setupFunc:function(e){ui=e.wasm.cwrap(Oe,null,["number","number","number","array","number","array","array","number","number"])},kernelFunc:function(e){const{backend:t,inputs:n,attrs:r}=e,{x:a}=n,{blockSize:s,dataFormat:o}=r;$(s>1,(()=>`blockSize should be > 1 for depthToSpace, but was: ${s}`));const i=a.shape[0],u="NHWC"===o?a.shape[1]:a.shape[2],c="NHWC"===o?a.shape[2]:a.shape[3],l="NHWC"===o?a.shape[3]:a.shape[1],p=u*s,d=c*s,h=l/(s*s),f="NHWC"===o?[i,p,d,h]:[i,h,p,d],m=t.makeOutput(f,"float32"),y=t.dataIdMap.get(a.dataId).id,g=new Uint8Array(new Int32Array(X(a.shape)).buffer),b=new Uint8Array(new Int32Array(f).buffer),w=new Uint8Array(new Int32Array(X(f)).buffer),v=t.dataIdMap.get(m.dataId).id;return ui(y,s,"NHWC"===o?1:0,g,a.shape.length-1,b,w,f.length,v),m}};let li;const pi={kernelName:Ae,backendName:"wasm",setupFunc:function(e){li=e.wasm.cwrap(Ae,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){const{inputs:t,attrs:n,backend:r}=e,{x:a,filter:s}=t,o=r.dataIdMap.get(a.dataId).id,i=r.dataIdMap.get(s.dataId).id,{strides:u,dilations:c,pad:l,dimRoundingMode:p}=n,d=null==c?[1,1]:c,h=Ws(a.shape,s.shape,u,d,l,p,!0),f=h.filterHeight,m=h.filterWidth,y=h.padInfo.top,g=h.padInfo.right,b=h.padInfo.bottom,w=h.padInfo.left,v=h.dilationHeight,x=h.dilationWidth,k=h.strideHeight,_=h.strideWidth,S=h.inChannels,N=h.outChannels,T="SAME"===h.padInfo.type?1:0;if("channelsLast"!==h.dataFormat)throw new Error(`wasm backend DepthwiseConv2dNative does not support dataFormat:'${h.dataFormat}'. Please use 'channelsLast'.`);const E=r.makeOutput(h.outShape,"float32"),I=r.dataIdMap.get(E.dataId).id;return li(o,a.shape[0],a.shape[1],a.shape[2],i,f,m,y,g,b,w,T,v,x,k,_,S,N,I),E}},di=yo("Elu"),hi=bo(Ce,!1,"bool"),fi=yo("Exp");function mi(e){const{inputs:t,attrs:n,backend:r}=e,{input:a}=t,{dim:s}=n,o=a.shape.length,i=a.shape.slice();let u=s;return s<0&&($(-(o+1)<=s,(()=>`Axis must be in the interval [${-(o+1)}, ${o}]`)),u=o+s+1),i.splice(u,0,1),$o({inputs:{x:a},backend:r,attrs:{shape:i}})}const yi={kernelName:Re,backendName:"wasm",kernelFunc:mi};function gi(e){const{attrs:{shape:t,value:n,dtype:r},backend:a}=e,s=a.makeOutput(t,r);return a.typedArrayFromHeap(s).fill(n),s}const bi={kernelName:De,backendName:"wasm",kernelFunc:gi};let wi;const vi={kernelName:Fe,backendName:"wasm",kernelFunc:function(e){const{inputs:t,backend:n}=e,{image:r}=t,a=n.makeOutput(r.shape,r.dtype),s=n.dataIdMap.get(r.dataId).id,o=n.dataIdMap.get(a.dataId).id,[i,u,c,l]=r.shape;return wi(s,i,u,c,l,o),a},setupFunc:function(e){wi=e.wasm.cwrap(Fe,null,["number","number","number","number","number","number"])}},xi=yo($e),ki=bo(Pe,!1);let _i;const Si={kernelName:je,backendName:"wasm",setupFunc:function(e){_i=e.wasm.cwrap(je,null,["number","number","number","number","number","number","number"])},kernelFunc:function(e){const{backend:t,inputs:n,attrs:r}=e,{varianceEpsilon:a}=r,{x:s,mean:o,variance:i,offset:u,scale:c}=n,l=t.dataIdMap.get(s.dataId).id,p=t.dataIdMap.get(o.dataId).id,d=t.dataIdMap.get(i.dataId).id,h=null!=u?t.dataIdMap.get(u.dataId).id:0,f=null!=c?t.dataIdMap.get(c.dataId).id:0,m=t.makeOutput(s.shape,s.dtype);if(0===L(s.shape))return m;const y=t.dataIdMap.get(m.dataId).id;return _i(l,p,d,h,f,a,y),m}};let Ni;const Ti={kernelName:zt,backendName:"wasm",setupFunc:function(e){Ni=e.wasm.cwrap(zt,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){const{inputs:t,attrs:n,backend:r}=e,{x:a,filter:s,bias:o,preluActivationWeights:i}=t,{strides:u,pad:c,dilations:l,dataFormat:p,dimRoundingMode:d,activation:h,leakyreluAlpha:f}=n,m=Ws(a.shape,s.shape,u,l,c,d),y=ho[h];if(null==y)throw new Error(`${h} activation not yet supported for FusedConv2D in the wasm backend.`);const g=r.dataIdMap.get(a.dataId).id,b=r.dataIdMap.get(s.dataId).id,w=m.outChannels;let v=0;if(null!=o){const e=r.dataIdMap.get(o.dataId);if(1!==e.shape.length)throw new Error(`FusedConv2D only supports rank-1 bias but got rank ${e.shape.length}.`);if(e.shape[0]!==w)throw new Error(`FusedConv2D bias shape (${e.shape}) does not match the number of output channels (${w})`);v=e.id}const x=m.filterHeight,k=m.filterWidth,_=m.padInfo.top,S=m.padInfo.right,N=m.padInfo.bottom,T=m.padInfo.left,E=m.dilationHeight,I=m.dilationWidth,O=m.strideHeight,A=m.strideWidth,M=m.inChannels,C="SAME"===m.padInfo.type?1:0,R=m.batchSize,D=m.inHeight,F=m.inWidth;if("NHWC"!==p)throw new Error(`wasm backend FusedConv2D does not support dataFormat:'${p}'. Please use 'NHWC'.`);const $=r.makeOutput(m.outShape,"float32"),P=r.dataIdMap.get($.dataId).id,j=null==i?0:r.dataIdMap.get(i.dataId).id;return Ni(g,R,D,F,b,x,k,v,_,S,N,T,C,E,I,O,A,M,w,y,j,f||0,P),$}};let Ei;const Ii={kernelName:Vt,backendName:"wasm",setupFunc:function(e){Ei=e.wasm.cwrap(Vt,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){const{inputs:t,attrs:n,backend:r}=e,{x:a,filter:s,bias:o,preluActivationWeights:i}=t,{strides:u,pad:c,dilations:l,dataFormat:p,dimRoundingMode:d,activation:h,leakyreluAlpha:f}=n,m=Ws(a.shape,s.shape,u,l,c,d,!0),y=ho[h];if(null==y)throw new Error(`${h} activation not yet supported for FusedDepthwiseConv2D in the wasm backend.`);const g=r.dataIdMap.get(a.dataId).id,b=r.dataIdMap.get(s.dataId).id,w=m.outChannels;let v=0;if(null!=o){const e=r.dataIdMap.get(o.dataId);if(1!==e.shape.length)throw new Error(`FusedDepthwiseConv2D only supports rank-1 bias but got rank ${e.shape.length}.`);if(e.shape[0]!==w)throw new Error(`FusedDepthwiseConv2D bias shape (${e.shape}) does not match the number of output channels (${w})`);v=e.id}const x=m.filterHeight,k=m.filterWidth,_=m.padInfo.top,S=m.padInfo.right,N=m.padInfo.bottom,T=m.padInfo.left,E=m.dilationHeight,I=m.dilationWidth,O=m.strideHeight,A=m.strideWidth,M=m.inChannels,C="SAME"===m.padInfo.type?1:0,R=m.batchSize,D=m.inHeight,F=m.inWidth;if("NHWC"!==p)throw new Error(`wasm backend FusedDepthwiseConv2D does not support dataFormat:'${p}'. Please use 'NHWC'.`);const $=r.makeOutput(m.outShape,"float32"),P=r.dataIdMap.get($.dataId).id,j=null==i?0:r.dataIdMap.get(i.dataId).id;return Ei(g,R,D,F,b,x,k,v,_,S,N,T,C,E,I,O,A,M,w,y,j,f||0,P),$}};let Oi;const Ai={kernelName:Le,backendName:"wasm",setupFunc:function(e){Oi=e.wasm.cwrap(Le,null,["number","number","number","number","number","number","array","number"])},kernelFunc:function(e){const{backend:t,inputs:n}=e,{params:r,indices:a}=n,[s,o,i,u]=function(e,t){const n=e.shape.length,r=t.shape.length;if(n<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${n}.`);if(r<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${r}.`);if("int32"!==t.dtype)throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${t.dtype}.`);if(t.shape[r-1]>n)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${t.shape[r-1]} vs. ${n}`);if(0===L(e.shape))throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${e.shape}.`);const a=t.shape,s=a[a.length-1];let o=1;for(let e=0;e<a.length-1;++e)o*=a[e];const i=e.shape,u=a.slice();u.pop();let c=1;for(let e=s;e<n;++e)c*=i[e],u.push(i[e]);const l=[...X(e.shape).map((e=>e/c)),1].slice(0,s);return[u,o,c,l]}(r,a),c=t.makeOutput(s,r.dtype);if(0===o)return c;const l=a.shape,p=l[l.length-1],d=t.dataIdMap.get(r.dataId).id,h=t.dataIdMap.get(a.dataId).id,f=new Uint8Array(new Int32Array(u).buffer),m=t.dataIdMap.get(c.dataId).id;return Oi(d,po[r.dtype],h,o,p,i,f,m),c}};let Mi;const Ci={kernelName:Be,backendName:"wasm",setupFunc:function(e){Mi=e.wasm.cwrap("Gather",null,["number","number","array","number","number","number","array","number"])},kernelFunc:function(e){const{backend:t,inputs:n,attrs:r}=e,{x:a,indices:s}=n,{axis:o,batchDims:i}=r,u=function(e,t,n,r){const a=t.shape.length,s=e.shape.length;if(0!==r&&(r<-a||r>a))throw new Error(`Expect batchDims in the range of [-${a}, ${a}], but got ${r}`);if(r<0&&(r+=a),r>s)throw new Error(`batchDims (${r}) must be less than rank(x) (\n    ${s}).`);if(n<r)throw new Error(`batchDims (${r}) must be less than or equal to axis (${n}).`);for(let n=0;n<r;++n)if(e.shape[n]!==t.shape[n])throw new Error(`x.shape[${n}]: ${e.shape[n]} should be equal to indices.shape[${n}]: ${t.shape[n]}.`);const o=e.shape[n],i=[];let u=1,c=1,l=1;for(let t=0;t<r;++t)i.push(e.shape[t]),u*=e.shape[t];for(let t=r;t<n;t++)i.push(e.shape[t]),c*=e.shape[t];for(let e=r;e<a;e++)i.push(t.shape[e]);for(let t=n+1;t<s;t++)i.push(e.shape[t]),l*=e.shape[t];return{batchSize:u,sliceSize:l,outerSize:c,dimSize:o,outputShape:i}}(a,s,W(o,a.shape)[0],i),c=$o({inputs:{x:a},attrs:{shape:[u.batchSize,u.outerSize,u.dimSize,u.sliceSize]},backend:t}),l=L(s.shape),p=$o({inputs:{x:s},attrs:{shape:[u.batchSize,l/u.batchSize]},backend:t}),d=[u.batchSize,u.outerSize,l/u.batchSize,u.sliceSize],h=t.makeOutput(d,a.dtype);if(0===L(a.shape))return h;const f=c.shape.length-1,m=t.dataIdMap.get(c.dataId).id,y=t.dataIdMap.get(p.dataId).id,g=t.dataIdMap.get(h.dataId).id,b=new Uint8Array(new Int32Array(X(c.shape)).buffer),w=new Uint8Array(new Int32Array(X(d)).buffer);return Mi(m,po[a.dtype],b,f,y,u.batchSize,w,g),t.disposeData(c.dataId),t.disposeData(p.dataId),h.shape=u.outputShape,h}},Ri=bo(qe,!1,"bool"),Di=bo(ze,!1,"bool");let Fi;const $i={kernelName:We,backendName:"wasm",setupFunc:function(e){Fi=e.wasm.cwrap(We,null,["number","number","number"])},kernelFunc:function(e){const{inputs:{x:t},attrs:{alpha:n},backend:r}=e,a=r.dataIdMap.get(t.dataId).id,s=r.makeOutput(t.shape,t.dtype);if(0!==L(t.shape)){const e=r.dataIdMap.get(s.dataId).id;Fi(a,n,e)}return s}},Pi=bo(He,!1,"bool"),ji=bo(Ue,!1,"bool"),Bi=yo("Log"),Li=bo(Ke,!1,"bool");let qi;const zi={kernelName:Ge,backendName:"wasm",setupFunc:function(e){qi=e.wasm.cwrap(Ge,null,["number, number, number"])},kernelFunc:function(e){const{backend:t,inputs:n,attrs:r}=e,{reductionIndices:a,keepDims:s}=r,{x:o}=n;let i=t.dataIdMap.get(o.dataId).id,u=o;const{transposed:c,axes:l,originalAxes:p,inputWasTransposed:d}=Eo(o,a,t);d&&(u=c,i=t.dataIdMap.get(c.dataId).id),ns("max",l,u.shape.length);const[h,f]=es(u.shape,l),m=L(f),y=t.makeOutput(h,o.dtype);if(0!==L(u.shape)){const e=t.dataIdMap.get(y.dataId).id;qi(i,m,e)}if(d&&t.disposeData(c.dataId),s){const e=ts(y.shape,p);y.shape=e}return y}},Vi=bo(Je,!1);let Wi;const Hi={kernelName:Ye,backendName:"wasm",setupFunc:function(e){Wi=e.wasm.cwrap(Ye,null,["number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){const{inputs:t,attrs:n,backend:r}=e,a=t.x,s=r.dataIdMap.get(a.dataId).id,{filterSize:o,strides:i,pad:u,dimRoundingMode:c}=n,l=Vs(a.shape,o,i,1,u,c),p=l.filterHeight,d=l.filterWidth,h=l.padInfo.top,f=l.padInfo.right,m=l.padInfo.bottom,y=l.padInfo.left,g=l.dilationHeight,b=l.dilationWidth,w=l.strideHeight,v=l.strideWidth,x=l.inChannels,k=l.outChannels;if("channelsLast"!==l.dataFormat)throw new Error(`wasm backend does not support dataFormat:'${l.dataFormat}'. Please use 'channelsLast'.`);const _=r.makeOutput(l.outShape,"float32"),S=r.dataIdMap.get(_.dataId).id;return Wi(s,a.shape[0],a.shape[1],a.shape[2],p,d,h,f,m,y,g,b,w,v,x,k,S),_}};let Ui;const Ki={kernelName:Xe,backendName:"wasm",setupFunc:function(e){Ui=e.wasm.cwrap(Xe,null,["number, number, number"])},kernelFunc:function(e){const{backend:t,inputs:n,attrs:r}=e,{axis:a,keepDims:s}=r,{x:o}=n,i=t.dataIdMap.get(o.dataId).id;let u=i,c=o;const{transposed:l,axes:p,originalAxes:d,inputWasTransposed:h}=Eo(o,a,t);let f=p;if(h){const e=t.dataIdMap.get(l.dataId).id;e!==i&&(c=l,u=e,f=as(f.length,c.shape.length))}ns("mean",f,c.shape.length);const[m,y]=es(c.shape,f),g=L(y);let b=c;"float32"!==c.dtype&&(b=Wo({backend:t,inputs:{x:c},attrs:{dtype:"float32"}}),u=t.dataIdMap.get(b.dataId).id);const w=t.makeOutput(m,"float32");if(0!==L(c.shape)){const e=t.dataIdMap.get(w.dataId).id;Ui(u,g,e)}if(h&&t.disposeData(l.dataId),s){const e=ts(w.shape,d);w.shape=e}return"float32"!==c.dtype&&t.disposeData(b.dataId),w}};let Gi;const Ji={kernelName:Ze,backendName:"wasm",setupFunc:function(e){Gi=e.wasm.cwrap(Ze,null,["number, number, number"])},kernelFunc:function(e){const{backend:t,inputs:n,attrs:r}=e,{axis:a,keepDims:s}=r,{x:o}=n,i=t.dataIdMap.get(o.dataId).id;let u=i,c=o;const{transposed:l,axes:p,originalAxes:d,inputWasTransposed:h}=Eo(o,a,t);if(h){const e=t.dataIdMap.get(l.dataId).id;e!==i&&(c=l,u=e)}ns("min",p,c.shape.length);const[f,m]=es(c.shape,p),y=L(m),g=t.makeOutput(f,c.dtype);if(0!==L(c.shape)){const e=t.dataIdMap.get(g.dataId).id;Gi(u,y,e)}if(h&&t.disposeData(l.dataId),s){const e=ts(g.shape,d);g.shape=e}return g}},Yi=bo(Qe,!1);var Xi;let Zi;!function(e){e[e.reflect=0]="reflect",e[e.symmetric=1]="symmetric"}(Xi||(Xi={}));const Qi={kernelName:et,backendName:"wasm",kernelFunc:function(e){const{inputs:{x:t},backend:n,attrs:{paddings:r,mode:a}}=e,s=r.map(((e,n)=>e[0]+t.shape[n]+e[1])),o=n.dataIdMap.get(t.dataId).id,i=n.makeOutput(s,t.dtype),u=n.dataIdMap.get(i.dataId).id,c=new Uint8Array(new Int32Array(t.shape).buffer),l=r.map((e=>e[0])),p=r.map((e=>e[1])),d=new Uint8Array(new Int32Array(l).buffer),h=new Uint8Array(new Int32Array(p).buffer);return Zi(o,c,t.shape.length,po[t.dtype],d,h,Xi[a],u),i},setupFunc:function(e){Zi=e.wasm.cwrap(et,null,["number","array","number","number","array","array","number","number"])}},eu=bo(tt,!0),tu=yo("Neg");function nu(e,t){const n=new Int32Array(e.wasm.HEAPU8.buffer,t,4),r=n[0],a=n[1],s=n[2],o=n[3];return e.wasm._free(t),{pSelectedIndices:r,selectedSize:a,pSelectedScores:s,pValidOutputs:o}}let ru;const au={kernelName:rt,backendName:"wasm",setupFunc:function(e){ru=e.wasm.cwrap(rt,"number",["number","number","number","number","number"])},kernelFunc:function(e){const{backend:t,inputs:n,attrs:r}=e,{iouThreshold:a,maxOutputSize:s,scoreThreshold:o}=r,{boxes:i,scores:u}=n,c=t.dataIdMap.get(i.dataId).id,l=t.dataIdMap.get(u.dataId).id,p=ru(c,l,s,a,o),{pSelectedIndices:d,selectedSize:h,pSelectedScores:f,pValidOutputs:m}=nu(t,p);return t.wasm._free(f),t.wasm._free(m),t.makeOutput([h],"int32",d)}};let su;const ou={kernelName:at,backendName:"wasm",setupFunc:function(e){su=e.wasm.cwrap(at,"number",["number","number","number","number","number","bool"])},kernelFunc:function(e){const{backend:t,inputs:n,attrs:r}=e,{iouThreshold:a,maxOutputSize:s,scoreThreshold:o,padToMaxOutputSize:i}=r,{boxes:u,scores:c}=n,l=t.dataIdMap.get(u.dataId).id,p=t.dataIdMap.get(c.dataId).id,d=su(l,p,s,a,o,i),{pSelectedIndices:h,selectedSize:f,pSelectedScores:m,pValidOutputs:y}=nu(t,d);return t.wasm._free(m),[t.makeOutput([f],"int32",h),t.makeOutput([],"int32",y)]}};let iu;const uu={kernelName:st,backendName:"wasm",setupFunc:function(e){iu=e.wasm.cwrap(st,"number",["number","number","number","number","number","number"])},kernelFunc:function(e){const{backend:t,inputs:n,attrs:r}=e,{iouThreshold:a,maxOutputSize:s,scoreThreshold:o,softNmsSigma:i}=r,{boxes:u,scores:c}=n,l=t.dataIdMap.get(u.dataId).id,p=t.dataIdMap.get(c.dataId).id,d=iu(l,p,s,a,o,i),{pSelectedIndices:h,selectedSize:f,pSelectedScores:m,pValidOutputs:y}=nu(t,d);return t.wasm._free(y),[t.makeOutput([f],"int32",h),t.makeOutput([f],"float32",m)]}},cu=bo(nt,!1,"bool");let lu;const pu={kernelName:it,backendName:"wasm",setupFunc:function(e){lu=e.wasm.cwrap(it,null,["number","number","number","number","number"])},kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{indices:a}=t,{depth:s,onValue:o,offValue:i}=r,u=n.makeOutput([...a.shape,s],"int32"),c=n.dataIdMap.get(u.dataId).id,l=n.dataIdMap.get(a.dataId).id;return lu(l,s,o,i,c),u}},du={kernelName:ot,backendName:"wasm",kernelFunc:function(e){const{inputs:{x:t},backend:n}=e,r=n.makeOutput(t.shape,t.dtype);return n.typedArrayFromHeap(r).fill(1),r}},hu={kernelName:ut,backendName:"wasm",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{axis:a}=r;if(1===t.length)return mi({inputs:{input:t[0]},backend:n,attrs:{dim:a}});const s=t[0].shape,o=t[0].dtype;t.forEach((e=>{P(s,e.shape,"All tensors passed to stack must have matching shapes"),$(o===e.dtype,(()=>"All tensors passed to stack must have matching dtypes"))}));const i=[],u=Jo({inputs:t.map((e=>{const t=mi({inputs:{input:e},backend:n,attrs:{dim:a}});return i.push(t),t})),backend:n,attrs:{axis:a}});return i.forEach((e=>n.disposeData(e.dataId))),u}};let fu;const mu={kernelName:ct,backendName:"wasm",kernelFunc:function(e){const{inputs:{x:t},backend:n,attrs:{paddings:r,constantValue:a}}=e,s=r.map(((e,n)=>e[0]+t.shape[n]+e[1]));if(0===L(t.shape))return gi({backend:n,attrs:{shape:s,value:a,dtype:t.dtype}});const o=n.dataIdMap.get(t.dataId).id,i=n.makeOutput(s,t.dtype),u=n.dataIdMap.get(i.dataId).id,c=new Uint8Array(new Int32Array(t.shape).buffer),l=r.map((e=>e[0])),p=r.map((e=>e[1])),d=new Uint8Array(new Int32Array(l).buffer),h=new Uint8Array(new Int32Array(p).buffer);return fu(o,c,t.shape.length,po[t.dtype],d,h,a,u),i},setupFunc:function(e){fu=e.wasm.cwrap(ct,null,["number","array","number","number","array","array","number","number"])}},yu=bo("Pow",!1);let gu;const bu={kernelName:lt,backendName:"wasm",setupFunc:function(e){gu=e.wasm.cwrap(lt,null,["number","number","number"])},kernelFunc:function(e){const{inputs:t,backend:n}=e,{x:r,alpha:a}=t,s=n.dataIdMap.get(r.dataId).id,o=n.dataIdMap.get(a.dataId).id,i=n.makeOutput(r.shape,"float32"),u=n.dataIdMap.get(i.dataId).id;return gu(s,o,u),i}};let wu;const vu={kernelName:pt,backendName:"wasm",setupFunc:function(e){wu=e.wasm.cwrap(pt,null,["number","number","number","number"])},kernelFunc:function(e){const{backend:t,inputs:n,attrs:r}=e,{axis:a,keepDims:s}=r,{x:o}=n,i=t.dataIdMap.get(o.dataId).id;let u=i,c=o;const{transposed:l,axes:p,originalAxes:d,inputWasTransposed:h}=Eo(o,a,t);let f=p;if(h){const e=t.dataIdMap.get(l.dataId).id;e!==i&&(c=l,u=e,f=as(f.length,c.shape.length))}ns("prod",f,c.shape.length);const[m,y]=es(c.shape,f),g=L(y),b=t.makeOutput(m,c.dtype);if(0!==L(c.shape)){const e=t.dataIdMap.get(b.dataId).id;wu(u,g,po[b.dtype],e)}if(h&&t.disposeData(l.dataId),s){const e=ts(b.shape,d);b.shape=e}return b}},xu={kernelName:dt,backendName:"wasm",kernelFunc:e=>{const{backend:t,attrs:n}=e,{start:r,stop:a,step:s,dtype:o}=n,i=function(e,t,n,r){if(e===t||e<t&&n<0||t<e&&n>1)return te(0,r);const a=te(Math.abs(Math.ceil((t-e)/n)),r);t<e&&1===n&&(n=-1),a[0]=e;for(let e=1;e<a.length;e++)a[e]=a[e-1]+n;return a}(r,a,s,o),u=t.makeOutput([i.length],o);return t.typedArrayFromHeap(u).set(i),u}},ku=bo(Me,!0),_u=yo(ht),Su=yo(yt);let Nu;const Tu={kernelName:mt,backendName:"wasm",setupFunc:function(e){Nu=e.wasm.cwrap(mt,null,["number","number","number","number","number","number","number","number","number","number"])},kernelFunc:function(e){const{backend:t,inputs:n,attrs:r}=e,{images:a}=n,{alignCorners:s,halfPixelCenters:o,size:i}=r,[u,c]=i,[l,p,d,h]=a.shape,f=[l,u,c,h];let m,y=t.dataIdMap.get(a.dataId);"float32"!==y.dtype&&(m=Wo({backend:t,inputs:{x:a},attrs:{dtype:"float32"}}),y=t.dataIdMap.get(m.dataId));const g=y.id,b=t.makeOutput(f,"float32");if(0===L(a.shape))return b;const w=t.dataIdMap.get(b.dataId).id;return Nu(g,l,p,d,h,u,c,s?1:0,o?1:0,w),null!=m&&t.disposeData(m.dataId),b}};let Eu;const Iu={kernelName:gt,backendName:"wasm",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{dims:s}=r,o=W(s,a.shape);if(0===a.shape.length)return ko({inputs:{x:a},backend:n});const i=n.makeOutput(a.shape,a.dtype),u=n.dataIdMap.get(a.dataId).id,c=n.dataIdMap.get(i.dataId).id,l=new Uint8Array(new Int32Array(o).buffer),p=new Uint8Array(new Int32Array(a.shape).buffer);Eu(u,l,o.length,p,a.shape.length,c);const d=$o({inputs:{x:i},attrs:{shape:a.shape},backend:n});return n.disposeData(i.dataId),d},setupFunc:function(e){Eu=e.wasm.cwrap(gt,null,["number","array","number","array","number","number"])}};let Ou;const Au={kernelName:Lt,backendName:"wasm",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{image:a}=t,{radians:s,fillValue:o,center:i}=r,u=n.makeOutput(a.shape,a.dtype),c=n.dataIdMap.get(a.dataId).id,l=n.dataIdMap.get(u.dataId).id,[p,d,h,f]=a.shape,[m,y]=function(e,t,n){return[n*("number"==typeof e?e:e[0]),t*("number"==typeof e?e:e[1])]}(i,d,h),g="number"==typeof o?[o,o,o,0===o?0:255]:[...o,255],b=new Uint8Array(new Int32Array(g).buffer);return Ou(c,p,d,h,f,s,m,y,b,g.length,l),u},setupFunc:function(e){Ou=e.wasm.cwrap(Lt,null,["number","number","number","number","number","number","number","number","array","number","number"])}},Mu=yo(bt),Cu=yo(wt);let Ru;const Du={kernelName:vt,backendName:"wasm",setupFunc:function(e){Ru=e.wasm.cwrap(vt,null,["number","number","number","number","number","number","array","number","number"])},kernelFunc:function(e){const{backend:t,inputs:n,attrs:r}=e,{indices:a,updates:s}=n,{shape:o}=r,i=t.makeOutput(o,s.dtype);if(0===L(o))return i;const{sliceRank:u,numUpdates:c,sliceSize:l,strides:p,outputSize:d}=function(e,t,n){const r=t.shape.length,a=r>1?t.shape[r-1]:1,s=n.length;let o=1;for(let e=a;e<s;++e)o*=n[e];const i=a<1?1:a;return{sliceRank:a,numUpdates:L(t.shape)/i,sliceSize:o,strides:[...X(n.slice(0,a)),1],outputSize:L(n)}}(0,a,o),h=t.dataIdMap.get(a.dataId).id,f=t.dataIdMap.get(s.dataId).id,m=new Uint8Array(new Int32Array(p).buffer),y=t.dataIdMap.get(i.dataId).id;return Ru(h,f,po[s.dtype],u,c,l,m,d,y),i}};let Fu;const $u={kernelName:xt,backendName:"wasm",kernelFunc:function(e){const{inputs:t,backend:n}=e,{condition:r,t:a,e:s}=t,o=n.dataIdMap.get(r.dataId).id,i=n.dataIdMap.get(a.dataId).id,u=n.dataIdMap.get(s.dataId).id,c=n.makeOutput(a.shape,a.dtype),l=n.dataIdMap.get(c.dataId).id,p=r.shape.length,d=a.shape.length,h=0===p||p>1||1===d?1:L(a.shape.slice(1));return Fu(o,i,u,h,l),c},setupFunc:function(e){Fu=e.wasm.cwrap("SelectV2",null,["number","number","number","number","number"])}};let Pu;const ju={kernelName:"Sigmoid",backendName:"wasm",setupFunc:function(e){Pu=e.wasm.cwrap(_t,null,["number","number"])},kernelFunc:function(e){const{backend:t,inputs:{x:n}}=e,r=t.dataIdMap.get(n.dataId).id,a=t.makeOutput(n.shape,n.dtype),s=t.dataIdMap.get(a.dataId).id;return 0===L(a.shape)||Pu(r,s),a}},Bu=yo("Sin");let Lu;const qu={kernelName:It,backendName:"wasm",setupFunc:function(e){Lu=e.wasm.cwrap(It,null,["number","number","number","number"])},kernelFunc:function(e){const{backend:t,inputs:{logits:n},attrs:{dim:r}}=e,a=t.dataIdMap.get(n.dataId).id,s=t.makeOutput(n.shape,n.dtype),o=t.dataIdMap.get(s.dataId).id,i=n.shape[r],u=L(n.shape)/i;return 0===L(s.shape)||Lu(a,o,i,u),s}},zu={kernelName:Tt,backendName:"wasm",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,{blockShape:s,paddings:o}=r,i=L(s),u=[[0,0]];u.push(...o);for(let e=1+s.length;e<a.shape.length;++e)u.push([0,0]);const c=mu.kernelFunc({inputs:{x:a},backend:n,attrs:{paddings:u,constantValue:0}}),l=oo(c.shape,s,i,!1),p=io(l.length,s.length,!1),d=uo(c.shape,s,i,!1),h=$o({inputs:{x:c},backend:n,attrs:{shape:l}}),f=No({inputs:{x:h},backend:n,attrs:{perm:p}}),m=$o({inputs:{x:f},backend:n,attrs:{shape:d}});return n.disposeData(c.dataId),n.disposeData(h.dataId),n.disposeData(f.dataId),m}},Vu={kernelName:Et,backendName:"wasm",kernelFunc:function(e){const{inputs:t,attrs:n,backend:r}=e,{x:a}=t,{numOrSizeSplits:s,axis:o}=n,i=W(o,a.shape)[0],u=function(e,t,n=0){let r=[];if("number"==typeof t)$(e.shape[n]%t==0,(()=>"Number of splits must evenly divide the axis.")),r=new Array(t).fill(e.shape[n]/t);else{$(t.reduce(((e,t)=>(-1===t&&(e+=1),e)),0)<=1,(()=>"There should be only one negative value in split array."));const a=t.indexOf(-1);if(-1!==a){const r=t.reduce(((e,t)=>t>0?e+t:e));t[a]=e.shape[n]-r}$(e.shape[n]===t.reduce(((e,t)=>e+t)),(()=>"The sum of sizes must match the size of the axis dimension.")),r=t}return r}(a,s,i),c=new Array(a.shape.length).fill(0),l=a.shape.slice();return u.map((e=>{const t=[...l];t[i]=e;const n=qo({inputs:{x:a},attrs:{begin:c,size:t},backend:r});return c[i]+=e,n}))}},Wu=yo(St),Hu=yo("Square"),Uu=bo(Ot,!0);let Ku;const Gu={kernelName:jt,backendName:"wasm",setupFunc:function(e){Ku=e.wasm.cwrap(jt,null,["number","number","number"])},kernelFunc:function(e){const{backend:t,inputs:n,attrs:r}=e,{alpha:a}=r,{x:s}=n,o=t.dataIdMap.get(s.dataId).id,i=t.makeOutput(s.shape,s.dtype),u=t.dataIdMap.get(i.dataId).id;return Ku(o,a,u),i}};let Ju;const Yu={kernelName:At,backendName:"wasm",setupFunc:function(e){Ju=e.wasm.cwrap(At,null,["number","array","number","array","array","array","array","array","number","number"])},kernelFunc:function(e){const{backend:t,inputs:n,attrs:r}=e,{x:a}=n;let{begin:s,end:o,strides:i}=r;null==i&&(i=new Array(s.length));const{beginMask:u,endMask:c,ellipsisMask:l,newAxisMask:p,shrinkAxisMask:d}=r,h=$r(l);if(h.length>1)throw new Error("Multiple ellipses in slice is not allowed.");if(0!==l&&0!==p)throw new Error("Using both ellipsisMask and newAxisMask is not yet supported.");if(0!==l&&0!==d)throw new Error("Using both ellipsisMask and shrinkAxisMask is not yet supported.");const f=a.shape.length-s.length,m=$r(p),y=a.shape.slice();m.forEach((e=>{s[e]=0,o[e]=1,y.splice(e,0,1)}));const g=$o({inputs:{x:a},attrs:{shape:y},backend:t}),{begin:b,end:w,strides:v}=function(e,t,n,r,a,s,o,i,u){const c=e.length;let l=new Array(c),p=new Array(c),d=new Array(c);if(t.length&&n>0){const u=t[0],c=n+1;l=function(e,t,n,r,a){const s=[...a],o=jr(n,t);for(let a=0;a<s.length;a++)if(o.indexOf(a)>-1)s[a]=0;else{const o=Pr(t,n,a);let i=r[o];e&1<<o&&(i=0),s[a]=i}return s}(o,u,c,r,e),p=function(e,t,n,r,a){const s=[...a],o=jr(n,t);for(let a=0;a<s.length;a++)if(o.indexOf(a)>-1)s[a]=Number.MAX_SAFE_INTEGER;else{const o=Pr(t,n,a);let i=r[o];e&1<<o&&(i=Number.MAX_SAFE_INTEGER),s[a]=i}for(let e=0;e<s.length;e++){const t=a[e];s[e]<0&&(s[e]+=t),s[e]=F(0,s[e],a[e])}return s}(i,u,c,a,e),d=function(e,t,n,r){const a=[...e];for(let e=a.length;e<r.length;e++)a.push(1);for(let e=0;e<n;e++)0===e?a[t]=1:(a.splice(t,0,1),a.pop());return a}(s,u,c,e)}else for(let t=0;t<c;t++)l[t]=Lr(o,r,s,e,t,u),p[t]=qr(i,a,s,e,t,u),d[t]=Br(s,t,u);return{begin:l,end:p,strides:d}}(g.shape,h,f,s,o,i,u,c,l);s=b,o=w,i=v;const x=$r(d);x.forEach((e=>{o[e]=s[e]+1,i[e]=1}));const k=function(e,t,n){const r=[];for(let a=0;a<e.length;a++)r[a]=Math.ceil((t[a]-e[a])/n[a]);return r}(s,o,i),_=k.filter(((e,t)=>-1===x.indexOf(t)));if(i.every((e=>1===e))){const e=qo({inputs:{x:g},attrs:{begin:s,size:k},backend:t});t.disposeData(g.dataId);const n=$o({inputs:{x:e},attrs:{shape:_},backend:t});return t.disposeData(e.dataId),n}const S=t.makeOutput(_,"float32");if(!_.some((e=>0===e))){const e=t.dataIdMap.get(g.dataId).id,n=new Uint8Array(new Int32Array(X(g.shape)).buffer),r=new Uint8Array(new Int32Array(s).buffer),a=new Uint8Array(new Int32Array(o).buffer),u=new Uint8Array(new Int32Array(i).buffer),c=new Uint8Array(new Int32Array(_).buffer),l=new Uint8Array(new Int32Array(X(_)).buffer),p=t.dataIdMap.get(S.dataId).id;Ju(e,n,g.shape.length,r,a,u,c,l,_.length,p)}t.disposeData(g.dataId);const N=$o({inputs:{x:S},attrs:{shape:_},backend:t});return t.disposeData(S.dataId),N}},Xu=bo("Sub",!0);let Zu;const Qu={kernelName:Nt,backendName:"wasm",setupFunc:function(e){Zu=e.wasm.cwrap(Nt,null,["number, number, number"])},kernelFunc:function(e){const{backend:t,inputs:n,attrs:r}=e,{axis:a,keepDims:s}=r,{x:o}=n,i=t.dataIdMap.get(o.dataId).id;let u=i,c=o;const{transposed:l,axes:p,originalAxes:d,inputWasTransposed:h}=Eo(o,a,t);let f=p;if(h){const e=t.dataIdMap.get(l.dataId).id;e!==i&&(c=l,u=e,f=as(f.length,c.shape.length))}ns("sum",f,c.shape.length);const[m,y]=es(c.shape,f),g=L(y),b=t.makeOutput(m,c.dtype);if(0!==L(c.shape)){const e=t.dataIdMap.get(b.dataId).id;Zu(u,g,e)}if(h&&t.disposeData(l.dataId),s){const e=ts(b.shape,d);b.shape=e}return b}},ec=yo("Tan"),tc=yo(Mt);let nc,rc,ac;const sc=[go,wo,xo,Oo,Mo,Ro,Fo,Bo,Vo,Ho,Uo,Go,Yo,Zo,ei,ti,ni,si,ii,ci,pi,di,hi,fi,yi,bi,vi,xi,ki,mo,Si,Ti,Ii,Ai,Ci,Ri,Di,_o,$i,Pi,ji,Bi,Li,zi,Vi,Hi,Ki,Ji,Yi,Qi,eu,tu,au,ou,uu,cu,pu,du,hu,mu,yu,bu,vu,xu,ku,_u,Su,Po,Tu,Iu,Au,Cu,Mu,Du,$u,ju,Bu,zo,qu,zu,Vu,Wu,Hu,Uu,Gu,Yu,Xu,Qu,ec,tc,{kernelName:Ct,backendName:"wasm",setupFunc:function(e){nc=e.wasm.cwrap(Ct,null,["number","array","number","array","number","number"])},kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:a}=t,s=n.dataIdMap.get(a.dataId).id,{reps:o}=r,i=new Array(a.shape.length);for(let e=0;e<i.length;e++)i[e]=a.shape[e]*o[e];const u=new Uint8Array(new Int32Array(a.shape).buffer),c=new Uint8Array(new Int32Array(i).buffer),l=n.makeOutput(i,a.dtype),p=n.dataIdMap.get(l.dataId).id;return nc(s,u,a.shape.length,c,i.length,po[l.dtype],p),l}},{kernelName:Rt,backendName:"wasm",setupFunc:function(e){rc=e.wasm.cwrap(Rt,null,["number","array","number","number","number","bool","number","number"])},kernelFunc:({inputs:e,backend:t,attrs:n})=>{const{x:r}=e,{k:a,sorted:s}=n,o=t.dataIdMap.get(r.dataId).id,i=new Uint8Array(new Int32Array(r.shape).buffer),u=r.shape.slice();u[u.length-1]=a;const c=t.makeOutput(u,r.dtype),l=t.dataIdMap.get(c.dataId).id,p=t.makeOutput(u,"int32"),d=t.dataIdMap.get(p.dataId).id;return rc(o,i,r.shape.length,po[r.dtype],a,s,l,d),[c,p]}},{kernelName:Dt,backendName:"wasm",setupFunc:function(e){ac=e.wasm.cwrap(Dt,null,["number","number","bool","number","number","number","number","number","number","array","number","number","number","number","number"])},kernelFunc:function(e){const{backend:t,inputs:n,attrs:r}=e,{image:a,transforms:s}=n,{interpolation:o,fillMode:i,fillValue:u,outputShape:c}=r,[l,p,d,h]=a.shape,[f,m]=null!=c?c:[p,d],y=[l,f,m,h],g=new Uint8Array(new Int32Array(X(a.shape)).buffer),b=t.makeOutput(y,a.dtype),w=t.dataIdMap.get(b.dataId).id,v=t.dataIdMap.get(a.dataId).id,x=t.dataIdMap.get(s.dataId).id,k="nearest"===o?1:2;let _;switch(i){case"constant":_=1;break;case"reflect":_=2;break;case"wrap":_=3;break;case"nearest":_=4;break;default:_=1}return ac(v,x,s.shape[0]>1,l,f,m,h,d,p,g,a.shape.length-1,k,_,u,w),b}},To,{kernelName:$t,backendName:"wasm",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{value:a}=t;let{axis:s}=r;s<0&&(s+=a.shape.length);const o=a.shape[s],i=a.shape.length,u=new Array(i-1);let c=0;for(let e=0;e<i;e++)e!==s&&(u[c++]=a.shape[e]);const l=new Array(o),p=new Array(i).fill(0),d=a.shape.slice();d[s]=1;for(let e=0;e<l.length;e++)p[s]=e,l[e]=qo({inputs:{x:a},attrs:{begin:p,size:d},backend:n});return l.map((({dataId:e,dtype:t})=>({dataId:e,dtype:t,shape:u})))}},{kernelName:Pt,backendName:"wasm",kernelFunc:function(e){const{inputs:{x:t},backend:n}=e,r=n.makeOutput(t.shape,t.dtype);return n.typedArrayFromHeap(r).fill(0),r}}];for(const e of sc)Jt(e);const oc=ie();oc.registerFlag("WASM_HAS_SIMD_SUPPORT",(async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,9,1,7,0,65,0,253,15,26,11])))),oc.registerFlag("WASM_HAS_MULTITHREAD_SUPPORT",(async()=>{if(oc.get("IS_NODE"))return!1;try{return(new MessageChannel).port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11]))}catch(e){return!1}}));var ic=n(7570),uc=n.n(ic),cc=n(573),lc=n.n(cc);class pc extends R{constructor(e){super(),this.wasm=e,this.dataIdNextNumber=1,this.wasm.tfjs.init(),this.dataIdMap=new C(this,Cn)}write(e,t,n){const r={id:this.dataIdNextNumber++};return this.move(r,e,t,n,1),r}numDataIds(){return this.dataIdMap.numDataIds()}async time(e){const t=tn();return e(),{kernelMs:tn()-t}}move(e,t,n,r,a){const s=this.dataIdNextNumber++;if("string"===r){const o=t;return void this.dataIdMap.set(e,{id:s,stringBytes:o,shape:n,dtype:r,memoryOffset:null,refCount:a})}const o=L(n),i=o*K(r),u=this.wasm._malloc(i);this.dataIdMap.set(e,{id:s,memoryOffset:u,shape:n,dtype:r,refCount:a}),this.wasm.tfjs.registerTensor(s,o,u),null!=t&&this.wasm.HEAPU8.set(new Uint8Array(t.buffer,t.byteOffset,i),u)}async read(e){return this.readSync(e)}readSync(e){const{memoryOffset:t,dtype:n,shape:r,stringBytes:a}=this.dataIdMap.get(e);return"string"===n?a:function(e,t){switch(t){case"float32":return new Float32Array(e);case"int32":return new Int32Array(e);case"bool":return new Uint8Array(e);default:throw new Error(`Unknown dtype ${t}`)}}(this.wasm.HEAPU8.slice(t,t+L(r)*K(n)).buffer,n)}disposeData(e,t=!1){if(this.dataIdMap.has(e)){const n=this.dataIdMap.get(e);if(n.refCount--,!t&&n.refCount>0)return!1;this.wasm._free(n.memoryOffset),this.wasm.tfjs.disposeData(n.id),this.dataIdMap.delete(e)}return!0}refCount(e){return this.dataIdMap.has(e)?this.dataIdMap.get(e).refCount:0}incRef(e){const t=this.dataIdMap.get(e);null!=t&&t.refCount++}floatPrecision(){return 32}getMemoryOffset(e){return this.dataIdMap.get(e).memoryOffset}dispose(){this.wasm.tfjs.dispose(),"PThread"in this.wasm&&this.wasm.PThread.terminateAllThreads(),this.wasm=null}memory(){return{unreliable:!1}}makeOutput(e,t,n){let r;if(null==n)r=this.write(null,e,t);else{const a=this.dataIdNextNumber++;r={id:a},this.dataIdMap.set(r,{id:a,memoryOffset:n,shape:e,dtype:t,refCount:1});const s=L(e);this.wasm.tfjs.registerTensor(a,s,n)}return{dataId:r,shape:e,dtype:t}}typedArrayFromHeap({shape:e,dtype:t,dataId:n}){const r=this.wasm.HEAPU8.buffer,{memoryOffset:a}=this.dataIdMap.get(n),s=L(e);switch(t){case"float32":return new Float32Array(r,a,s);case"int32":return new Int32Array(r,a,s);case"bool":return new Uint8Array(r,a,s);default:throw new Error(`Unknown dtype ${t}`)}}}function dc(e,t,n){if(null!=fc)return fc;let r="tfjs-backend-wasm.wasm";return e&&t?r="tfjs-backend-wasm-threaded-simd.wasm":e&&(r="tfjs-backend-wasm-simd.wasm"),null!=yc&&null!=yc[r]?yc[r]:n+r}const hc=["tfjs-backend-wasm.wasm","tfjs-backend-wasm-simd.wasm","tfjs-backend-wasm-threaded-simd.wasm"];let fc=null,mc=null,yc={},gc=!1,bc=!1;var wc,vc;!function(e,t,n=1){Cn.registerBackend(e,t,n)}("wasm",(async()=>{const{wasm:e}=await async function(){const[e,t]=await Promise.all([ie().getAsync("WASM_HAS_SIMD_SUPPORT"),ie().getAsync("WASM_HAS_MULTITHREAD_SUPPORT")]);return new Promise(((n,r)=>{const a={locateFile:(n,r)=>{if(n.endsWith(".worker.js")){const e=new Blob(['var Module={};function threadPrintErr(){var text=Array.prototype.slice.call(arguments).join(" ");console.error(text)}function threadAlert(){var text=Array.prototype.slice.call(arguments).join(" ");postMessage({cmd:"alert",text:text,threadId:Module["_pthread_self"]()})}var err=threadPrintErr;this.alert=threadAlert;Module["instantiateWasm"]=function(info,receiveInstance){var instance=new WebAssembly.Instance(Module["wasmModule"],info);Module["wasmModule"]=null;receiveInstance(instance);return instance.exports};function moduleLoaded(){}this.onmessage=function(e){try{if(e.data.cmd==="load"){Module["wasmModule"]=e.data.wasmModule;Module["wasmMemory"]=e.data.wasmMemory;Module["buffer"]=Module["wasmMemory"].buffer;Module["ENVIRONMENT_IS_PTHREAD"]=true;if(typeof e.data.urlOrBlob==="string"){importScripts(e.data.urlOrBlob)}else{var objectUrl=URL.createObjectURL(e.data.urlOrBlob);importScripts(objectUrl);URL.revokeObjectURL(objectUrl)}WasmBackendModuleThreadedSimd(Module).then(function(instance){Module=instance;moduleLoaded()})}else if(e.data.cmd==="objectTransfer"){Module["PThread"].receiveObjectTransfer(e.data)}else if(e.data.cmd==="run"){Module["__performance_now_clock_drift"]=performance.now()-e.data.time;Module["__emscripten_thread_init"](e.data.threadInfoStruct,0,0);var max=e.data.stackBase;var top=e.data.stackBase+e.data.stackSize;Module["establishStackSpace"](top,max);Module["_emscripten_tls_init"]();Module["PThread"].receiveObjectTransfer(e.data);Module["PThread"].setThreadStatus(Module["_pthread_self"](),1);try{var result=Module["invokeEntryPoint"](e.data.start_routine,e.data.arg);if(!Module["getNoExitRuntime"]())Module["PThread"].threadExit(result)}catch(ex){if(ex==="Canceled!"){Module["PThread"].threadCancel()}else if(ex!="unwind"){if(ex instanceof Module["ExitStatus"]){if(Module["getNoExitRuntime"]()){}else{Module["PThread"].threadExit(ex.status)}}else{Module["PThread"].threadExit(-2);throw ex}}}}else if(e.data.cmd==="cancel"){if(Module["_pthread_self"]()){Module["PThread"].threadCancel()}}else if(e.data.target==="setimmediate"){}else if(e.data.cmd==="processThreadQueue"){if(Module["_pthread_self"]()){Module["_emscripten_current_thread_process_queued_calls"]()}}else{err("worker.js received unknown command "+e.data.cmd);err(e.data)}}catch(ex){err("worker.js onmessage() captured an uncaught exception: "+ex);if(ex&&ex.stack)err(ex.stack);throw ex}};if(typeof process==="object"&&typeof process.versions==="object"&&typeof process.versions.node==="string"){self={location:{href:__filename}};var onmessage=this.onmessage;var nodeWorkerThreads=require("worker_threads");global.Worker=nodeWorkerThreads.Worker;var parentPort=nodeWorkerThreads.parentPort;parentPort.on("message",function(data){onmessage({data:data})});var nodeFS=require("fs");var nodeRead=function(filename){return nodeFS.readFileSync(filename,"utf8")};function globalEval(x){global.require=require;global.Module=Module;eval.call(null,x)}importScripts=function(f){globalEval(nodeRead(f))};postMessage=function(msg){parentPort.postMessage(msg)};if(typeof performance==="undefined"){performance={now:function(){return Date.now()}}}}'],{type:"application/javascript"});return URL.createObjectURL(e)}return n.endsWith(".wasm")?dc(e,t,null!=mc?mc:r):r+n}};var s;bc&&(a.instantiateWasm=(s=dc(e,t,null!=mc?mc:""),(e,t)=>(function(e,t){return ie().platform.fetch(e,{credentials:"same-origin"})}(s).then((n=>{n.ok||e.env.a(`failed to load wasm binary file at '${s}'`),n.arrayBuffer().then((n=>{WebAssembly.instantiate(n,e).then((e=>{t(e.instance,e.module)}))}))})),{})));let o,i=!1;a.onAbort=()=>{i||gc||(gc=!0,r({message:"Make sure the server can serve the `.wasm` file relative to the bundled js file. For more details see https://github.com/tensorflow/tfjs/blob/master/tfjs-backend-wasm/README.md#using-bundlers"}))},t&&e&&null==fc?(a.mainScriptUrlOrBlob=new Blob(["var WasmBackendModuleThreadedSimd = "+uc().toString()],{type:"text/javascript"}),o=uc()(a)):o=lc()(a),o.then((e=>{i=!0,gc=!1,e.tfjs={init:e.cwrap("init",null,[]),registerTensor:e.cwrap("register_tensor",null,["number","number","number"]),disposeData:e.cwrap("dispose_data",null,["number"]),dispose:e.cwrap("dispose",null,[])},n({wasm:e})}))}))}();return new pc(e)}),2),function(e){e[e.DT_INVALID=0]="DT_INVALID",e[e.DT_FLOAT=1]="DT_FLOAT",e[e.DT_DOUBLE=2]="DT_DOUBLE",e[e.DT_INT32=3]="DT_INT32",e[e.DT_UINT8=4]="DT_UINT8",e[e.DT_INT16=5]="DT_INT16",e[e.DT_INT8=6]="DT_INT8",e[e.DT_STRING=7]="DT_STRING",e[e.DT_COMPLEX64=8]="DT_COMPLEX64",e[e.DT_INT64=9]="DT_INT64",e[e.DT_BOOL=10]="DT_BOOL",e[e.DT_QINT8=11]="DT_QINT8",e[e.DT_QUINT8=12]="DT_QUINT8",e[e.DT_QINT32=13]="DT_QINT32",e[e.DT_BFLOAT16=14]="DT_BFLOAT16",e[e.DT_FLOAT_REF=101]="DT_FLOAT_REF",e[e.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",e[e.DT_INT32_REF=103]="DT_INT32_REF",e[e.DT_UINT8_REF=104]="DT_UINT8_REF",e[e.DT_INT16_REF=105]="DT_INT16_REF",e[e.DT_INT8_REF=106]="DT_INT8_REF",e[e.DT_STRING_REF=107]="DT_STRING_REF",e[e.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",e[e.DT_INT64_REF=109]="DT_INT64_REF",e[e.DT_BOOL_REF=110]="DT_BOOL_REF",e[e.DT_QINT8_REF=111]="DT_QINT8_REF",e[e.DT_QUINT8_REF=112]="DT_QUINT8_REF",e[e.DT_QINT32_REF=113]="DT_QINT32_REF",e[e.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF"}(wc||(wc={})),function(e){let t;!function(e){e[e.LEGACY=0]="LEGACY",e[e.V1=1]="V1",e[e.V2=2]="V2"}(t=e.CheckpointFormatVersion||(e.CheckpointFormatVersion={}))}(vc||(vc={}));const xc={};function kc(e){return xc[e]}function _c(e,t,n,r,a){const s=t.inputParams[e];if(s&&void 0!==s.inputIndexStart){const e=s.inputIndexStart,o=0===s.inputIndexEnd?void 0:void 0===s.inputIndexEnd?e+1:s.inputIndexEnd;if("tensor"===s.type)return Sc(t.inputNames[s.inputIndexStart],n,r,a);if("tensors"===s.type)return t.inputNames.slice(e,o).map((e=>Sc(e,n,r,a)));const i=Sc(t.inputNames.slice(e)[0],n,r,a),u=i.dataSync();return"number"===s.type?u[0]:Q(i.shape,u)}const o=t.attrParams[e];return o&&o.value}function Sc(e,t,n,r){const[a,s]=Ec(e);if(null!=r){const e=r.getHashTableHandleByName(a);if(null!=e)return e}const o=n.currentContextIds.find((e=>!!t[Tc(a,e)]));return void 0!==o?t[Tc(a,o)][s]:void 0}function Nc(e,t){const[n,r,a]=Ec(e);return[Tc(n,t&&t.currentContextId),r,a]}function Tc(e,t){return t?`${e}-${t}`:e}function Ec(e){const t=e.split(":");if(1===t.length)return[e,0,void 0];const n=t[0],r=3===t.length?t[1]:void 0;return[n,Number(t[t.length-1]),r]}function Ic(e,t,n){let r=_c("pad",e,t,n);if("explicit"===r){r=_c("explicitPaddings",e,t,n);const a=[[0,0],[0,0],[0,0],[0,0]];for(let e=0;e<4;e++)a[e][0]=r[2*e],a[e][1]=r[2*e+1];return a}return r}function Oc(e){return e.kept?e:Sr(e)}const Ac=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],Mc=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"clipValueMin",type:"number"},{start:2,name:"clipValueMax",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Prod",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axes",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsNan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],Cc=[{tfOpName:"EmptyTensorList",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"maxNumElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"}]},{tfOpName:"StatelessIf",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"If",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"StatelessWhile",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"While",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"TensorListScatter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListScatterV2",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"},{start:3,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGather",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListSetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListReserve",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListFromTensor",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListStack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"},{tfName:"num_elements",name:"numElements",type:"dtype"}]},{tfOpName:"TensorListSplit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"},{start:2,name:"lengths",type:"number[]"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcat",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPopBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPushBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]}],Rc=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[],notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number"}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"Dilation2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"rates",name:"dilations",type:"number[]"},{tfName:"padding",name:"pad",type:"string"}]}],Dc=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}],Fc=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV4",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"T_threshold",name:"threshold",type:"dtype",notSupported:!0},{tfName:"pad_to_max_output_size",name:"padToMaxOutputSize",type:"bool"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],$c=[{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]},{tfOpName:"Unique",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"UniqueV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]}],Pc=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}],jc=[{tfOpName:"HashTable",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"HashTableV2",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"LookupTableImport",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableImportV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFind",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFindV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableSize",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"LookupTableSizeV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]}],Bc=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]}],Lc=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],qc=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Einsum",category:"matrices",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"equation",name:"equation",type:"string"},{tfName:"N",name:"n",type:"number",defaultValue:2},{tfName:"T",name:"dtype",type:"dtype"}]}],zc=[{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"SparseToDense",category:"normalization",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!0,notSupported:!0}]}],Vc=[{tfOpName:"Bincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}]},{tfOpName:"DenseBincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}],attrs:[{tfName:"binary_output",name:"binaryOutput",type:"bool"}]},{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Cumsum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]}],Wc=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}],attrs:[{tfName:"batch_dims",name:"batchDims",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool[]"}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]}],Hc=[{tfOpName:"SparseFillEmptyRows",category:"sparse",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"denseShape",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}]},{tfOpName:"SparseReshape",category:"sparse",inputs:[{start:0,name:"inputIndices",type:"tensor"},{start:1,name:"inputShape",type:"tensor"},{start:2,name:"newShape",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SparseSegmentMean",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]},{tfOpName:"SparseSegmentSum",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]}],Uc=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}],Kc=[{tfOpName:"StringNGrams",category:"string",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"dataSplits",type:"tensor"}],attrs:[{tfName:"separator",name:"separator",type:"string"},{tfName:"ngram_widths",name:"nGramWidths",type:"number[]"},{tfName:"left_pad",name:"leftPad",type:"string"},{tfName:"right_pad",name:"rightPad",type:"string"},{tfName:"pad_width",name:"padWidth",type:"number"},{tfName:"preserve_short_sequences",name:"preserveShortSequences",type:"bool"}],outputs:["ngrams","ngrams_splits"]},{tfOpName:"StringSplit",category:"string",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"delimiter",type:"tensor"}],attrs:[{tfName:"skip_empty",name:"skipEmpty",type:"bool"}],outputs:["indices","values","shape"]},{tfOpName:"StringToHashBucketFast",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"num_buckets",name:"numBuckets",type:"number"}]}],Gc=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"MirrorPad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"mode",name:"mode",type:"string"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]},{tfOpName:"BroadcastTo",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}],attrs:[]},{tfOpName:"BroadcastArgs",category:"transformation",inputs:[{start:0,name:"s0",type:"tensor"},{start:1,name:"s1",type:"tensor"}],attrs:[]}];class Jc{static get Instance(){return this._instance||(this._instance=new this)}constructor(){const e=[].concat(...[r,a,s,o,i,u,c,l,p,d,h,f,m,y,g,b,w,v,x].map((e=>e.json)));this.opMappers=e.reduce(((e,t)=>(e[t.tfOpName]=t,e)),{})}transformGraph(e,t={}){const n=e.node,r=[],a=[],s=[],o=n.reduce(((e,t)=>(e[t.name]=this.mapNode(t),t.op.startsWith("Placeholder")?r.push(e[t.name]):"Const"===t.op?a.push(e[t.name]):null!=t.input&&0!==t.input.length||s.push(e[t.name]),e)),{});let i=[];const u=[];let c={},l={};null!=t&&(c=this.mapSignatureEntries(t.inputs),l=this.mapSignatureEntries(t.outputs));const p=Object.keys(o);p.forEach((e=>{const t=o[e];t.inputNames.forEach(((e,n)=>{const[r,,a]=Nc(e),s=o[r];if(null!=s.outputs){const e=s.outputs.indexOf(a);if(-1!==e){const a=`${r}:${e}`;t.inputNames[n]=a}}t.inputs.push(s),s.children.push(t)}))})),0===Object.keys(l).length?p.forEach((e=>{const t=o[e];0===t.children.length&&u.push(t)})):Object.keys(l).forEach((e=>{const[t]=Nc(e),n=o[t];null!=n&&(n.signatureKey=l[e],u.push(n))})),Object.keys(c).length>0?Object.keys(c).forEach((e=>{const[t]=Nc(e),n=o[t];n&&(n.signatureKey=c[e],i.push(n))})):i=r;let d={};null!=e.library&&null!=e.library.function&&(d=e.library.function.reduce(((e,t)=>(e[t.signature.name]=this.mapFunction(t),e)),{}));const h={nodes:o,inputs:i,outputs:u,weights:a,placeholders:r,signature:t,functions:d};return s.length>0&&(h.initNodes=s),h}mapSignatureEntries(e){return Object.keys(e||{}).reduce(((t,n)=>(t[e[n].name]=n,t)),{})}mapNode(e){const t=kc(e.op)||this.opMappers[e.op]||{};null==e.attr&&(e.attr={});const n={name:e.name,op:e.op,category:t.category,inputNames:(e.input||[]).map((e=>e.startsWith("^")?e.substr(1):e)),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:e.attr,outputs:t.outputs};return null!=t.inputs&&(n.inputParams=t.inputs.reduce(((e,t)=>(e[t.name]={type:t.type,inputIndexStart:t.start,inputIndexEnd:t.end},e)),{})),null!=t.attrs&&(n.attrParams=t.attrs.reduce(((t,n)=>{const r=n.type;let a;switch(n.type){case"string":a=Xc(e.attr,n.tfName,n.defaultValue),void 0===a&&n.tfDeprecatedName&&(a=Xc(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"string[]":a=il(e.attr,n.tfName,n.defaultValue),void 0===a&&n.tfDeprecatedName&&(a=il(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"number":a=Qc(e.attr,n.tfName,n.defaultValue||0),void 0===a&&n.tfDeprecatedName&&(a=Qc(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"number[]":a=ol(e.attr,n.tfName,n.defaultValue),void 0===a&&n.tfDeprecatedName&&(a=ol(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"bool":a=Zc(e.attr,n.tfName,n.defaultValue),void 0===a&&n.tfDeprecatedName&&(a=Zc(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"bool[]":a=cl(e.attr,n.tfName,n.defaultValue),void 0===a&&n.tfDeprecatedName&&(a=cl(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"shape":a=sl(e.attr,n.tfName,n.defaultValue),void 0===a&&n.tfDeprecatedName&&(a=sl(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"shape[]":a=ul(e.attr,n.tfName,n.defaultValue),void 0===a&&n.tfDeprecatedName&&(a=ul(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"dtype":a=nl(e.attr,n.tfName,n.defaultValue),void 0===a&&n.tfDeprecatedName&&(a=nl(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"dtype[]":a=rl(e.attr,n.tfName,n.defaultValue),void 0===a&&n.tfDeprecatedName&&(a=rl(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"func":a=tl(e.attr,n.tfName,n.defaultValue),void 0===a&&n.tfDeprecatedName&&(a=tl(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error(`Unsupported param type: ${n.type} for op: ${e.op}`)}return t[n.name]={value:a,type:r},t}),{})),n}mapFunction(e){const t=e.nodeDef,n=[];let r={};null!=t&&(r=t.reduce(((e,t)=>(e[t.name]=this.mapNode(t),"Const"===t.op&&n.push(e[t.name]),e)),{}));const a=[],s=[];e.signature.inputArg.forEach((e=>{const[t]=Nc(e.name),n={name:t,op:"Placeholder",inputs:[],inputNames:[],category:"graph",inputParams:{},attrParams:{dtype:{value:el(e.type),type:"dtype"}},children:[]};n.signatureKey=e.name,a.push(n),r[t]=n})),Object.keys(r).forEach((e=>{const t=r[e];t.inputNames.forEach(((e,n)=>{const[a,,s]=Nc(e),o=r[a];if(null!=o.outputs){const e=o.outputs.indexOf(s);if(-1!==e){const r=`${a}:${e}`;t.inputNames[n]=r}}t.inputs.push(o),o.children.push(t)}))}));const o=e.ret;e.signature.outputArg.forEach((e=>{const[t,n]=Nc(o[e.name]),a=r[t];null!=a&&(a.defaultOutput=n,s.push(a))}));const i=this.mapArgsToSignature(e);return{nodes:r,inputs:a,outputs:s,weights:n,placeholders:[],signature:i}}mapArgsToSignature(e){return{methodName:e.signature.name,inputs:e.signature.inputArg.reduce(((e,t)=>(e[t.name]=this.mapArgToTensorInfo(t),e)),{}),outputs:e.signature.outputArg.reduce(((t,n)=>(t[n.name]=this.mapArgToTensorInfo(n,e.ret),t)),{})}}mapArgToTensorInfo(e,t){let n=e.name;return null!=t&&(n=t[n]),{name:n,dtype:e.type}}}function Yc(e,t){const n=Array.isArray(e)?String.fromCharCode.apply(null,e):function(e){const t=ie().global;if(void 0!==t.atob)return t.atob(e);if("undefined"!=typeof Buffer)return new Buffer(e,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}(e);return t?n:n.toLowerCase()}function Xc(e,t,n,r=!1){const a=e[t];return null!=a?Yc(a.s,r):n}function Zc(e,t,n){const r=e[t];return r?r.b:n}function Qc(e,t,n){const r=e[t]||{},a=null!=r.i?r.i:null!=r.f?r.f:n;return"number"==typeof a?a:parseInt(a,10)}function el(e){switch("string"==typeof e&&(e=wc[e]),e){case wc.DT_FLOAT:return"float32";case wc.DT_INT32:case wc.DT_INT64:case wc.DT_INT8:case wc.DT_UINT8:return"int32";case wc.DT_BOOL:return"bool";case wc.DT_DOUBLE:return"float32";case wc.DT_STRING:return"string";default:return null}}function tl(e,t,n){const r=e[t];return r&&r.func?r.func.name:n}function nl(e,t,n){const r=e[t];return r&&r.type?el(r.type):n}function rl(e,t,n){const r=e[t];return r&&r.list&&r.list.type?r.list.type.map((e=>el(e))):n}function al(e){if(!e.unknownRank)return null!=e.dim?e.dim.map((e=>"number"==typeof e.size?e.size:parseInt(e.size,10))):[]}function sl(e,t,n){const r=e[t];return r&&r.shape?al(r.shape):n}function ol(e,t,n){const r=e[t];return r?((r.list.f&&r.list.f.length?r.list.f:r.list.i)||[]).map((e=>"number"==typeof e?e:parseInt(e,10))):n}function il(e,t,n,r=!1){const a=e[t];return a&&a.list&&a.list.s?a.list.s.map((e=>Yc(e,r))):n}function ul(e,t,n){const r=e[t];return r&&r.list&&r.list.shape?r.list.shape.map((e=>al(e))):n}function cl(e,t,n){const r=e[t];return r&&r.list&&r.list.b?r.list.b:n}class ll{constructor(e,t,n){this.node=e,this.tensorMap=t,this.context=n,this.inputs=[],this.attrs={},this.inputs=e.inputNames.map((e=>this.getInput(e))),null!=e.rawAttrs&&(this.attrs=Object.keys(e.rawAttrs).reduce(((e,t)=>(e[t]=this.getAttr(t),e)),{}))}getInput(e){return Sc(e,this.tensorMap,this.context)}getAttr(e,t){const n=this.node.rawAttrs[e];if(null!=n.tensor)return Sc(e,this.tensorMap,this.context);if(null!=n.i||null!=n.f)return Qc(this.node.rawAttrs,e,t);if(null!=n.s)return Xc(this.node.rawAttrs,e,t);if(null!=n.b)return Zc(this.node.rawAttrs,e,t);if(null!=n.shape)return sl(this.node.rawAttrs,e,t);if(null!=n.type)return nl(this.node.rawAttrs,e,t);if(null!=n.list){if(null!=n.list.i||null!=n.list.f)return ol(this.node.rawAttrs,e,t);if(null!=n.list.s)return il(this.node.rawAttrs,e,t);if(null!=n.list.shape)return ul(this.node.rawAttrs,e,t);if(null!=n.list.b)return cl(this.node.rawAttrs,e,t);if(null!=n.list.type)return rl(this.node.rawAttrs,e,t)}return t}}const pl=Ln({addN_:function(e){$(Array.isArray(e),(()=>"The argument passed to tf.addN() must be a list of tensors")),$(e.length>=1,(()=>`Must pass at least one tensor to tf.addN(), but got ${e.length}`));const t=e.map(((e,t)=>jn(e,`tensors${t}`,"addN"))),n=t[0];t.forEach((e=>{if(e.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")})),t.forEach((e=>{if(!q(e.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")}));const r=t;return Cn.runKernel(he,r)}}),dl=Ln({mod_:function(e,t){let n=jn(e,"a","mod"),r=jn(t,"b","mod");[n,r]=Nn(n,r);const a={a:n,b:r};return Cn.runKernel("Mod",a)}}),hl=Ln({equal_:function(e,t){let n=jn(e,"a","equal","string_or_numeric"),r=jn(t,"b","equal","string_or_numeric");[n,r]=Nn(n,r),La(n.shape,r.shape);const a={a:n,b:r};return Cn.runKernel(Ce,a)}}),fl=Ln({divNoNan_:function(e,t){let n=jn(e,"a","div"),r=jn(t,"b","div");[n,r]=Nn(n,r);const a=Gr(n,r),s=pa(a),o=hl(r,s);return Ua(o,s,a)}}),ml=Ln({maximum_:function(e,t){let n=jn(e,"a","maximum"),r=jn(t,"b","maximum");[n,r]=Nn(n,r),"bool"===n.dtype&&(n=_r(n,"int32"),r=_r(r,"int32")),La(n.shape,r.shape);const a={a:n,b:r};return Cn.runKernel(Je,a)}}),yl=Ln({acos_:function(e){const t={x:jn(e,"x","acos")};return Cn.runKernel("Acos",t)}}),gl=Ln({acosh_:function(e){const t={x:jn(e,"x","acosh")};return Cn.runKernel("Acosh",t)}}),bl=Ln({asin_:function(e){const t={x:jn(e,"x","asin")};return Cn.runKernel("Asin",t)}}),wl=Ln({asinh_:function(e){const t={x:jn(e,"x","asinh")};return Cn.runKernel("Asinh",t)}}),vl=Ln({atan_:function(e){const t={x:jn(e,"x","atan")};return Cn.runKernel("Atan",t)}}),xl=Ln({atan2_:function(e,t){let n=jn(e,"a","atan2"),r=jn(t,"b","atan2");[n,r]=Nn(n,r);const a={a:n,b:r};return Cn.runKernel("Atan2",a)}}),kl=Ln({atanh_:function(e){const t={x:jn(e,"x","atanh")};return Cn.runKernel("Atanh",t)}}),_l=Ln({ceil_:function(e){const t={x:jn(e,"x","ceil")};return Cn.runKernel(xe,t)}}),Sl=Ln({cos_:function(e){const t={x:jn(e,"x","cos")};return Cn.runKernel("Cos",t)}}),Nl=Ln({cosh_:function(e){const t={x:jn(e,"x","cosh")};return Cn.runKernel(Te,t)}}),Tl=Ln({erf_:function(e){let t=jn(e,"x","erf");$("int32"===t.dtype||"float32"===t.dtype,(()=>"Input dtype must be `int32` or `float32`.")),"int32"===t.dtype&&(t=_r(t,"float32"));const n={x:t};return Cn.runKernel("Erf",n)}}),El=Ln({expm1_:function(e){const t={x:jn(e,"x","expm1")};return Cn.runKernel("Expm1",t)}}),Il=Ln({floor_:function(e){const t={x:jn(e,"x","floor")};return Cn.runKernel($e,t)}}),Ol=Ln({reciprocal_:function(e){const t={x:jn(e,"x","reciprocal")};return Cn.runKernel("Reciprocal",t)}}),Al=Ln({selu_:function(e){const t={x:jn(e,"x","selu")};return Cn.runKernel("Selu",t)}}),Ml=Ln({sin_:function(e){const t={x:jn(e,"x","sin")};return Cn.runKernel("Sin",t)}}),Cl=Ln({sign_:function(e){const t={x:jn(e,"x","sign")};return Cn.runKernel("Sign",t)}}),Rl=Ln({sinh_:function(e){const t={x:jn(e,"x","sinh")};return Cn.runKernel("Sinh",t)}}),Dl=Ln({softplus_:function(e){const t={x:jn(e,"x","softplus")};return Cn.runKernel("Softplus",t)}}),Fl=Ln({tanh_:function(e){const t={x:jn(e,"x","tanh")};return Cn.runKernel(Mt,t)}}),$l=Ln({tan_:function(e){const t={x:jn(e,"x","tan")};return Cn.runKernel("Tan",t)}}),Pl=Ln({clipByValue_:function(e,t,n){const r=jn(e,"x","clipByValue");$(t<=n,(()=>`Error in clip: min (${t}) must be less than or equal to max (${n}).`));const a={x:r},s={clipValueMin:t,clipValueMax:n};return Cn.runKernel(ke,a,s)}}),jl=Ln({rsqrt_:function(e){const t={x:jn(e,"x","rsqrt")};return Cn.runKernel(wt,t)}}),Bl=Ln({prod_:function(e,t=null,n=!1){let r=jn(e,"x","prod");"bool"===r.dtype&&(r=_r(r,"int32"));const a={x:r},s={axis:t,keepDims:n};return Cn.runKernel(pt,a,s)}}),Ll=Ln({isNaN_:function(e){const t={x:jn(e,"x","isNaN")};return Cn.runKernel("IsNan",t)}});function ql(e,t,n=""){if("number"!=typeof e&&"number"!=typeof t){$(e.length===t.length,(()=>n+` Shapes ${e} and ${t} must match`));for(let r=0;r<e.length;r++){const a=e[r],s=t[r];$(a<0||s<0||a===s,(()=>n+` Shapes ${e} and ${t} must match`))}}}function zl(e){return"number"!=typeof e&&!e.some((e=>e<0))}function Vl(e,t,n){let r=Wl(e,n);const a=!zl(r);if(a&&0===t.length)throw new Error(`Tried to calculate elements of an empty list with non-fully-defined elementShape: ${r}`);if(a&&t.forEach((e=>{r=Wl(e.shape,r)})),!zl(r))throw new Error(`Non-fully-defined elementShape: ${r}`);return r}function Wl(e,t){if("number"==typeof e)return t;if("number"==typeof t)return e;if(e.length!==t.length)throw new Error(`Incompatible ranks during merge: ${e} vs. ${t}`);const n=[];for(let r=0;r<e.length;++r){const a=e[r],s=t[r];if(a>=0&&s>=0&&a!==s)throw new Error(`Incompatible shape during merge: ${e} vs. ${t}`);n[r]=a>=0?a:s}return n}class Hl{constructor(e,t,n,r,a,s,o){this.name=e,this.dtype=t,this.maxSize=n,this.elementShape=r,this.identicalElementShapes=a,this.dynamicSize=s,this.clearAfterRead=o,this.tensors=[],this.closed_=!1,this.idTensor=Zr(0),hs(this.idTensor)}get id(){return this.idTensor.id}get closed(){return this.closed_}clearAndClose(e){this.tensors.forEach((t=>{null!=e&&e.has(t.tensor.id)||t.tensor.dispose()})),this.tensors=[],this.closed_=!0,this.idTensor.dispose()}size(){return this.tensors.length}read(e){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(e<0||e>=this.size())throw new Error(`Tried to read from index ${e}, but array size is: ${this.size()}`);const t=this.tensors[e];if(t.cleared)throw new Error(`TensorArray ${this.name}: Could not read index ${e} twice because it was cleared after a previous read (perhaps try setting clear_after_read = false?).`);return this.clearAfterRead&&(t.cleared=!0),t.read=!0,t.tensor}readMany(e){return e.map((e=>this.read(e)))}write(e,t){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(e<0||!this.dynamicSize&&e>=this.maxSize)throw new Error(`Tried to write to index ${e}, but array is not resizeable and size is: ${this.maxSize}`);const n=this.tensors[e]||{};if(t.dtype!==this.dtype)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e},\n          because the value dtype is ${t.dtype}, but TensorArray dtype is ${this.dtype}.`);if(0!==this.size()||null!=this.elementShape&&0!==this.elementShape.length||(this.elementShape=t.shape),ql(this.elementShape,t.shape,`TensorArray ${this.name}: Could not write to TensorArray index ${e}.`),n.read)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e}, because it has already been read.`);if(n.written)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e}, because it has already been written.`);n.tensor=t,hs(t),n.written=!0,this.tensors[e]=n}writeMany(e,t){if(e.length!==t.length)throw new Error(`TensorArray ${this.name}: could not write multiple tensors,because the index size: ${e.length} is not the same as tensors size: ${t.length}.`);e.forEach(((e,n)=>this.write(e,t[n])))}gather(e,t){if(t&&t!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but gather requested dtype ${t}`);if(e)e=e.slice(0,this.size());else{e=[];for(let t=0;t<this.size();t++)e.push(t)}if(0===e.length)return Vn([],[0].concat(this.elementShape));const n=this.readMany(e);return ql(this.elementShape,n[0].shape,"TensorArray shape mismatch: "),na(n,0)}concat(e){if(e&&e!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but concat requested dtype ${e}`);if(0===this.size())return Vn([],[0].concat(this.elementShape));const t=[];for(let e=0;e<this.size();e++)t.push(e);const n=this.readMany(t);return ql(this.elementShape,n[0].shape,`TensorArray shape mismatch: tensor array shape (${this.elementShape}) vs first tensor shape (${n[0].shape})`),Hr(n,0)}scatter(e,t){if(t.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${t.dtype}`);if(e.length!==t.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${e.length} vs. ${t.shape[0]}`);const n=Math.max(...e);if(!this.dynamicSize&&n>=this.maxSize)throw new Error(`Max index must be < array size (${n}  vs. ${this.maxSize})`);this.writeMany(e,oa(t,0))}split(e,t){if(t.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${t.dtype}`);let n=0;const r=e.map((e=>(n+=e,n)));if(n!==t.shape[0])throw new Error(`Expected sum of lengths to be equal to\n          tensor.shape[0], but sum of lengths is\n        ${n}, and tensor's shape is: ${t.shape}`);if(!this.dynamicSize&&e.length!==this.maxSize)throw new Error(`TensorArray's size is not equal to the size of lengths (${this.maxSize} vs. ${e.length}), and the TensorArray is not marked as dynamically resizeable`);const a=0===n?0:t.size/n,s=[];ds((()=>{t=Xr(t,[1,n,a]);for(let n=0;n<e.length;++n){const o=[0,0===n?0:r[n-1],0],i=[1,e[n],a];s[n]=Xr(ea(t,o,i),this.elementShape)}return s}));const o=[];for(let t=0;t<e.length;t++)o[t]=t;this.writeMany(o,s)}}class Ul{constructor(e,t,n,r=-1){this.tensors=e,this.elementShape=t,this.elementDtype=n,null!=e&&e.forEach((e=>{if(n!==e.dtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${e.dtype}`);ql(t,e.shape,"TensorList shape mismatch: "),hs(e)})),this.idTensor=Zr(0),this.maxNumElements=r,hs(this.idTensor)}get id(){return this.idTensor.id}copy(){return new Ul([...this.tensors],this.elementShape,this.elementDtype)}clearAndClose(e){this.tensors.forEach((t=>{null!=e&&e.has(t.id)||t.dispose()})),this.tensors.length=0,this.idTensor.dispose()}size(){return this.tensors.length}stack(e,t,n=-1){if(t!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t}, but list elements ${this.elementDtype}`);if(-1!==n&&this.tensors.length!==n)throw new Error(`Operation expected a list with ${n} elements but got a list with ${this.tensors.length} elements.`);ql(e,this.elementShape,"TensorList shape mismatch: ");const r=Vl(this.elementShape,this.tensors,e);return ds((()=>{const e=this.tensors.map((e=>Xr(e,r)));return na(e,0)}))}popBack(e,t){if(t!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t}, but list elements ${this.elementDtype}`);if(0===this.size())throw new Error("Trying to pop from an empty list.");const n=Vl(this.elementShape,this.tensors,e),r=this.tensors.pop();return ql(r.shape,e,"TensorList shape mismatch: "),Xr(r,n)}pushBack(e){if(e.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${e.dtype}, but list elements ${this.elementDtype}`);if(ql(e.shape,this.elementShape,"TensorList shape mismatch: "),this.maxNumElements===this.size())throw new Error("Trying to push element into a full list.");hs(e),this.tensors.push(e)}resize(e){if(e<0)throw new Error(`TensorListResize expects size to be non-negative. Got: ${e}`);if(-1!==this.maxNumElements&&e>this.maxNumElements)throw new Error(`TensorListResize input size ${e} is greater maxNumElement ${this.maxNumElements}.`);this.tensors.length=e}getItem(e,t,n){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);if(e<0||e>this.tensors.length)throw new Error(`Trying to access element ${e} in a list with ${this.tensors.length} elements.`);if(null==this.tensors[e])throw new Error(`element at index ${e} is null.`);ql(this.tensors[e].shape,t,"TensorList shape mismatch: ");const r=Vl(this.elementShape,this.tensors,t);return Xr(this.tensors[e],r)}setItem(e,t){if(t.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t.dtype}, but list elements ${this.elementDtype}`);if(e<0||-1!==this.maxNumElements&&e>=this.maxNumElements)throw new Error(`Trying to set element ${e} in a list with max ${this.maxNumElements} elements.`);ql(this.elementShape,t.shape,"TensorList shape mismatch: "),hs(t),this.tensors[e]=t}gather(e,t,n){if(t!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t}, but list elements ${this.elementDtype}`);ql(this.elementShape,n,"TensorList shape mismatch: "),e=e.slice(0,this.size());const r=Vl(this.elementShape,this.tensors,n);return 0===e.length?Vn([],[0].concat(r)):ds((()=>{const t=e.map((e=>Xr(this.tensors[e],r)));return na(t,0)}))}concat(e,t){if(e&&e!==this.elementDtype)throw new Error(`TensorList dtype is ${this.elementDtype} but concat requested dtype ${e}`);ql(this.elementShape,t,"TensorList shape mismatch: ");const n=Vl(this.elementShape,this.tensors,t);return 0===this.size()?Vn([],[0].concat(n)):ds((()=>{const e=this.tensors.map((e=>Xr(e,n)));return Hr(e,0)}))}}const Kl=Ln({conv2d_:function(e,t,n,r,a="NHWC",s=[1,1],o){const i=jn(e,"x","conv2d"),u=jn(t,"filter","conv2d");let c=i,l=!1;3===i.rank&&(l=!0,c=Xr(i,[1,i.shape[0],i.shape[1],i.shape[2]])),$(4===c.rank,(()=>`Error in conv2d: input must be rank 4, but got rank ${c.rank}.`)),$(4===u.rank,(()=>`Error in conv2d: filter must be rank 4, but got rank ${u.rank}.`)),null!=o&&$(z(r),(()=>`Error in conv2d: pad must be an integer when using, dimRoundingMode ${o} but got pad ${r}.`));const p="NHWC"===a?c.shape[3]:c.shape[1];$(p===u.shape[2],(()=>`Error in conv2d: depth of input (${p}) must match input depth for filter ${u.shape[2]}.`)),$(Js(n,s),(()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${s}'`));const d={x:c,filter:u},h={strides:n,pad:r,dataFormat:a,dilations:s,dimRoundingMode:o},f=Cn.runKernel(Se,d,h);return l?Xr(f,[f.shape[1],f.shape[2],f.shape[3]]):f}}),Gl=Ln({conv1d_:function(e,t,n,r,a="NWC",s=1,o){const i=jn(e,"x","conv1d"),u=jn(t,"filter","conv1d");let c=i,l=!1;2===i.rank&&(l=!0,c=Xr(i,[1,i.shape[0],i.shape[1]])),$(3===c.rank,(()=>`Error in conv1d: input must be rank 3, but got rank ${c.rank}.`)),$(3===u.rank,(()=>`Error in conv1d: filter must be rank 3, but got rank ${u.rank}.`)),null!=o&&$(z(r),(()=>`Error in conv1d: pad must be an integer when using, dimRoundingMode ${o} but got pad ${r}.`)),$(c.shape[2]===u.shape[1],(()=>`Error in conv1d: depth of input (${c.shape[2]}) must match input depth for filter ${u.shape[1]}.`)),$(Js(n,s),(()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${n} and dilation '${s}'`)),$("NWC"===a,(()=>`Error in conv1d: got dataFormat of ${a} but only NWC is currently supported.`));const p=Xr(u,[1,u.shape[0],u.shape[1],u.shape[2]]),d=Xr(c,[c.shape[0],1,c.shape[1],c.shape[2]]),h=Kl(d,p,[1,n],r,"NHWC",[1,s],o);return Xr(h,l?[h.shape[2],h.shape[3]]:[h.shape[0],h.shape[2],h.shape[3]])}}),Jl=Ln({conv2DBackpropFilter_:function(e,t,n,r,a,s="NHWC",o){let i=e;3===e.rank&&(i=Xr(e,[1,e.shape[0],e.shape[1],e.shape[2]]));let u=t;3===u.rank&&(u=Xr(t,[1,t.shape[0],t.shape[1],t.shape[2]])),$(4===i.rank,(()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${i.shape}.`)),$(4===u.rank,(()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${u.shape}.`)),$(4===n.length,(()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${n}.`));const c="NHWC"===s?i.shape[3]:i.shape[1],l="NHWC"===s?u.shape[3]:u.shape[1];$(c===n[2],(()=>`Error in conv2dDerFilter: depth of input ${c}) must match input depth in filter (${n[2]}.`)),$(l===n[3],(()=>`Error in conv2dDerFilter: depth of dy (${l}) must match output depth for filter (${n[3]}).`)),null!=o&&$(z(a),(()=>`Error in conv2dDerFilter: pad must be an integer when using, dimRoundingMode ${o} but got pad ${a}.`));const p={x:i,dy:u},d={strides:r,pad:a,dataFormat:s,dimRoundingMode:o,filterShape:n};return Cn.runKernel("Conv2DBackpropFilter",p,d)}}),Yl=Ln({conv2DBackpropInput_:function(e,t,n,r,a,s="NHWC",o){$(e.length===t.rank,(()=>`Length of inShape (${e.length}) and rank of dy (${t.rank}) must match`));let i=e,u=t,c=!1;3===t.rank&&(c=!0,u=Xr(t,[1,t.shape[0],t.shape[1],t.shape[2]]),i=[1,e[0],e[1],e[2]]),$(4===i.length,(()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${i.length}.`)),$(4===u.rank,(()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${u.rank}`)),$(4===n.rank,(()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${n.rank}`));const l="NHWC"===s?i[3]:i[1],p="NHWC"===s?u.shape[3]:u.shape[1];$(l===n.shape[2],(()=>`Error in conv2dDerInput: depth of input (${l}) must match input depth for filter ${n.shape[2]}.`)),$(p===n.shape[3],(()=>`Error in conv2dDerInput: depth of output (${p}) must match output depth for filter ${n.shape[3]}.`)),null!=o&&$(z(a),(()=>`Error in conv2dDerInput: pad must be an integer when using, dimRoundingMode ${o} but got pad ${a}.`));const d={dy:u,filter:n},h={strides:r,pad:a,dataFormat:s,dimRoundingMode:o,inputShape:i},f=Cn.runKernel(Ne,d,h);return c?Xr(f,[f.shape[1],f.shape[2],f.shape[3]]):f}}),Xl=Ln({fusedConv2d_:function({x:e,filter:t,strides:n,pad:r,dataFormat:a="NHWC",dilations:s=[1,1],dimRoundingMode:o,bias:i,activation:u="linear",preluActivationWeights:c,leakyreluAlpha:l}){if(u=u||"linear",!1===so(Cn.state.gradientDepth,u)){let p=Kl(e,t,n,r,a,s,o);return null!=i&&(p=Wr(p,i)),ao(p,u,c,l)}const p=jn(e,"x","conv2d"),d=jn(t,"filter","conv2d");let h=p,f=!1;3===p.rank&&(f=!0,h=Xr(p,[1,p.shape[0],p.shape[1],p.shape[2]])),$(4===h.rank,(()=>`Error in fused conv2d: input must be rank 4, but got rank ${h.rank}.`)),$(4===d.rank,(()=>`Error in fused conv2d: filter must be rank 4, but got rank ${d.rank}.`)),null!=o&&$(z(r),(()=>`Error in fused conv2d: pad must be an integer when using, dimRoundingMode ${o} but got pad ${r}.`)),$(h.shape[3]===d.shape[2],(()=>`Error in conv2d: depth of input (${h.shape[3]}) must match input depth for filter ${d.shape[2]}.`)),$(Js(n,s),(()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${s}'`)),$("NHWC"===a,(()=>`Error in conv2d: got dataFormat of ${a} but only NHWC is currently supported.`));const m=Ws(h.shape,d.shape,n,s,r,o);let y,g;null!=i&&(y=jn(i,"bias","fused conv2d"),[y]=Nn(y,p),La(m.outShape,y.shape)),null!=c&&(g=jn(c,"prelu weights","fused conv2d"));const b=(e,t)=>{const[a,o,i,c]=t,l=no(e,i,u);$(Gs(s),(()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${s}'`));const p=[Yl(o.shape,l,a,n,r),Jl(o,l,a.shape,n,r)];if(null!=c){const e=ro(c,l);p.push(e)}return p},w={x:h,filter:d,bias:y,preluActivationWeights:g},v={strides:n,pad:r,dataFormat:a,dilations:s,dimRoundingMode:o,activation:u,leakyreluAlpha:l};return null==i?As(((e,t,n)=>{let r=Cn.runKernel(zt,w,v);return n([t,e,r]),f&&(r=Xr(r,[r.shape[1],r.shape[2],r.shape[3]])),{value:r,gradFunc:b}}))(h,d):As(((e,t,n,r)=>{let a=Cn.runKernel(zt,w,v);return r([t,e,a,n]),f&&(a=Xr(a,[a.shape[1],a.shape[2],a.shape[3]])),{value:a,gradFunc:b}}))(h,d,y)}}),Zl=Ln({depthwiseConv2d_:function(e,t,n,r,a="NHWC",s=[1,1],o){const i=jn(e,"x","depthwiseConv2d"),u=jn(t,"filter","depthwiseConv2d");let c=i,l=!1;3===i.rank&&(l=!0,c=Xr(i,[1,i.shape[0],i.shape[1],i.shape[2]])),$(4===c.rank,(()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${c.rank}.`)),$(4===u.rank,(()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${u.rank}.`)),$(c.shape[3]===u.shape[2],(()=>`Error in depthwiseConv2d: number of input channels (${c.shape[3]}) must match the inChannels dimension in filter ${u.shape[2]}.`)),null!=o&&$(z(r),(()=>`Error in depthwiseConv2d: pad must be an integer when using, dimRoundingMode ${o} but got pad ${r}.`));const p={x:c,filter:u},d={strides:n,pad:r,dataFormat:a,dilations:s,dimRoundingMode:o},h=Cn.runKernel(Ae,p,d);return l?Xr(h,[h.shape[1],h.shape[2],h.shape[3]]):h}}),Ql=Ln({depthwiseConv2dNativeBackpropFilter_:function(e,t,n,r,a,s=[1,1],o){let i=e;3===e.rank&&(i=Xr(e,[1,e.shape[0],e.shape[1],e.shape[2]]));let u=t;3===u.rank&&(u=Xr(t,[1,t.shape[0],t.shape[1],t.shape[2]]));const c={x:i,dy:u},l={strides:r,pad:a,dimRoundingMode:o,dilations:s,filterShape:n};return Cn.runKernel("DepthwiseConv2dNativeBackpropFilter",c,l)}}),ep=Ln({depthwiseConv2dNativeBackpropInput_:function(e,t,n,r,a,s=[1,1],o){let i=t,u=!1;3===t.rank&&(u=!0,i=Xr(t,[1,t.shape[0],t.shape[1],t.shape[2]]));const c={dy:i,filter:n},l={strides:r,pad:a,dimRoundingMode:o,dilations:s,inputShape:e},p=Cn.runKernel("DepthwiseConv2dNativeBackpropInput",c,l);return u?Xr(p,[p.shape[1],p.shape[2],p.shape[3]]):p}}),tp=Ln({fusedDepthwiseConv2d_:function({x:e,filter:t,strides:n,pad:r,dataFormat:a="NHWC",dilations:s=[1,1],dimRoundingMode:o,bias:i,activation:u="linear",preluActivationWeights:c,leakyreluAlpha:l}){if(!1===so(Cn.state.gradientDepth,u)){let p=Zl(e,t,n,r,a,s,o);return null!=i&&(p=Wr(p,i)),ao(p,u,c,l)}const p=jn(e,"x","depthwiseConv2d"),d=jn(t,"filter","depthwiseConv2d");let h=p,f=!1;3===p.rank&&(f=!0,h=Xr(p,[1,p.shape[0],p.shape[1],p.shape[2]])),$(4===h.rank,(()=>`Error in fused depthwiseConv2d: input must be rank 4, but got rank ${h.rank}.`)),$(4===d.rank,(()=>`Error in fused depthwiseConv2d: filter must be rank 4, but got rank ${d.rank}.`)),$(h.shape[3]===d.shape[2],(()=>`Error in fused depthwiseConv2d: number of input channels (${h.shape[3]}) must match the inChannels dimension in filter ${d.shape[2]}.`)),null==s&&(s=[1,1]),$(Js(n,s),(()=>`Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides ${n} and dilations '${s}'`)),null!=o&&$(z(r),(()=>`Error in fused depthwiseConv2d: pad must be an integer when using dimRoundingMode ${o} but got pad ${r}.`));const m=Ws(h.shape,d.shape,n,s,r,o,!0);let y,g;null!=i&&(y=jn(i,"bias","fused conv2d"),[y]=Nn(y,p),La(m.outShape,y.shape)),null!=c&&(g=jn(c,"prelu weights","fused depthwiseConv2d"));const b=(e,t)=>{$(Gs(s),(()=>`Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '${s}'`));const[a,i,c,l]=t,p=no(e,c,u),d=ep(i.shape,p,a,n,r,s,o),h=Ql(i,p,a.shape,n,r,s,o);return null!=l?[d,h,ro(y,p)]:[d,h]},w={x:h,filter:d,bias:y,preluActivationWeights:g},v={strides:n,pad:r,dataFormat:a,dilations:s,dimRoundingMode:o,activation:u,leakyreluAlpha:l};return null==i?As(((e,t,n)=>{let r=Cn.runKernel(Vt,w,v);return n([t,e,r]),f&&(r=Xr(r,[r.shape[1],r.shape[2],r.shape[3]])),{value:r,gradFunc:b}}))(h,d):As(((e,t,n,r)=>{let a=Cn.runKernel(Vt,w,v);return r([t,e,a,n]),f&&(a=Xr(a,[a.shape[1],a.shape[2],a.shape[3]])),{value:a,gradFunc:b}}))(h,d,y)}}),np=Ln({fusedMatMul_:function({a:e,b:t,transposeA:n=!1,transposeB:r=!1,bias:a,activation:s="linear",preluActivationWeights:o,leakyreluAlpha:i}){if(!1===so(Cn.state.gradientDepth,s)){let u=ms(e,t,n,r);return null!=a&&(u=Wr(u,a)),ao(u,s,o,i)}let u=jn(e,"a","fused matMul"),c=jn(t,"b","fused matMul");[u,c]=Nn(u,c);const l=n?u.shape[u.rank-2]:u.shape[u.rank-1],p=r?c.shape[c.rank-1]:c.shape[c.rank-2],d=n?u.shape[u.rank-1]:u.shape[u.rank-2],h=r?c.shape[c.rank-2]:c.shape[c.rank-1],f=u.shape.slice(0,-2),m=c.shape.slice(0,-2),y=L(f),g=L(m);$(u.rank>=2&&c.rank>=2&&u.rank===c.rank,(()=>`Error in fused matMul: inputs must have the same rank of at least 2, got ranks ${u.rank} and ${c.rank}.`)),$(q(f,m),(()=>`Error in fused matMul: outer dimensions (${f}) and (${m}) of Tensors with shapes ${u.shape} and ${c.shape} must match.`)),$(l===p,(()=>`Error in fused matMul: inner shapes (${l}) and (${p}) of Tensors with shapes ${u.shape} and ${c.shape} and transposeA=${n} and transposeB=${r} must match.`));const b=u.shape.slice(0,-2).concat([d,h]),w=Xr(u,n?[y,l,d]:[y,d,l]),v=Xr(c,r?[g,h,p]:[g,p,h]);let x,k;null!=a&&(x=jn(a,"bias","fused matMul"),[x]=Nn(x,u),La(b,x.shape)),null!=o&&(k=jn(o,"prelu weights","fused matMul"));const _=(e,t)=>{const[o,i,u,c]=t,l=no(Xr(e,u.shape),u,s);let p,d;return n||r?!n&&r?(p=ms(l,i,!1,!1),d=ms(l,o,!0,!1)):n&&!r?(p=ms(i,l,!1,!0),d=ms(o,l,!1,!1)):(p=ms(i,l,!0,!0),d=ms(l,o,!0,!0)):(p=ms(l,i,!1,!0),d=ms(o,l,!0,!1)),null!=a?[p,d,ro(c,l)]:[p,d]},S={a:w,b:v,bias:x,preluActivationWeights:k},N={transposeA:n,transposeB:r,activation:s,leakyreluAlpha:i};return null==a?As(((e,t,n)=>{const r=Cn.runKernel(qt,S,N);return n([e,t,r]),{value:Xr(r,b),gradFunc:_}}))(w,v):As(((e,t,n,r)=>{const a=Cn.runKernel(qt,S,N);return r([e,t,a,n]),{value:Xr(a,b),gradFunc:_}}))(w,v,x)}}),rp=Ln({conv2dTranspose_:function(e,t,n,r,a,s){const o=jn(e,"x","conv2dTranspose"),i=jn(t,"filter","conv2dTranspose");return Yl(n,o,i,r,a,"NHWC",s)}}),ap=Ln({conv3d_:function(e,t,n,r,a="NDHWC",s=[1,1,1]){const o=jn(e,"x","conv3d"),i=jn(t,"filter","conv3d");let u=o,c=!1;4===o.rank&&(c=!0,u=Xr(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),$(5===u.rank,(()=>`Error in conv3d: input must be rank 5, but got rank ${u.rank}.`)),$(5===i.rank,(()=>`Error in conv3d: filter must be rank 5, but got rank ${i.rank}.`)),$(u.shape[4]===i.shape[3],(()=>`Error in conv3d: depth of input (${u.shape[4]}) must match input depth for filter ${i.shape[3]}.`)),$(Js(n,s),(()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${n} and dilations '${s}'`)),$("NDHWC"===a,(()=>`Error in conv3d: got dataFormat of ${a} but only NDHWC is currently supported.`));const l={x:u,filter:i},p={strides:n,pad:r,dataFormat:a,dilations:s},d=Cn.runKernel("Conv3D",l,p);return c?Xr(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}}),sp=Ln({avgPool_:function(e,t,n,r,a){const s=jn(e,"x","avgPool","float32");$(Js(n,1),(()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${n} and dilations '1'`));let o=s,i=!1;3===s.rank&&(i=!0,o=Xr(s,[1,s.shape[0],s.shape[1],s.shape[2]])),$(4===o.rank,(()=>`Error in avgPool: x must be rank 4 but got rank ${o.rank}.`)),null!=a&&$(z(r),(()=>`Error in avgPool: pad must be an integer when using, dimRoundingMode ${a} but got pad ${r}.`));const u={x:o},c={filterSize:t,strides:n,pad:r,dimRoundingMode:a};let l=Cn.runKernel(ge,u,c);return l=_r(l,s.dtype),i?Xr(l,[l.shape[1],l.shape[2],l.shape[3]]):l}}),op=Ln({maxPool_:function(e,t,n,r,a){const s=jn(e,"x","maxPool");let o=s,i=!1;3===s.rank&&(i=!0,o=Xr(s,[1,s.shape[0],s.shape[1],s.shape[2]])),$(4===o.rank,(()=>`Error in maxPool: input must be rank 4 but got rank ${o.rank}.`)),$(Js(n,1),(()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${n} and dilations '1'`)),null!=a&&$(z(r),(()=>`Error in maxPool: pad must be an integer when using, dimRoundingMode ${a} but got pad ${r}.`));const u={x:o},c={filterSize:t,strides:n,pad:r,dimRoundingMode:a},l=Cn.runKernel(Ye,u,c);return i?Xr(l,[l.shape[1],l.shape[2],l.shape[3]]):l}}),ip=Ln({maxPoolWithArgmax_:function(e,t,n,r,a=!1){const s={x:jn(e,"x","maxPoolWithArgmax")},o={filterSize:t,strides:n,pad:r,includeBatchInIndex:a},i=Cn.runKernel("MaxPoolWithArgmax",s,o);return{result:i[0],indexes:i[1]}}}),up=Ln({avgPool3d_:function(e,t,n,r,a,s="NDHWC"){const o=jn(e,"x","avgPool3d","float32");let i=o,u=!1;4===o.rank&&(u=!0,i=Xr(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),$(5===i.rank,(()=>`Error in avgPool3d: x must be rank 5 but got rank ${i.rank}.`)),$("NDHWC"===s,(()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${s}`)),null!=a&&$(z(r),(()=>`Error in avgPool3d: pad must be an integer when using, dimRoundingMode ${a} but got pad ${r}.`));const c={x:i},l={filterSize:t,strides:n,pad:r,dimRoundingMode:a,dataFormat:s};let p=Cn.runKernel("AvgPool3D",c,l);return p=_r(p,i.dtype),u?Xr(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}}),cp=Ln({maxPool3d_:function(e,t=[1,1,1],n,r,a,s="NDHWC"){const o=jn(e,"x","maxPool3d");let i=o,u=!1;4===o.rank&&(u=!0,i=Xr(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),$(5===i.rank,(()=>`Error in maxPool3d: x must be rank 5 but got rank ${i.rank}.`)),$("NDHWC"===s,(()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${s}`)),null!=a&&$(z(r),(()=>`Error in maxPool3d: pad must be an integer when using, dimRoundingMode ${a} but got pad ${r}.`));const c={x:i},l={filterSize:t,strides:n,pad:r,dimRoundingMode:a,dataFormat:s},p=Cn.runKernel("MaxPool3D",c,l);return u?Xr(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}}),lp=Ln({dilation2d_:function(e,t,n,r,a=[1,1],s="NHWC"){const o=jn(e,"x","dilation2d"),i=jn(t,"filter","dilation2d");$(3===o.rank||4===o.rank,(()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${o.rank}.`)),$(3===i.rank,(()=>`Error in dilation2d: filter must be rank 3, but got rank ${i.rank}.`)),$("NHWC"===s,(()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${s}`));let u=o,c=!1;3===o.rank&&(u=Xr(o,[1,o.shape[0],o.shape[1],o.shape[2]]),c=!0);const l={x:u,filter:i},p={strides:n,pad:r,dilations:a},d=Cn.runKernel("Dilation2D",l,p);return c?Xr(d,[d.shape[1],d.shape[2],d.shape[3]]):d}});function pp(e,t,n){const[r,a]=_c("fusedOps",e,t,n),s="biasadd"===r,o=!s,i="prelu"===a,u="fusedbatchnorm"===r,c=_c("numArgs",e,t,n);if(s){if(i&&2!==c)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!i&&s&&1!==c)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(u)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported");const l=_c("strides",e,t,n),p=Ic(e,t,n),d=_c("dataFormat",e,t,n).toUpperCase(),h=_c("dilations",e,t,n);let[f,m]=_c("args",e,t,n);return o&&(m=f,f=void 0),{stride:l,pad:p,dataFormat:d,dilations:h,biasArg:f,preluArg:m,activationFunc:a,leakyreluAlpha:_c("leakyreluAlpha",e,t,n)}}function dp(e,t,n){if(n<=0)throw new Error("The number of values should be positive.");const r={start:e,stop:t,num:n};return Cn.runKernel("LinSpace",{},r)}const hp=Ln({multinomial_:function(e,t,n,r=!1){const a=jn(e,"logits","multinomial"),s=a.size,o=a.rank;if(s<2)throw new Error(`Error in multinomial: you need at least 2 outcomes, but got ${s}.`);if(o>2)throw new Error(`Rank of probabilities must be 1 or 2, but is ${o}`);n=n||Math.random();const i={logits:1===o?Xr(a,[1,-1]):a},u={numSamples:t,seed:n,normalized:r},c=Cn.runKernel("Multinomial",i,u);return 1===o?Xr(c,[c.size]):c}}),fp=Ln({oneHot_:function(e,t,n=1,r=0){if(t<2)throw new Error(`Error in oneHot: depth must be >=2, but it is ${t}`);const a={indices:jn(e,"indices","oneHot","int32")},s={depth:t,onValue:n,offValue:r};return Cn.runKernel(it,a,s)}}),mp=Ln({onesLike_:function(e){const t={x:jn(e,"x","onesLike")};return Cn.runKernel(ot,t)}});var yp=n(2474);class gp{constructor(e,t,n,r,a){this.mean=e,this.stdDev=t,this.dtype=n,this.nextVal=NaN,this.truncated=r,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);const s=a||Math.random();this.random=yp.alea(s.toString())}nextValue(){if(!isNaN(this.nextVal)){const e=this.nextVal;return this.nextVal=NaN,e}let e,t,n=!1;for(;!n;){let r,a,s;do{r=2*this.random()-1,a=2*this.random()-1,s=r*r+a*a}while(s>=1||0===s);const o=Math.sqrt(-2*Math.log(s)/s);e=this.mean+this.stdDev*r*o,t=this.mean+this.stdDev*a*o,this.truncated&&!this.isValidTruncated(e)||(n=!0)}return this.truncated&&!this.isValidTruncated(t)||(this.nextVal=this.convertValue(t)),this.convertValue(e)}convertValue(e){return null==this.dtype||"float32"===this.dtype?e:Math.round(e)}isValidTruncated(e){return e<=this.upper&&e>=this.lower}}class bp{constructor(e=0,t=1,n,r){if(this.canReturnFloat=()=>null==this.dtype||"float32"===this.dtype,this.min=e,this.range=t-e,this.dtype=n,null==r&&(r=Math.random()),"number"==typeof r&&(r=r.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${e} - ${t} <= 1 and dtype is not float`);this.random=yp.alea(r)}convertValue(e){return this.canReturnFloat()?e:Math.round(e)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}const wp=Ln({randomUniform_:function(e,t=0,n=1,r="float32",a){const s=kr(e,r),o=new bp(t,n,null,a);for(let e=0;e<s.values.length;e++)s.values[e]=o.nextValue();return s.toTensor()}}),vp=Ln({truncatedNormal_:function(e,t=0,n=1,r,a){if(null!=r&&"bool"===r)throw new Error("Unsupported data type $ { dtype }");const s=new gp(t,n,r,!0,a),o=kr(e,r);for(let e=0;e<o.values.length;e++)o.values[e]=s.nextValue();return o.toTensor()}}),xp=async function(e){const t=jn(e,"condition","whereAsync","bool"),n=await t.data(),r=function(e,t){const n=[];for(let e=0;e<t.length;e++)t[e]&&n.push(e);const r=kr(e,"int32"),a=kr([n.length,e.length],"int32");for(let t=0;t<n.length;t++){const s=r.indexToLoc(n[t]),o=t*e.length;a.values.set(s,o)}return a.toTensor()}(t.shape,n);return e!==t&&t.dispose(),r};function kp(e,t,n){return{boxes:_c("boxes",e,t,n),scores:_c("scores",e,t,n),maxOutputSize:_c("maxOutputSize",e,t,n),iouThreshold:_c("iouThreshold",e,t,n),scoreThreshold:_c("scoreThreshold",e,t,n),softNmsSigma:_c("softNmsSigma",e,t,n)}}const _p=Ln({topk_:function(e,t=1,n=!0){const r=jn(e,"x","topk");if(0===r.rank)throw new Error("topk() expects the input to be of rank 1 or higher");const a=r.shape[r.shape.length-1];if(t<0)throw new Error(`'k' passed to topk() must be >= 0 but got ${t}`);if(t>a)throw new Error(`'k' passed to topk() must be <= the last dimension (${a}) but got ${t}`);const s={x:r},o={k:t,sorted:n},[i,u]=Cn.runKernel(Rt,s,o);return{values:i,indices:u}}}),Sp=Ln({unique_:function(e,t=0){const n=jn(e,"x","unique","string_or_numeric");$(n.rank>0,(()=>"The input tensor must be at least 1D"));const r={x:n},a={axis:t},[s,o]=Cn.runKernel("Unique",r,a);return{values:s,indices:o}}});class Np{constructor(e,t){this.keyDType=e,this.valueDType=t,this.handle=Zr(0),this.tensorMap=new Map,hs(this.handle)}get id(){return this.handle.id}clearAndClose(){this.tensorMap.forEach((e=>e.dispose())),this.tensorMap.clear(),this.handle.dispose()}size(){return this.tensorMap.size}tensorSize(){return Zr(this.size(),"int32")}async import(e,t){this.checkKeyAndValueTensor(e,t);const n=await e.data();return this.tensorMap.forEach((e=>e.dispose())),this.tensorMap.clear(),ds((()=>{const e=oa(t),r=n.length,a=e.length;$(r===a,(()=>`The number of elements doesn't match, keys has ${r} elements, the values has ${a} elements.`));for(let t=0;t<r;t++){const r=n[t],a=e[t];hs(a),this.tensorMap.set(r,a)}return this.handle}))}async find(e,t){this.checkKeyAndValueTensor(e,t);const n=await e.data();return ds((()=>{const e=[];for(let r=0;r<n.length;r++){const a=n[r],s=this.findWithDefault(a,t);e.push(s)}return na(e)}))}findWithDefault(e,t){const n=this.tensorMap.get(e);return null!=n?n:t}checkKeyAndValueTensor(e,t){if(e.dtype!==this.keyDType)throw new Error(`Expect key dtype ${this.keyDType}, but got ${e.dtype}`);if(t.dtype!==this.valueDType)throw new Error(`Expect value dtype ${this.valueDType}, but got ${t.dtype}`)}}const Tp=Ln({less_:function(e,t){let n=jn(e,"a","less","string_or_numeric"),r=jn(t,"b","less","string_or_numeric");[n,r]=Nn(n,r),La(n.shape,r.shape);const a={a:n,b:r};return Cn.runKernel(He,a)}}),Ep=Ln({logicalNot_:function(e){const t={x:jn(e,"x","logicalNot","bool")};return Cn.runKernel("LogicalNot",t)}}),Ip=Ln({logicalOr_:function(e,t){const n=jn(e,"a","logicalOr","bool"),r=jn(t,"b","logicalOr","bool");La(n.shape,r.shape);const a={a:n,b:r};return Cn.runKernel("LogicalOr",a)}}),Op=Ln({einsum_:function(e,...t){const n=t.map(((e,t)=>jn(e,`tensors${t}`,"einsum"))),r={equation:e};return Cn.runKernel("Einsum",n,r)}}),Ap=Ln({batchNorm_:function(e,t,n,r,a,s){null==s&&(s=.001);const o=jn(e,"x","batchNorm"),i=jn(t,"mean","batchNorm"),u=jn(n,"variance","batchNorm");let c,l;null!=a&&(c=jn(a,"scale","batchNorm")),null!=r&&(l=jn(r,"offset","batchNorm")),$(i.rank===u.rank,(()=>"Batch normalization gradient requires mean and variance to have equal ranks.")),$(null==l||i.rank===l.rank,(()=>"Batch normalization gradient requires mean and offset to have equal ranks.")),$(null==c||i.rank===c.rank,(()=>"Batch normalization gradient requires mean and scale to have equal ranks."));const p={x:function(e){let t;return t=0===e.rank||1===e.rank?Xr(e,[1,1,1,e.size]):2===e.rank?Xr(e,[1,1,e.shape[0],e.shape[1]]):3===e.rank?Xr(e,[1,e.shape[0],e.shape[1],e.shape[2]]):e,t}(o),scale:c,offset:l,mean:i,variance:u},d={varianceEpsilon:s},h=Cn.runKernel(je,p,d);return Xr(h,o.shape)}}),Mp=Ln({localResponseNormalization_:function(e,t=5,n=1,r=1,a=.5){const s=jn(e,"x","localResponseNormalization");$(4===s.rank||3===s.rank,(()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got\n               rank ${s.rank}.`)),$(z(t),(()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${t}.`));let o=s,i=!1;3===s.rank&&(i=!0,o=Xr(s,[1,s.shape[0],s.shape[1],s.shape[2]]));const u={x:o},c={depthRadius:t,bias:n,alpha:r,beta:a},l=Cn.runKernel("LRN",u,c);return i?Xr(l,[l.shape[1],l.shape[2],l.shape[3]]):l}}),Cp=Ln({softmax_:function(e,t=-1){const n=jn(e,"logits","softmax","float32");if(-1===t&&(t=n.rank-1),t!==n.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and dim was ${t}`);const r={logits:n},a={dim:t};return Cn.runKernel(It,r,a)}}),Rp=Ln({logSoftmax_:function(e,t=-1){const n=jn(e,"logits","logSoftmax");if(-1===t&&(t=n.rank-1),t!==n.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and axis was ${t}`);return As(((e,n)=>{const r=ss(e,t,!0),a=ra(e,r),s=ra(_r(a,"float32"),Ts(Va(Is(a),t,!0)));return n([s]),{value:s,gradFunc:(e,n)=>{const[r]=n,a=Is(r);return ra(e,Yr(Va(e,t,!0),a))}}}))(n)}}),Dp=Ln({sparseToDense_:function(e,t,n,r=0){const a=jn(e,"sparseIndices","sparseToDense","int32"),s=jn(t,"sparseValues","sparseToDense"),o=jn(r,"defaultValue","sparseToDense",s.dtype);!function(e,t,n,r){if("int32"!==e.dtype)throw new Error(`tf.sparseToDense() expects the indices to be int32 type, but the dtype was ${e.dtype}.`);if(e.rank>2)throw new Error(`sparseIndices should be a scalar, vector, or matrix, but got shape ${e.shape}.`);const a=e.rank>0?e.shape[0]:1,s=e.rank>1?e.shape[1]:1;if(n.length!==s)throw new Error(`outputShape has incorrect number of elements:, ${n.length}, should be: ${s}.`);const o=t.size;if(0!==t.rank&&(1!==t.rank||o!==a))throw new Error(`sparseValues has incorrect shape ${t.shape}, should be [] or [${a}]`);if(t.dtype!==r.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}(a,s,n,o);const i={sparseIndices:a,sparseValues:s,defaultValue:o},u={outputShape:n};return Cn.runKernel("SparseToDense",i,u)}}),Fp=Ln({all_:function(e,t=null,n=!1){const r={x:jn(e,"x","all","bool")},a={axis:t,keepDims:n};return Cn.runKernel(fe,r,a)}}),$p=Ln({any_:function(e,t=null,n=!1){const r={x:jn(e,"x","any","bool")},a={axis:t,keepDims:n};return Cn.runKernel(me,r,a)}}),Pp=Ln({argMax_:function(e,t=0){const n={x:jn(e,"x","argMax")},r={axis:t};return Cn.runKernel(ye,n,r)}}),jp=Ln({argMin_:function(e,t=0){const n={x:jn(e,"x","argMin")},r={axis:t};return Cn.runKernel("ArgMin",n,r)}}),Bp=Ln({cumsum_:function(e,t=0,n=!1,r=!1){const a={x:jn(e,"x","cumsum")},s={axis:t,exclusive:n,reverse:r};return Cn.runKernel(Ee,a,s)}}),Lp=Ln({denseBincount_:function(e,t,n,r=!1){const a=jn(e,"x","denseBincount"),s=jn(t,"weights","denseBincount");$("int32"===a.dtype,(()=>`Error in denseBincount: input dtype must be int32, but got ${a.dtype}`)),$(a.rank<=2,(()=>`Error in denseBincount: input must be at most rank 2, but got rank ${a.rank}.`)),$(n>=0,(()=>`size must be non-negative, but got ${n}.`)),$(s.size===a.size||0===s.size,(()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${a.shape}, weights shape: ${s.shape}.`));const o={x:a,weights:s},i={size:n,binaryOutput:r};return Cn.runKernel("DenseBincount",o,i)}}),qp=Ln({gather_:function(e,t,n=0,r=0){const a={x:jn(e,"x","gather"),indices:jn(t,"indices","gather","int32")},s={axis:n,batchDims:r};return Cn.runKernel(Be,a,s)}}),zp=Ln({stridedSlice_:function(e,t,n,r,a=0,s=0,o=0,i=0,u=0){const c={x:jn(e,"x","stridedSlice","string_or_numeric")},l={begin:t,end:n,strides:r,beginMask:a,endMask:s,ellipsisMask:o,newAxisMask:i,shrinkAxisMask:u};return Cn.runKernel(At,c,l)}}),Vp=Ln({scatterND_:function(e,t,n){const r=jn(e,"indices","scatterND","int32"),a=jn(t,"updates","scatterND");!function(e,t,n){if(t.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${t.rank}.`);if(e.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${e.rank}.`);if("int32"!==t.dtype)throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${t.dtype}`);if(n.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${n}`);if(0===n.length){if(0===t.size)throw new Error(`Indices specified for empty output. indices shape: ${t.shape}`);if(0===e.size)throw new Error(`Updates specified for empty output. updates shape: ${e.shape}`)}!function(e,t,n){const r=t.rank>1?t.shape[t.rank-1]:1,a=t.rank>1?t.rank-1:1,s=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${n.shape}, indices.shape: ${t.shape}, shape: ${e}, sliceDim: ${r}, and batchDim: ${a}.`;if(n.rank<a)throw new Error(s+` update.rank < ${a}. `);if(e.length<r+(n.rank-a))throw new Error(s+` Output shape length < ${r+(n.rank-a)}`);if(n.rank!==a+e.length-r)throw new Error(s+" update.rank != "+(a+e.length-r));for(let e=0;e<a;++e)if(n.shape[e]!==t.shape[e])throw new Error(s+` updates.shape[${e}] (${n.shape[e]}) != indices.shape[${e}] (${t.shape[e]}).`);for(let t=0;t<n.rank-a;++t)if(n.shape[t+a]!==e[t+r])throw new Error(s+` updates.shape[${t+a}] (${n.shape[t+a]}) != shape[${t+a}] (${e[t+a]})`)}(n,t,e)}(a,r,n);const s={indices:r,updates:a},o={shape:n};return Cn.runKernel(vt,s,o)}}),Wp=Ln({gatherND_:function(e,t){const n=jn(t,"indices","gatherND","int32"),r={params:jn(e,"x","gatherND","string_or_numeric"),indices:n};return Cn.runKernel(Le,r)}}),Hp=Ln({mirrorPad_:function(e,t,n){$("reflect"===n||"symmetric"===n,(()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${n}.`));const r=jn(e,"x","mirrorPad");if(0===r.rank)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");$(t.length===r.rank,(()=>`Padding doesn't match input. Must be ${r.rank}. Got ${t.length}.`));const a="reflect"===n?1:0;for(let e=0;e<r.rank;e++)$(2===t[e].length,(()=>"Invalid number of paddings. Must be length of 2 each.")),$(t[e][0]>=0&&t[e][0]<=r.shape[e]-a&&t[e][1]>=0&&t[e][1]<=r.shape[e]-a,(()=>`Padding in dimension ${e} cannot be greater than or equal to ${r.shape[e]-a} or less than 0 for input of shape ${r.shape}`));const s={paddings:t,mode:n},o={x:r};return Cn.runKernel(et,o,s)}}),Up=Ln({pad_:function(e,t,n=0){const r=jn(e,"x","pad");if(0===r.rank)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const a={paddings:t,constantValue:n},s={x:r};return Cn.runKernel(ct,s,a)}}),Kp=Ln({spaceToBatchND_:function(e,t,n){const r=jn(e,"x","spaceToBatchND");$(r.rank>=1+t.length,(()=>`input rank ${r.rank} should be > than [blockShape] ${t.length}`)),$(n.length===t.length,(()=>`paddings.shape[0] ${n.length} must be equal to [blockShape] ${t.length}`)),$(r.shape.reduce(((e,r,a)=>a>0&&a<=t.length?e&&(r+n[a-1][0]+n[a-1][1])%t[a-1]==0:e),!0),(()=>`input spatial dimensions ${r.shape.slice(1)} with paddings ${n.toString()} must be divisible by blockShapes ${t.toString()}`));const a={x:r},s={blockShape:t,paddings:n};return Cn.runKernel(Tt,a,s)}}),Gp=Ln({batchToSpaceND_:function(e,t,n){const r=jn(e,"x","batchToSpaceND"),a=t.reduce(((e,t)=>e*t));$(r.rank>=1+t.length,(()=>`input rank is ${r.rank} but should be > than blockShape.length ${t.length}`)),$(n.length===t.length,(()=>`crops.length is ${n.length} but should be equal to blockShape.length  ${t.length}`)),$(r.shape[0]%a==0,(()=>`input tensor batch is ${r.shape[0]} but is not divisible by the product of the elements of blockShape ${t.join(" * ")} === ${a}`));const s={x:r},o={blockShape:t,crops:n};return Cn.runKernel(we,s,o)}}),Jp=Ln({depthToSpace_:function(e,t,n="NHWC"){const r=jn(e,"x","depthToSpace"),a="NHWC"===n?r.shape[1]:r.shape[2],s="NHWC"===n?r.shape[2]:r.shape[3],o="NHWC"===n?r.shape[3]:r.shape[1];$(a*t>=0,(()=>`Negative dimension size caused by overflow when multiplying\n    ${a} and ${t}  for depthToSpace with input shape\n    ${r.shape}`)),$(s*t>=0,(()=>`Negative dimension size caused by overflow when multiplying\n    ${s} and ${t} for depthToSpace with input shape\n        ${r.shape}`)),$(o%(t*t)==0,(()=>`Dimension size must be evenly divisible by ${t*t} but is ${o} for depthToSpace with input shape ${r.shape}`));const i={x:r},u={blockSize:t,dataFormat:n};return Cn.runKernel(Oe,i,u)}}),Yp=Ln({broadcastArgs_:function(e,t){const n=jn(e,"s0","broadcastArgs","int32"),r=jn(t,"s1","broadcastArgs","int32");if(1!==n.rank)throw new Error(`broadcastArgs(): first input must be a vector (rank=1). Has rank ${n.rank}`);if(1!==r.rank)throw new Error(`broadcastArgs(): second input must be a vector (rank=1). Has rank ${r.rank}`);const a={s0:n,s1:r};return Cn.runKernel("BroadcastArgs",a)}});function Xp(e,t,n,r){const a=((e,t,n)=>{switch(e.category){case"arithmetic":return ds((()=>((e,t,n)=>{switch(e.op){case"BiasAdd":case"AddV2":case"Add":return[Wr(_c("a",e,t,n),_c("b",e,t,n))];case"AddN":return[pl(_c("tensors",e,t,n))];case"FloorMod":case"Mod":return[dl(_c("a",e,t,n),_c("b",e,t,n))];case"Mul":return[Yr(_c("a",e,t,n),_c("b",e,t,n))];case"RealDiv":case"Div":return[Gr(_c("a",e,t,n),_c("b",e,t,n))];case"DivNoNan":return[fl(_c("a",e,t,n),_c("b",e,t,n))];case"FloorDiv":return[Kr(_c("a",e,t,n),_c("b",e,t,n))];case"Sub":return[ra(_c("a",e,t,n),_c("b",e,t,n))];case"Minimum":return[Ns(_c("a",e,t,n),_c("b",e,t,n))];case"Maximum":return[ml(_c("a",e,t,n),_c("b",e,t,n))];case"Pow":return[is(_c("a",e,t,n),_c("b",e,t,n))];case"SquaredDifference":return[Es(_c("a",e,t,n),_c("b",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}})(e,t,n)));case"basic_math":return ds((()=>((e,t,n)=>{switch(e.op){case"Abs":case"ComplexAbs":return[Za(_c("x",e,t,n))];case"Acos":return[yl(_c("x",e,t,n))];case"Acosh":return[gl(_c("x",e,t,n))];case"Asin":return[bl(_c("x",e,t,n))];case"Asinh":return[wl(_c("x",e,t,n))];case"Atan":return[vl(_c("x",e,t,n))];case"Atan2":return[xl(_c("x",e,t,n),_c("y",e,t,n))];case"Atanh":return[kl(_c("x",e,t,n))];case"Ceil":return[_l(_c("x",e,t,n))];case"Complex":return[qn(_c("real",e,t,n),_c("imag",e,t,n))];case"Cos":return[Sl(_c("x",e,t,n))];case"Cosh":return[Nl(_c("x",e,t,n))];case"Elu":return[Xs(_c("x",e,t,n))];case"Erf":return[Tl(_c("x",e,t,n))];case"Exp":return[Is(_c("x",e,t,n))];case"Expm1":return[El(_c("x",e,t,n))];case"Floor":return[Il(_c("x",e,t,n))];case"Log":return[Ts(_c("x",e,t,n))];case"Log1p":return[Os(_c("x",e,t,n))];case"Imag":return[ia(_c("x",e,t,n))];case"Neg":return[ys(_c("x",e,t,n))];case"Reciprocal":return[Ol(_c("x",e,t,n))];case"Real":return[ua(_c("x",e,t,n))];case"Relu":return[Ss(_c("x",e,t,n))];case"Round":return[Wa(_c("x",e,t,n))];case"Selu":return[Al(_c("x",e,t,n))];case"Sigmoid":return[Qr(_c("x",e,t,n))];case"Sin":return[Ml(_c("x",e,t,n))];case"Sign":return[Cl(_c("x",e,t,n))];case"Sinh":return[Rl(_c("x",e,t,n))];case"Softplus":return[Dl(_c("x",e,t,n))];case"Sqrt":return[us(_c("x",e,t,n))];case"Square":return[cs(_c("x",e,t,n))];case"Tanh":return[Fl(_c("x",e,t,n))];case"Tan":return[$l(_c("x",e,t,n))];case"ClipByValue":return[Pl(_c("x",e,t,n),_c("clipValueMin",e,t,n),_c("clipValueMax",e,t,n))];case"Relu6":return[eo(_c("x",e,t,n))];case"Rsqrt":return[jl(Sc(e.inputNames[0],t,n))];case"Prod":return[Bl(_c("x",e,t,n),_c("axes",e,t,n))];case"LeakyRelu":return[Zs(_c("x",e,t,n),_c("alpha",e,t,n))];case"Prelu":return[Qs(_c("x",e,t,n),_c("alpha",e,t,n))];case"IsNan":return[Ll(Sc(e.inputNames[0],t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}})(e,t,n)));case"control":return(async(e,t,n)=>{switch(e.op){case"If":case"StatelessIf":{const r=_c("thenBranch",e,t,n),a=_c("elseBranch",e,t,n),s=_c("cond",e,t,n),o=_c("args",e,t,n);return(await s.data())[0]?n.functionMap[r].executeFunctionAsync(o,n.tensorArrayMap,n.tensorListMap):n.functionMap[a].executeFunctionAsync(o,n.tensorArrayMap,n.tensorListMap)}case"While":case"StatelessWhile":{const r=_c("body",e,t,n),a=_c("cond",e,t,n),s=_c("args",e,t,n),o=await n.functionMap[a].executeFunctionAsync(s,n.tensorArrayMap,n.tensorListMap),i=s.map((e=>e.id));let u=await o[0].data();o.forEach((e=>{e.kept||-1!==i.indexOf(e.id)||e.dispose()}));let c=s;for(;u[0];){const e=c;c=await n.functionMap[r].executeFunctionAsync(c,n.tensorArrayMap,n.tensorListMap);const t=c.map((e=>e.id));e.forEach((e=>{e.kept||-1!==i.indexOf(e.id)||-1!==t.indexOf(e.id)||e.dispose()}));const s=await n.functionMap[a].executeFunctionAsync(c,n.tensorArrayMap,n.tensorListMap);u=await s[0].data(),s.forEach((e=>{e.kept||-1!==i.indexOf(e.id)||-1!==t.indexOf(e.id)||e.dispose()}))}return c}case"LoopCond":return[Oc(_c("pred",e,t,n))];case"Switch":{const r=_c("pred",e,t,n);let a=_c("data",e,t,n);return a.kept||(a=Oc(a)),(await r.data())[0]?[void 0,a]:[a,void 0]}case"Merge":{const r=e.inputNames.find((e=>void 0!==Sc(e,t,n)));return r?[Oc(Sc(r,t,n))]:void 0}case"Enter":{const r=_c("frameName",e,t,n),a=_c("tensor",e,t,n);return n.enterFrame(r),[Oc(a)]}case"Exit":{const r=_c("tensor",e,t,n);return n.exitFrame(),[Oc(r)]}case"NextIteration":{const r=_c("tensor",e,t,n);return n.nextIteration(),[Oc(r)]}case"TensorArrayV3":{const r=_c("size",e,t,n),a=_c("dtype",e,t,n),s=_c("elementShape",e,t,n),o=_c("dynamicSize",e,t,n),i=_c("clearAfterRead",e,t,n),u=_c("identicalElementShapes",e,t,n),c=_c("name",e,t,n),l=new Hl(c,a,r,s,u,o,i);return n.addTensorArray(l),[l.idTensor,Zr(1)]}case"TensorArrayWriteV3":{const r=_c("tensorArrayId",e,t,n),a=_c("index",e,t,n),s=_c("tensor",e,t,n),o=n.getTensorArray(r.id);return o.write(a,s),[o.idTensor]}case"TensorArrayReadV3":{const r=_c("tensorArrayId",e,t,n),a=_c("index",e,t,n);return[n.getTensorArray(r.id).read(a)]}case"TensorArrayGatherV3":{const r=_c("tensorArrayId",e,t,n),a=_c("indices",e,t,n),s=_c("dtype",e,t,n);return[n.getTensorArray(r.id).gather(a,s)]}case"TensorArrayScatterV3":{const r=_c("tensorArrayId",e,t,n),a=_c("indices",e,t,n),s=_c("tensor",e,t,n),o=n.getTensorArray(r.id);return o.scatter(a,s),[o.idTensor]}case"TensorArrayConcatV3":{const r=_c("tensorArrayId",e,t,n),a=n.getTensorArray(r.id),s=_c("dtype",e,t,n);return[a.concat(s)]}case"TensorArraySplitV3":{const r=_c("tensorArrayId",e,t,n),a=_c("tensor",e,t,n),s=_c("lengths",e,t,n),o=n.getTensorArray(r.id);return o.split(s,a),[o.idTensor]}case"TensorArraySizeV3":{const r=_c("tensorArrayId",e,t,n);return[Zr(n.getTensorArray(r.id).size(),"int32")]}case"TensorArrayCloseV3":{const r=_c("tensorArrayId",e,t,n),a=n.getTensorArray(r.id);return a.clearAndClose(),[a.idTensor]}case"TensorListSetItem":{const r=_c("tensorListId",e,t,n),a=_c("index",e,t,n),s=_c("tensor",e,t,n),o=n.getTensorList(r.id);return o.setItem(a,s),[o.idTensor]}case"TensorListGetItem":{const r=_c("tensorListId",e,t,n),a=_c("index",e,t,n),s=_c("elementShape",e,t,n),o=_c("elementDType",e,t,n);return[n.getTensorList(r.id).getItem(a,s,o)]}case"TensorListScatterV2":case"TensorListScatter":{const r=_c("indices",e,t,n),a=function(e,t,n,r){if(t.length!==e.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${t.length} vs. ${e.shape[0]}`);const a=Math.max(...t);if(null!=r&&-1!==r&&a>=r)throw new Error(`Max index must be < array size (${a}  vs. ${r})`);const s=new Ul([],n,e.dtype,r),o=oa(e,0);return t.forEach(((e,t)=>{s.setItem(e,o[t])})),s}(_c("tensor",e,t,n),r,_c("elementShape",e,t,n),_c("numElements",e,t,n));return n.addTensorList(a),[a.idTensor]}case"TensorListReserve":case"EmptyTensorList":{const r=_c("elementShape",e,t,n),a=_c("elementDType",e,t,n);let s;s="TensorListReserve"===e.op?"numElements":"maxNumElements";const o=function(e,t,n){return new Ul([],e,t,n)}(r,a,_c(s,e,t,n));return n.addTensorList(o),[o.idTensor]}case"TensorListGather":{const r=_c("tensorListId",e,t,n),a=_c("indices",e,t,n),s=_c("elementShape",e,t,n),o=_c("elementDType",e,t,n);return[n.getTensorList(r.id).gather(a,o,s)]}case"TensorListStack":{const r=_c("tensorListId",e,t,n),a=_c("elementShape",e,t,n),s=_c("elementDType",e,t,n),o=_c("numElements",e,t,n);return[n.getTensorList(r.id).stack(a,s,o)]}case"TensorListFromTensor":{const r=function(e,t,n){const r=e.dtype;if(e.shape.length<1)throw new Error(`Tensor must be at least a vector, but saw shape: ${e.shape}`);if(e.dtype!==n)throw new Error(`Invalid data types; op elements ${e.dtype}, but list elements ${n}`);ql(e.shape.slice(1),t,"TensorList shape mismatch: ");const a=oa(e);return new Ul(a,t,r)}(_c("tensor",e,t,n),_c("elementShape",e,t,n),_c("elementDType",e,t,n));return n.addTensorList(r),[r.idTensor]}case"TensorListConcat":{const r=_c("tensorListId",e,t,n),a=n.getTensorList(r.id),s=_c("dtype",e,t,n),o=_c("elementShape",e,t,n);return[a.concat(s,o)]}case"TensorListPushBack":{const r=_c("tensorListId",e,t,n),a=_c("tensor",e,t,n),s=n.getTensorList(r.id);return s.pushBack(a),[s.idTensor]}case"TensorListPopBack":{const r=_c("tensorListId",e,t,n),a=_c("elementShape",e,t,n),s=_c("elementDType",e,t,n);return[n.getTensorList(r.id).popBack(a,s)]}case"TensorListSplit":{const r=_c("tensor",e,t,n),a=_c("elementShape",e,t,n),s=function(e,t,n){let r=0;const a=t.map((e=>(r+=e,r)));if(r!==e.shape[0])throw new Error(`Expected sum of lengths to be equal to\n          tensor.shape[0], but sum of lengths is\n        ${r}, and tensor's shape is: ${e.shape}`);const s=Wl(e.shape.slice(1),n),o=0===r?0:e.size/r,i=ds((()=>{const n=[];e=Xr(e,[1,r,o]);for(let r=0;r<t.length;++r){const i=[0,0===r?0:a[r-1],0],u=[1,t[r],o];n[r]=Xr(ea(e,i,u),s)}return e.dispose(),n})),u=new Ul([],n,e.dtype,t.length);for(let e=0;e<i.length;e++)u.setItem(e,i[e]);return u}(r,_c("lengths",e,t,n),a);return n.addTensorList(s),[s.idTensor]}default:throw TypeError(`Node type ${e.op} is not implemented`)}})(e,t,n);case"convolution":return ds((()=>((e,t,n)=>{switch(e.op){case"Conv1D":{const r=_c("stride",e,t,n),a=_c("pad",e,t,n),s=_c("dataFormat",e,t,n).toUpperCase(),o=_c("dilation",e,t,n);return[Gl(_c("x",e,t,n),_c("filter",e,t,n),r,a,s,o)]}case"Conv2D":{const r=_c("strides",e,t,n),a=Ic(e,t,n),s=_c("dataFormat",e,t,n).toUpperCase(),o=_c("dilations",e,t,n);return[Kl(_c("x",e,t,n),_c("filter",e,t,n),[r[1],r[2]],a,s,[o[1],o[2]])]}case"_FusedConv2D":{const{stride:r,pad:a,dataFormat:s,dilations:o,biasArg:i,preluArg:u,activationFunc:c,leakyreluAlpha:l}=pp(e,t,n);return[Xl({x:_c("x",e,t,n),filter:_c("filter",e,t,n),strides:[r[1],r[2]],pad:a,dataFormat:s,dilations:[o[1],o[2]],bias:i,activation:c,preluActivationWeights:u,leakyreluAlpha:l})]}case"FusedDepthwiseConv2dNative":{const{stride:r,pad:a,dataFormat:s,dilations:o,biasArg:i,preluArg:u,activationFunc:c,leakyreluAlpha:l}=pp(e,t,n);return[tp({x:_c("x",e,t,n),filter:_c("filter",e,t,n),strides:[r[1],r[2]],pad:a,dataFormat:s,dilations:[o[1],o[2]],bias:i,activation:c,preluActivationWeights:u,leakyreluAlpha:l})]}case"Conv2DBackpropInput":case"Conv2dTranspose":{const r=_c("outputShape",e,t,n),a=_c("strides",e,t,n),s=Ic(e,t,n);return[rp(_c("x",e,t,n),_c("filter",e,t,n),r,[a[1],a[2]],s)]}case"DepthwiseConv2dNative":case"DepthwiseConv2d":{const r=_c("strides",e,t,n),a=Ic(e,t,n),s=_c("dilations",e,t,n),o=_c("dataFormat",e,t,n).toUpperCase();return[Zl(_c("input",e,t,n),_c("filter",e,t,n),[r[1],r[2]],a,o,[s[1],s[2]])]}case"Conv3D":{const r=_c("strides",e,t,n),a=_c("pad",e,t,n),s=_c("dataFormat",e,t,n).toUpperCase(),o=_c("dilations",e,t,n);return[ap(_c("x",e,t,n),_c("filter",e,t,n),[r[1],r[2],r[3]],a,s,[o[1],o[2],o[3]])]}case"AvgPool":{const r=_c("strides",e,t,n),a=_c("pad",e,t,n),s=_c("kernelSize",e,t,n);return[sp(_c("x",e,t,n),[s[1],s[2]],[r[1],r[2]],a)]}case"MaxPool":{const r=_c("strides",e,t,n),a=_c("pad",e,t,n),s=_c("kernelSize",e,t,n);return[op(_c("x",e,t,n),[s[1],s[2]],[r[1],r[2]],a)]}case"MaxPoolWithArgmax":{const r=_c("strides",e,t,n),a=_c("pad",e,t,n),s=_c("kernelSize",e,t,n),o=_c("includeBatchInIndex",e,t,n),{result:i,indexes:u}=ip(_c("x",e,t,n),[s[1],s[2]],[r[1],r[2]],a,o);return[i,u]}case"AvgPool3D":{const r=_c("strides",e,t,n),a=_c("pad",e,t,n),s=_c("kernelSize",e,t,n);return[up(_c("x",e,t,n),[s[1],s[2],s[3]],[r[1],r[2],r[3]],a)]}case"MaxPool3D":{const r=_c("strides",e,t,n),a=_c("pad",e,t,n),s=_c("kernelSize",e,t,n);return[cp(_c("x",e,t,n),[s[1],s[2],s[3]],[r[1],r[2],r[3]],a)]}case"Dilation2D":{const r=_c("strides",e,t,n),a=_c("pad",e,t,n),s=_c("dilations",e,t,n),o=r[1],i=r[2],u=s[1],c=s[2];return[lp(_c("x",e,t,n),_c("filter",e,t,n),[o,i],a,[u,c],"NHWC")]}default:throw TypeError(`Node type ${e.op} is not implemented`)}})(e,t,n)));case"creation":return ds((()=>((e,t,n)=>{switch(e.op){case"Fill":{const r=_c("shape",e,t,n),a=_c("dtype",e,t,n);return[wa(r,_c("value",e,t,n),a)]}case"LinSpace":return[dp(_c("start",e,t,n),_c("stop",e,t,n),_c("num",e,t,n))];case"Multinomial":{const r=_c("logits",e,t,n),a=_c("numSamples",e,t,n),s=_c("seed",e,t,n);return[hp(r,a,s)]}case"OneHot":{const r=_c("indices",e,t,n),a=_c("depth",e,t,n),s=_c("onValue",e,t,n),o=_c("offValue",e,t,n);return[fp(r,a,s,o)]}case"Ones":return[ks(_c("shape",e,t,n),_c("dtype",e,t,n))];case"OnesLike":return[mp(_c("x",e,t,n))];case"RandomUniform":return[wp(_c("shape",e,t,n),_c("minval",e,t,n),_c("maxval",e,t,n),_c("dtype",e,t,n))];case"Range":return[Ka(_c("start",e,t,n),_c("stop",e,t,n),_c("step",e,t,n),_c("dtype",e,t,n))];case"TruncatedNormal":{const r=_c("shape",e,t,n),a=_c("mean",e,t,n),s=_c("stdDev",e,t,n),o=_c("seed",e,t,n);return[vp(r,a,s,_c("dtype",e,t,n),o)]}case"Zeros":return[la(_c("shape",e,t,n),_c("dtype",e,t,n))];case"ZerosLike":return[pa(_c("x",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}})(e,t,n)));case"dynamic":return(async(e,t,n)=>{switch(e.op){case"NonMaxSuppressionV5":{const{boxes:r,scores:a,maxOutputSize:s,iouThreshold:o,scoreThreshold:i,softNmsSigma:u}=kp(e,t,n),c=await Bs.nonMaxSuppressionWithScoreAsync(r,a,s,o,i,u);return[c.selectedIndices,c.selectedScores]}case"NonMaxSuppressionV4":{const{boxes:r,scores:a,maxOutputSize:s,iouThreshold:o,scoreThreshold:i}=kp(e,t,n),u=_c("padToMaxOutputSize",e,t,n),c=await Bs.nonMaxSuppressionPaddedAsync(r,a,s,o,i,u);return[c.selectedIndices,c.validOutputs]}case"NonMaxSuppressionV3":case"NonMaxSuppressionV2":{const{boxes:r,scores:a,maxOutputSize:s,iouThreshold:o,scoreThreshold:i}=kp(e,t,n);return[await Bs.nonMaxSuppressionAsync(r,a,s,o,i)]}case"Where":{const r=_r(_c("condition",e,t,n),"bool"),a=[await xp(r)];return r.dispose(),a}case"ListDiff":return async function(e,t){const n=jn(e,"x","setdiff1d"),r=jn(t,"y","setdiff1d");$(n.dtype===r.dtype,(()=>`x and y should have the same dtype, but got x (${n.dtype}) and y (${r.dtype}).`)),$(1===n.rank,(()=>`x should be 1D tensor, but got x (${n.shape}).`)),$(1===r.rank,(()=>`y should be 1D tensor, but got y (${r.shape}).`));const a=await n.data(),s=await r.data(),o=new Set(s);let i=0;for(let e=0;e<a.length;e++)o.has(a[e])||i++;const u=new hn([i],n.dtype),c=new hn([i],"int32");for(let e=0,t=0;e<a.length;e++)o.has(a[e])||(u.values[t]=a[e],c.values[t]=e,t++);return[u.toTensor(),c.toTensor()]}(_c("x",e,t,n),_c("y",e,t,n));default:throw TypeError(`Node type ${e.op} is not implemented`)}})(e,t,n);case"evaluation":return ds((()=>((e,t,n)=>{switch(e.op){case"TopKV2":{const r=_c("x",e,t,n),a=_c("k",e,t,n),s=_c("sorted",e,t,n),o=_p(r,a,s);return[o.values,o.indices]}case"Unique":{const r=_c("x",e,t,n),a=Sp(r);return[a.values,a.indices]}case"UniqueV2":{const r=_c("x",e,t,n),a=_c("axis",e,t,n),s=Sp(r,a);return[s.values,s.indices]}default:throw TypeError(`Node type ${e.op} is not implemented`)}})(e,t,n)));case"image":return ds((()=>((e,t,n)=>{switch(e.op){case"ResizeBilinear":{const r=_c("images",e,t,n),a=_c("size",e,t,n),s=_c("alignCorners",e,t,n),o=_c("halfPixelCenters",e,t,n);return[Bs.resizeBilinear(r,[a[0],a[1]],s,o)]}case"ResizeNearestNeighbor":{const r=_c("images",e,t,n),a=_c("size",e,t,n),s=_c("alignCorners",e,t,n),o=_c("halfPixelCenters",e,t,n);return[Bs.resizeNearestNeighbor(r,[a[0],a[1]],s,o)]}case"CropAndResize":{const r=_c("image",e,t,n),a=_c("boxes",e,t,n),s=_c("boxInd",e,t,n),o=_c("cropSize",e,t,n),i=_c("method",e,t,n),u=_c("extrapolationValue",e,t,n);return[Bs.cropAndResize(r,a,s,o,i,u)]}default:throw TypeError(`Node type ${e.op} is not implemented`)}})(e,t,n)));case"graph":return ds((()=>((e,t,n)=>{switch(e.op){case"Const":return t[e.name];case"PlaceholderWithDefault":const r=_c("default",e,t,n);return[Sc(e.name,t,n)||r];case"Placeholder":return[Sc(e.name,t,n)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":return[Oc(_c("x",e,t,n))];case"IdentityN":return _c("x",e,t,n).map((e=>Oc(e)));case"Snapshot":return[Oc(_c("x",e,t,n))];case"Shape":return[aa(_c("x",e,t,n).shape,"int32")];case"ShapeN":return _c("x",e,t,n).map((e=>aa(e.shape)));case"Size":return[Zr(_c("x",e,t,n).size,"int32")];case"Rank":return[Zr(_c("x",e,t,n).rank,"int32")];case"NoOp":return[Zr(1)];case"Print":const a=_c("x",e,t,n),s=_c("data",e,t,n),o=_c("message",e,t,n),i=_c("summarize",e,t,n);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(o);for(let e=0;e<s.length;e++)console.log(Array.prototype.slice.call(s[e].dataSync()).slice(0,i));return[a];default:throw TypeError(`Node type ${e.op} is not implemented`)}})(e,t,n)));case"logical":return ds((()=>((e,t,n)=>{switch(e.op){case"Equal":return[hl(_c("a",e,t,n),_c("b",e,t,n))];case"NotEqual":return[xs(_c("a",e,t,n),_c("b",e,t,n))];case"Greater":return[za(_c("a",e,t,n),_c("b",e,t,n))];case"GreaterEqual":return[Ya(_c("a",e,t,n),_c("b",e,t,n))];case"Less":return[Tp(_c("a",e,t,n),_c("b",e,t,n))];case"LessEqual":return[qa(_c("a",e,t,n),_c("b",e,t,n))];case"LogicalAnd":return[Xa(_c("a",e,t,n),_c("b",e,t,n))];case"LogicalNot":return[Ep(_c("a",e,t,n))];case"LogicalOr":return[Ip(_c("a",e,t,n),_c("b",e,t,n))];case"Select":case"SelectV2":return[Ua(_c("condition",e,t,n),_c("a",e,t,n),_c("b",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}})(e,t,n)));case"matrices":return ds((()=>((e,t,n)=>{switch(e.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[ms(_c("a",e,t,n),_c("b",e,t,n),_c("transposeA",e,t,n),_c("transposeB",e,t,n))];case"Einsum":return[Op(_c("equation",e,t,n),..._c("tensors",e,t,n))];case"Transpose":return[gs(_c("x",e,t,n),_c("perm",e,t,n))];case"_FusedMatMul":const[r,a]=_c("fusedOps",e,t,n),s="biasadd"===r,o="prelu"===a,i=_c("numArgs",e,t,n),u=_c("leakyreluAlpha",e,t,n);if(s){if(o&&2!==i)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!o&&1!==i)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}const[c,l]=_c("args",e,t,n);return[np({a:_c("a",e,t,n),b:_c("b",e,t,n),transposeA:_c("transposeA",e,t,n),transposeB:_c("transposeB",e,t,n),bias:c,activation:a,preluActivationWeights:l,leakyreluAlpha:u})];default:throw TypeError(`Node type ${e.op} is not implemented`)}})(e,t,n)));case"normalization":return ds((()=>((e,t,n)=>{switch(e.op){case"FusedBatchNorm":case"FusedBatchNormV2":case"FusedBatchNormV3":return[Ap(_c("x",e,t,n),_c("mean",e,t,n),_c("variance",e,t,n),_c("offset",e,t,n),_c("scale",e,t,n),_c("epsilon",e,t,n))];case"LRN":return[Mp(_c("x",e,t,n),_c("radius",e,t,n),_c("bias",e,t,n),_c("alpha",e,t,n),_c("beta",e,t,n))];case"Softmax":return[Cp(_c("x",e,t,n))];case"LogSoftmax":return[Rp(_c("x",e,t,n))];case"SparseToDense":return[Dp(_c("sparseIndices",e,t,n),_c("outputShape",e,t,n),_c("sparseValues",e,t,n),_c("defaultValue",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}})(e,t,n)));case"reduction":return ds((()=>((e,t,n)=>{switch(e.op){case"Max":{const r=_c("axis",e,t,n),a=_c("keepDims",e,t,n);return[ss(_c("x",e,t,n),r,a)]}case"Mean":{const r=_c("axis",e,t,n),a=_c("keepDims",e,t,n);return[vs(_c("x",e,t,n),r,a)]}case"Min":{const r=_c("axis",e,t,n),a=_c("keepDims",e,t,n);return[os(_c("x",e,t,n),r,a)]}case"Sum":{const r=_c("axis",e,t,n),a=_c("keepDims",e,t,n);return[Va(_c("x",e,t,n),r,a)]}case"All":{const r=_c("axis",e,t,n),a=_c("keepDims",e,t,n);return[Fp(_c("x",e,t,n),r,a)]}case"Any":{const r=_c("axis",e,t,n),a=_c("keepDims",e,t,n);return[$p(_c("x",e,t,n),r,a)]}case"ArgMax":{const r=_c("axis",e,t,n);return[Pp(_c("x",e,t,n),r)]}case"ArgMin":{const r=_c("axis",e,t,n);return[jp(_c("x",e,t,n),r)]}case"Prod":{const r=_c("axis",e,t,n),a=_c("keepDims",e,t,n);return[Bl(_c("x",e,t,n),r,a)]}case"Cumsum":{const r=_c("axis",e,t,n),a=_c("exclusive",e,t,n),s=_c("reverse",e,t,n);return[Bp(_c("x",e,t,n),r,a,s)]}case"Bincount":const r=_c("x",e,t,n),a=_c("weights",e,t,n),s=_c("size",e,t,n);return[ja(r,a,s)];case"DenseBincount":{const r=_c("x",e,t,n),a=_c("weights",e,t,n),s=_c("size",e,t,n),o=_c("binaryOutput",e,t,n);return[Lp(r,a,s,o)]}default:throw TypeError(`Node type ${e.op} is not implemented`)}})(e,t,n)));case"slice_join":return ds((()=>((e,t,n)=>{switch(e.op){case"ConcatV2":case"Concat":{const r=_c("n",e,t,n),a=_c("axis",e,t,n);let s=_c("tensors",e,t,n);return s=s.slice(0,r),[Hr(s,a)]}case"Gather":{const r=_c("x",e,t,n),a=_c("indices",e,t,n);return[qp(r,_r(a,"int32"),0)]}case"GatherV2":{const r=_c("axis",e,t,n),a=_c("batchDims",e,t,n),s=_c("x",e,t,n),o=_c("indices",e,t,n);return[qp(s,_r(o,"int32"),r,a)]}case"Reverse":{const r=_c("dims",e,t,n),a=[];for(let e=0;e<r.length;e++)r[e]&&a.push(e);const s=_c("x",e,t,n);return[ma(s,a)]}case"ReverseV2":{const r=_c("axis",e,t,n),a=_c("x",e,t,n);return[ma(a,r)]}case"Slice":{const r=_c("begin",e,t,n),a=_c("size",e,t,n);return[ea(_c("x",e,t,n),r,a)]}case"StridedSlice":{const r=_c("begin",e,t,n),a=_c("end",e,t,n),s=_c("strides",e,t,n),o=_c("beginMask",e,t,n),i=_c("endMask",e,t,n),u=_c("ellipsisMask",e,t,n),c=_c("newAxisMask",e,t,n),l=_c("shrinkAxisMask",e,t,n),p=_c("x",e,t,n);return[zp(p,r,a,s,o,i,u,c,l)]}case"Pack":return ds((()=>{const r=_c("axis",e,t,n),a=_c("tensors",e,t,n),s=a[0].shape,o=ta(a[0]).shape,i=a.map((e=>{const t=q(e.shape,s);if(!t&&!q(ta(e).shape,o))throw new Error("the input tensors shape does not match");return t?e:Xr(e,s)}));return[na(i,r)]}));case"Unpack":{const r=_c("axis",e,t,n),a=_c("tensor",e,t,n);return oa(a,r)}case"Tile":{const r=_c("reps",e,t,n);return[_a(_c("x",e,t,n),r)]}case"Split":case"SplitV":{const r=_c("axis",e,t,n),a=_c("numOrSizeSplits",e,t,n),s=_c("x",e,t,n);return ca(s,a,r)}case"ScatterNd":{const r=_c("indices",e,t,n),a=_c("values",e,t,n),s=_c("shape",e,t,n);return[Vp(r,a,s)]}case"GatherNd":{const r=_c("x",e,t,n),a=_c("indices",e,t,n);return[Wp(r,a)]}case"SparseToDense":{const r=_c("sparseIndices",e,t,n),a=_c("outputShape",e,t,n),s=_c("sparseValues",e,t,n),o=_c("defaultValue",e,t,n);return[Dp(r,s,a,s.dtype===o.dtype?o:_r(o,s.dtype))]}default:throw TypeError(`Node type ${e.op} is not implemented`)}})(e,t,n)));case"sparse":return ds((()=>((e,t,n)=>{switch(e.op){case"SparseFillEmptyRows":{const{outputIndices:r,outputValues:a,emptyRowIndicator:s,reverseIndexMap:o}=Ls.sparseFillEmptyRows(_c("indices",e,t,n),_c("values",e,t,n),_c("denseShape",e,t,n),_c("defaultValue",e,t,n));return[r,a,s,o]}case"SparseReshape":{const{outputIndices:r,outputShape:a}=Ls.sparseReshape(_c("inputIndices",e,t,n),_c("inputShape",e,t,n),_c("newShape",e,t,n));return[r,a]}case"SparseSegmentMean":return[Ls.sparseSegmentMean(_c("data",e,t,n),_c("indices",e,t,n),_c("segmentIds",e,t,n))];case"SparseSegmentSum":return[Ls.sparseSegmentSum(_c("data",e,t,n),_c("indices",e,t,n),_c("segmentIds",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}})(e,t,n)));case"spectral":return ds((()=>((e,t,n)=>{switch(e.op){case"FFT":return[da(_c("x",e,t,n))];case"IFFT":return[fa(_c("x",e,t,n))];case"RFFT":return[ha(_c("x",e,t,n))];case"IRFFT":return[ya(_c("x",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}})(e,t,n)));case"string":return ds((()=>((e,t,n)=>{switch(e.op){case"StringNGrams":{const{nGrams:r,nGramsSplits:a}=qs.stringNGrams(_c("data",e,t,n),_c("dataSplits",e,t,n),_c("separator",e,t,n),_c("nGramWidths",e,t,n),_c("leftPad",e,t,n),_c("rightPad",e,t,n),_c("padWidth",e,t,n),_c("preserveShortSequences",e,t,n));return[r,a]}case"StringSplit":{const{indices:r,values:a,shape:s}=qs.stringSplit(_c("input",e,t,n),_c("delimiter",e,t,n),_c("skipEmpty",e,t,n));return[r,a,s]}case"StringToHashBucketFast":return[qs.stringToHashBucketFast(_c("input",e,t,n),_c("numBuckets",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}})(e,t,n)));case"transformation":return ds((()=>((e,t,n)=>{switch(e.op){case"Cast":return[_r(_c("x",e,t,n),_c("dtype",e,t,n))];case"ExpandDims":{const r=_c("axis",e,t,n);return[Jr(_c("x",e,t,n),r)]}case"Squeeze":{const r=_c("axis",e,t,n);return[ta(_c("x",e,t,n),r)]}case"Reshape":return[Xr(_c("x",e,t,n),_c("shape",e,t,n))];case"MirrorPad":return[Hp(_c("x",e,t,n),_c("padding",e,t,n),_c("mode",e,t,n))];case"PadV2":case"Pad":return[Up(_c("x",e,t,n),_c("padding",e,t,n),_c("constantValue",e,t,n))];case"SpaceToBatchND":{const r=_c("blockShape",e,t,n),a=_c("paddings",e,t,n);return[Kp(_c("x",e,t,n),r,a)]}case"BatchToSpaceND":{const r=_c("blockShape",e,t,n),a=_c("crops",e,t,n);return[Gp(_c("x",e,t,n),r,a)]}case"DepthToSpace":{const r=_c("blockSize",e,t,n),a=_c("dataFormat",e,t,n).toUpperCase();return[Jp(_c("x",e,t,n),r,a)]}case"BroadcastTo":return[Ha(_c("x",e,t,n),_c("shape",e,t,n))];case"BroadcastArgs":return[Yp(_c("s0",e,t,n),_c("s1",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}})(e,t,n)));case"hash_table":return(async(e,t,n,r)=>{switch(e.op){case"HashTable":case"HashTableV2":{const a=_c("keyDType",e,t,n),s=_c("valueDType",e,t,n),o=new Np(a,s);return r.addHashTable(e.name,o),[o.handle]}case"LookupTableImport":case"LookupTableImportV2":{const a=_c("tableHandle",e,t,n,r),s=_c("keys",e,t,n),o=_c("values",e,t,n),i=r.getHashTableById(a.id);return[await i.import(s,o)]}case"LookupTableFind":case"LookupTableFindV2":{const a=_c("tableHandle",e,t,n,r),s=_c("keys",e,t,n),o=_c("defaultValue",e,t,n),i=r.getHashTableById(a.id);return[await i.find(s,o)]}case"LookupTableSize":case"LookupTableSizeV2":{const a=_c("tableHandle",e,t,n,r);return[r.getHashTableById(a.id).tensorSize()]}default:throw TypeError(`Node type ${e.op} is not implemented`)}})(e,t,n,r);case"custom":const a=kc(e.op);if(a&&a.customExecutor)return a.customExecutor(new ll(e,t,n));throw TypeError(`Custom op ${e.op} is not registered.`);default:throw TypeError(`Unknown op '${e.op}'. File an issue at https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()`)}})(e,t,n);return re(a)?a.then((e=>[].concat(e))):[].concat(a)}class Zp{constructor(e={},t={},n={},r={}){this.weightMap=e,this.tensorArrayMap=t,this.tensorListMap=n,this.functionMap=r,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}newFrame(e,t){return{id:e,frameName:t,iterationId:0}}set currentContext(e){this.contexts!==e&&(this.contexts=e,this.generateCurrentContextIds())}get currentContext(){return this.contexts}get currentContextId(){return this._currentContextIds[0]}get currentContextIds(){return this._currentContextIds}generateCurrentContextIds(){const e=[];for(let t=0;t<this.contexts.length-1;t++){const n=this.contexts.slice(0,this.contexts.length-t);e.push(this.contextIdforContexts(n))}e.push(""),this._currentContextIds=e}contextIdforContexts(e){return e?e.map((e=>0===e.id&&0===e.iterationId?"":`${e.frameName}-${e.iterationId}`)).join("/"):""}enterFrame(e){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,e)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))}exitFrame(){if(!(this.contexts&&this.contexts.length>1))throw new Error("Cannot exit frame, the context is empty");this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift()}nextIteration(){if(!(this.contexts&&this.contexts.length>0))throw new Error("Cannot increase frame iteration, the context is empty");{this.contexts=this.contexts.slice(),this.lastId++;const e=Object.assign({},this.contexts[this.contexts.length-1]);e.iterationId+=1,e.id=this.lastId,this.contexts.splice(-1,1,e),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))}}getWeight(e){return this.weightMap[e]}addTensorArray(e){this.tensorArrayMap[e.id]=e}getTensorArray(e){return this.tensorArrayMap[e]}addTensorList(e){this.tensorListMap[e.id]=e}getTensorList(e){return this.tensorListMap[e]}dispose(e){for(const t in this.tensorArrayMap)this.tensorArrayMap[t].clearAndClose(e);for(const t in this.tensorListMap)this.tensorListMap[t].clearAndClose(e)}}function Qp(e,t,n,r){const a=new Set,s=[];let o=null,i=null;const u=new Set,c=Object.keys(e).map((e=>Ec(e)[0]));let l=[];null!=r&&(l=r.map((e=>Ec(e.name)[0])));const p=[...t];for(;p.length>0;){const e=p.pop();(rd(e)||ad(e)||sd(e))&&null==o&&(o=e,i=o.children.map((e=>e.name)).filter((e=>a.has(e)))),a.add(e.name),null==n[e.name]&&-1===c.indexOf(e.name)&&-1===l.indexOf(e.name)&&(0!==e.inputs.length?e.inputs.forEach((e=>{u.has(e.name)||(u.add(e.name),p.push(e))})):s.push(e.name))}return{inputs:e,outputs:t,usedNodes:a,missingInputs:s,dynamicNode:o,syncInputs:i}}const ed=["Switch","Merge","Enter","Exit","NextIteration","StatelessIf","StatelessWhile","if","While"],td=["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"],nd=["HashTable","HashTableV2","LookupTableImport","LookupTableImportV2","LookupTableFind","LookupTableFindV2","LookupTableSize","LookupTableSizeV2"];function rd(e){return ed.indexOf(e.op)>=0}function ad(e){return td.indexOf(e.op)>=0}function sd(e){return nd.indexOf(e.op)>=0}class od{constructor(e,t){this.graph=e,this.parent=t,this.compiledMap=new Map,this._weightMap={},this.SEPERATOR=",",this._functions={},this._functionExecutorMap={},this._outputs=e.outputs,this._inputs=e.inputs,this._initNodes=e.initNodes,this._signature=e.signature,this._functions=e.functions,null!=e.functions&&Object.keys(e.functions).forEach((t=>{this._functionExecutorMap[t]=new od(e.functions[t],this)}))}get weightIds(){return this.parent?this.parent.weightIds:this._weightIds}get functionExecutorMap(){return this.parent?this.parent.functionExecutorMap:this._functionExecutorMap}get weightMap(){return this.parent?this.parent.weightMap:this._weightMap}set weightMap(e){const t=Object.keys(e).map((t=>e[t].map((e=>e.id))));this._weightIds=[].concat(...t),this._weightMap=e}set resourceManager(e){this._resourceManager=e}get inputs(){return this._inputs.map((e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0})))}get outputs(){return this._outputs.map((e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0})))}get inputNodes(){return this._inputs.map((e=>e.signatureKey||e.name))}get outputNodes(){return this._outputs.map((e=>{const t=e.signatureKey||e.name;return e.defaultOutput?`${t}:${e.defaultOutput}`:t}))}get functions(){return Object.keys(this._functions).reduce(((e,t)=>(e[t]=this._functions[t].signature,e)),{})}getCompilationKey(e,t){const n=e.map((e=>e.name)).sort(),r=t.map((e=>e.name)).sort();return n.join(this.SEPERATOR)+"--"+r.join(this.SEPERATOR)}compile(e,t){const n=Qp(e,t,this.weightMap,this._initNodes),{missingInputs:r,dynamicNode:a,syncInputs:s}=n;if(null!=a)throw new Error(`This execution contains the node '${a.name}', which has the dynamic op '${a.op}'. Please use model.executeAsync() instead. Alternatively, to avoid the dynamic ops, specify the inputs [${s}]`);if(r.length>0){const n=t.map((e=>e.name)),a=Object.keys(e);throw new Error(`Cannot compute the outputs [${n}] from the provided inputs [${a}]. Missing the following inputs: [${r}]`)}return function(e,t,n){const{usedNodes:r,inputs:a}=n,s=[],o=Object.keys(a).map((e=>Ec(e)[0])).map((t=>e.nodes[t])),i=e.initNodes;o.forEach((e=>{r.has(e.name)&&s.push(e)})),e.weights.forEach((e=>{r.has(e.name)&&s.push(e)})),null!=i&&i.forEach((e=>{r.has(e.name)&&s.push(e)}));const u=new Set,c=[];for(;s.length>0;){const e=s.pop();u.add(e.name),t[e.name]||c.push(e),e.children.forEach((e=>{!u.has(e.name)&&r.has(e.name)&&e.inputs.every((e=>u.has(e.name)))&&s.push(e)}))}return c}(this.graph,this.weightMap,n)}execute(e,t){e=this.mapInputs(e);const n=Object.keys(e).sort();this.checkInputs(e),this.checkInputShapeAndType(e),t=this.mapOutputs(t),this.checkOutputs(t);const r=n.map((e=>this.graph.nodes[Ec(e)[0]])),a=t.map((e=>Ec(e)[0]));let s=a.map((e=>this.graph.nodes[e]));0===s.length&&(s=this._outputs);const o=this.getCompilationKey(r,s);let i=this.compiledMap.get(o);null==i&&(i=this.compile(e,s),this.compiledMap.set(o,i));const u={},c={};return ds((()=>{const n=new Zp(this.weightMap,u,c,this.functionExecutorMap),r=Object.assign({},this.weightMap);Object.keys(e).forEach((t=>{const[n,a]=Ec(t),s=[];s[a]=e[t],r[n]=s}));const s=this.getFrozenTensorIds(r),o={};for(let e=0;e<i.length;e++){const t=i[e];if(!r[t.name]){const e=Xp(t,r,n,this._resourceManager);if(re(e))throw new Error(`The execution of the op '${t.op}' returned a promise. Please use model.executeAsync() instead.`);r[t.name]=e,this.checkTensorForDisposal(t.name,t,r,n,s,a,o)}}return null==this.parent&&n.dispose(s),t.map((e=>Sc(e,r,n)))}))}getFrozenTensorIds(e){const t=[].concat.apply([],Object.keys(e).map((t=>e[t])).map((e=>e.map((e=>e.id)))));return new Set(t)}checkTensorForDisposal(e,t,n,r,a,s,o){"control"!==t.category&&-1===s.indexOf(e)&&(n[e].forEach((e=>{null!=e&&(o[e.id]=(o[e.id]||0)+t.children.length)})),t.inputs.forEach((e=>{if("control"!==e.category){const t=function(e,t,n){return t[Tc(e,n.currentContextId)]}(e.name,n,r);null!=t&&t.forEach((e=>{if(e&&!e.kept&&!a.has(e.id)){const t=o[e.id];1===t?(e.dispose(),delete o[e.id]):null!=t&&o[e.id]--}}))}})))}async executeAsync(e,t){return this._executeAsync(e,t)}async _executeAsync(e,t,n=!1,r={},a={}){n||(e=this.mapInputs(e),this.checkInputs(e),this.checkInputShapeAndType(e),t=this.mapOutputs(t),this.checkOutputs(t));const s=new Zp(this.weightMap,r,a,this.functionExecutorMap),o=await this.executeWithControlFlow(e,s,t,n),i=t.map((e=>Sc(e,o,s))),u=i.map((e=>e.id)),c=Object.keys(e).map((t=>e[t].id)),l=new Set([...u,...c,...this.weightIds]);return Object.keys(o).forEach((e=>{o[e].forEach((e=>{!e||e.kept||e.isDisposed||l.has(e.id)||e.dispose()}))})),null==this.parent&&s.dispose(l),i}async executeFunctionAsync(e,t,n){const r=e.reduce(((e,t,n)=>(e[this.inputs[n].name]=t,e)),{});return this._executeAsync(r,this.outputNodes,!0,t,n)}async executeWithControlFlow(e,t,n,r){const a=Object.keys(e),s=a.map((e=>this.graph.nodes[Ec(e)[0]])),o=n.map((e=>Ec(e)[0]));let i=o.map((e=>this.graph.nodes[e]));0===i.length&&(i=this._outputs);const{usedNodes:u,missingInputs:c,dynamicNode:l,syncInputs:p}=Qp(e,i,this.weightMap,this._initNodes),d=[...s,...this.graph.weights,...this._initNodes||[]].map((e=>({node:e,contexts:t.currentContext}))),h=Object.assign({},this.weightMap);Object.keys(e).forEach((t=>{const[n,r]=Ec(t),a=[];a[r]=e[t],h[n]=a}));const f={},m=this.getFrozenTensorIds(h),y={};for(;d.length>0;){const e=this.processStack(s,d,t,h,y,m,o,f,u);await Promise.all(e)}null!=l||r||console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead.");const g=i.filter((e=>!rd(e)&&!Sc(e.name,h,t))).map((e=>e.name));if(g.length>0){let e="";throw null!=l&&(e=`Alternatively, to avoid the dynamic ops, use model.execute() and specify the inputs [${p}]`),new Error(`Cannot compute the outputs [${g}] from the provided inputs [${a}]. Consider providing the following inputs: [${c}]. ${e}`)}return h}processStack(e,t,n,r,a,s,o,i,u){const c=[];for(;t.length>0;){const e=t.pop();n.currentContext=e.contexts;let l="";if("Enter"===e.node.op&&_c("isConstant",e.node,r,n)&&([l]=Nc(e.node.name,n)),null==r[e.node.name]){const p=Xp(e.node,r,n,this._resourceManager);l||([l]=Nc(e.node.name,n));const d=n.currentContext;re(p)?c.push(p.then((c=>(r[l]=c,n.currentContext=d,this.checkTensorForDisposal(l,e.node,r,n,s,o,i),this.processChildNodes(e.node,t,n,r,a,u),c)))):(r[l]=p,this.checkTensorForDisposal(l,e.node,r,n,s,o,i),this.processChildNodes(e.node,t,n,r,a,u))}else this.processChildNodes(e.node,t,n,r,a,u)}return c}processChildNodes(e,t,n,r,a,s){e.children.forEach((e=>{const[o]=Nc(e.name,n);!a[o]&&s.has(e.name)&&("Merge"===e.op?e.inputNames.some((e=>!!Sc(e,r,n)))&&(a[o]=!0,t.push({contexts:n.currentContext,node:e})):e.inputNames.every((e=>!!Sc(e,r,n)))&&(a[o]=!0,t.push({contexts:n.currentContext,node:e})))}))}dispose(){Object.keys(this.weightMap).forEach((e=>this.weightMap[e].forEach((e=>e.dispose()))))}checkInputShapeAndType(e){Object.keys(e).forEach((t=>{const n=e[t],[r]=Ec(t),a=this.graph.nodes[r];if(a.attrParams.shape&&a.attrParams.shape.value){const e=a.attrParams.shape.value;$(e.length===n.shape.length&&n.shape.every(((t,n)=>-1===e[n]||e[n]===t)),(()=>`The shape of dict['${a.name}'] provided in model.execute(dict) must be [${e}], but was [${n.shape}]`))}a.attrParams.dtype&&a.attrParams.dtype.value&&$(n.dtype===a.attrParams.dtype.value,(()=>`The dtype of dict['${a.name}'] provided in model.execute(dict) must be ${a.attrParams.dtype.value}, but was ${n.dtype}`))}))}mapInputs(e){const t={};for(const n in e)null!=this._signature&&null!=this._signature.inputs&&null!=this._signature.inputs[n]?t[this._signature.inputs[n].name]=e[n]:t[n]=e[n];return t}checkInputs(e){const t=Object.keys(e).filter((e=>{const[t]=Ec(e);return null==this.graph.nodes[t]}));if(t.length>0)throw new Error(`The dict provided in model.execute(dict) has keys: [${t}] that are not part of graph`)}mapOutputs(e){return e.map((e=>null!=this._signature&&null!=this._signature.outputs&&null!=this._signature.outputs[e]?this._signature.outputs[e].name:e),{})}checkOutputs(e){e.forEach((e=>{const[t]=Ec(e);if(!this.graph.nodes[t])throw new Error(`The output '${e}' is not found in the graph`)}))}}class id{constructor(e={},t={}){this.hashTableNameToHandle=e,this.hashTableMap=t}addHashTable(e,t){this.hashTableNameToHandle[e]=t.handle,this.hashTableMap[t.id]=t}getHashTableHandleByName(e){return this.hashTableNameToHandle[e]}getHashTableById(e){return this.hashTableMap[e]}dispose(){for(const e in this.hashTableMap)this.hashTableMap[e].clearAndClose(),delete this.hashTableMap[e];for(const e in this.hashTableNameToHandle)this.hashTableNameToHandle[e].dispose(),delete this.hashTableNameToHandle[e]}}class ud{constructor(e,t={}){this.modelUrl=e,this.loadOptions=t,this.version="n/a",null==t&&(this.loadOptions={}),this.resourceManager=new id}get modelVersion(){return this.version}get inputNodes(){return this.executor.inputNodes}get outputNodes(){return this.executor.outputNodes}get inputs(){return this.executor.inputs}get outputs(){return this.executor.outputs}get weights(){return this.executor.weightMap}get metadata(){return this.artifacts.userDefinedMetadata}get modelSignature(){return this.signature}findIOHandler(){const e=this.modelUrl;if(null!=e.load)this.handler=e;else if(null!=this.loadOptions.requestInit)this.handler=Rr(e,this.loadOptions);else{const r=(t=e,n=this.loadOptions,Xn.getLoadHandlers(t,n));if(0===r.length)r.push(Rr(e,this.loadOptions));else if(r.length>1)throw new Error(`Found more than one (${r.length}) load handlers for URL '${[e]}'`);this.handler=r[0]}var t,n}async load(){if(this.findIOHandler(),null==this.handler.load)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");const e=await this.handler.load();return this.loadSync(e)}loadSync(e){this.artifacts=e;const t=this.artifacts.modelTopology;let n;n=null!=this.artifacts.userDefinedMetadata&&null!=this.artifacts.userDefinedMetadata.signature?this.artifacts.userDefinedMetadata.signature:this.artifacts.signature,this.signature=n,this.version=`${t.versions.producer}.${t.versions.minConsumer}`;const r=function(e,t){const n={};let r,a=0;for(const s of t){const t=s.name,o=s.dtype,i=s.shape,u=L(i);let c;if("quantization"in s){const n=s.quantization;if("uint8"===n.dtype||"uint16"===n.dtype){if(!("min"in n)||!("scale"in n))throw new Error(`Weight ${s.name} with quantization ${n.dtype} doesn't have corresponding metadata min and scale.`)}else{if("float16"!==n.dtype)throw new Error(`Weight ${s.name} has unknown quantization dtype ${n.dtype}. Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.`);if("float32"!==o)throw new Error(`Weight ${s.name} is quantized with ${n.dtype} which only supports weights of type float32 not ${o}.`)}const i=Wn[n.dtype],l=e.slice(a,a+u*i),p="uint8"===n.dtype?new Uint8Array(l):new Uint16Array(l);if("float32"===o)if("uint8"===n.dtype||"uint16"===n.dtype){c=new Float32Array(p.length);for(let e=0;e<p.length;e++){const t=p[e];c[e]=t*n.scale+n.min}}else{if("float16"!==n.dtype)throw new Error(`Unsupported quantization type ${n.dtype} for weight type float32.`);void 0===r&&(r=Yn()),c=r(p)}else{if("int32"!==o)throw new Error(`Unsupported dtype in weight '${t}': ${o}`);if("uint8"!==n.dtype&&"uint16"!==n.dtype)throw new Error(`Unsupported quantization type ${n.dtype} for weight type int32.`);c=new Int32Array(p.length);for(let e=0;e<p.length;e++){const t=p[e];c[e]=Math.round(t*n.scale+n.min)}}a+=u*i}else if("string"===o){const t=L(s.shape);c=[];for(let n=0;n<t;n++){const t=new Uint32Array(e.slice(a,a+4))[0];a+=4;const n=new Uint8Array(e.slice(a,a+t));c.push(n),a+=t}}else{const r=Wn[o],s=e.slice(a,a+u*r);if("float32"===o)c=new Float32Array(s);else if("int32"===o)c=new Int32Array(s);else if("bool"===o)c=new Uint8Array(s);else{if("complex64"!==o)throw new Error(`Unsupported dtype in weight '${t}': ${o}`);{c=new Float32Array(s);const e=new Float32Array(c.length/2),r=new Float32Array(c.length/2);for(let t=0;t<e.length;t++)e[t]=c[2*t],r[t]=c[2*t+1];const a=Vn(e,i,"float32"),o=Vn(r,i,"float32");n[t]=qn(a,o),a.dispose(),o.dispose()}}a+=u*r}"complex64"!==o&&(n[t]=Vn(c,i,o))}return n}(this.artifacts.weightData,this.artifacts.weightSpecs);if(this.executor=new od(Jc.Instance.transformGraph(t,this.signature)),this.executor.weightMap=this.convertTensorMapToTensorsMap(r),this.executor.resourceManager=this.resourceManager,null!=e.modelInitializer&&null!=e.modelInitializer.node){const t=Jc.Instance.transformGraph(e.modelInitializer);this.initializer=new od(t),this.initializer.weightMap=this.executor.weightMap,this.initializer.resourceManager=this.resourceManager,this.initializer.executeAsync({},[])}return!0}async save(e,t){if("string"==typeof e){const t=(n=e,Xn.getSaveHandlers(n));if(0===t.length)throw new Error(`Cannot find any save handlers for URL '${e}'`);if(t.length>1)throw new Error(`Found more than one (${t.length}) save handlers for URL '${e}'`);e=t[0]}var n;if(null==e.save)throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return e.save(this.artifacts)}predict(e,t){return this.execute(e,this.outputNodes)}normalizeInputs(e){if(!(e instanceof gn||Array.isArray(e)))return e;if((e=Array.isArray(e)?e:[e]).length!==this.inputNodes.length)throw new Error(`Input tensor count mismatch,the graph model has ${this.inputNodes.length} placeholders, while there are ${e.length} input tensors.`);return this.inputNodes.reduce(((t,n,r)=>(t[n]=e[r],t)),{})}normalizeOutputs(e){return e=e||this.outputNodes,Array.isArray(e)?e:[e]}execute(e,t){e=this.normalizeInputs(e),t=this.normalizeOutputs(t);const n=this.executor.execute(e,t);return n.length>1?n:n[0]}async executeAsync(e,t){e=this.normalizeInputs(e),t=this.normalizeOutputs(t);const n=await this.executor.executeAsync(e,t);return n.length>1?n:n[0]}convertTensorMapToTensorsMap(e){return Object.keys(e).reduce(((t,n)=>(t[n]=[e[n]],t)),{})}dispose(){this.executor.dispose(),this.initializer&&this.initializer.dispose(),this.resourceManager.dispose()}}async function cd(e,t={}){if(null==e)throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");null==t&&(t={}),t.fromTFHub&&null==e.load&&(e.endsWith("/")||(e+="/"),e=`${e}model.json?tfjs-format=file`);const n=new ud(e,t);return await n.load(),n}function ld(e,t,n,r){return new(n||(n=Promise))((function(a,s){function o(e){try{u(r.next(e))}catch(e){s(e)}}function i(e){try{u(r.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,i)}u((r=r.apply(e,t||[])).next())}))}function pd(e,t){var n,r,a,s,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function i(s){return function(i){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&s[0]?r.return:s[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,s[1])).done)return a;switch(r=0,a&&(s=[2&s[0],a.value]),s[0]){case 0:case 1:a=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(a=(a=o.trys).length>0&&a[a.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!a||s[1]>a[0]&&s[1]<a[3])){o.label=s[1];break}if(6===s[0]&&o.label<a[1]){o.label=a[1],a=s;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(s);break}a[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],r=0}finally{n=a=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,i])}}}var dd=function(e){return{startEndTensor:e,startPoint:ea(e,[0,0],[-1,2]),endPoint:ea(e,[0,2],[-1,2])}},hd={strides:[8,16],anchors:[2,6]};function fd(e,t){var n,r,a;if(e.topLeft instanceof gn&&e.bottomRight instanceof gn){var s=ds((function(){return[Hr([ea(ra(t-1,e.topLeft),0,1),ea(e.topLeft,1,1)]),Hr([ra(t-1,ea(e.bottomRight,0,1)),ea(e.bottomRight,1,1)])]}));n=s[0],r=s[1],null!=e.landmarks&&(a=ds((function(){var n=ra(aa([t-1,0]),e.landmarks),r=aa([1,-1]);return Yr(n,r)})))}else{var o=e.topLeft,i=o[0],u=o[1],c=e.bottomRight,l=c[0],p=c[1];n=[t-1-i,u],r=[t-1-l,p],null!=e.landmarks&&(a=e.landmarks.map((function(e){return[t-1-e[0],e[1]]})))}var d={topLeft:n,bottomRight:r};return null!=a&&(d.landmarks=a),null!=e.probability&&(d.probability=e.probability instanceof gn?e.probability.clone():e.probability),d}function md(e,t){return ds((function(){var n;return n=e.hasOwnProperty("box")?e.box:e,ta(function(e,t){var n=Yr(e.startPoint,t),r=Yr(e.endPoint,t),a=Ur([n,r],1);return dd(a)}(n,t).startEndTensor)}))}var yd=function(){function e(e,t,n,r,a,s){this.blazeFaceModel=e,this.width=t,this.height=n,this.maxFaces=r,this.anchorsData=function(e,t,n){for(var r=[],a=0;a<n.strides.length;a++)for(var s=n.strides[a],o=Math.floor((t+s-1)/s),i=Math.floor((e+s-1)/s),u=n.anchors[a],c=0;c<o;c++)for(var l=s*(c+.5),p=0;p<i;p++)for(var d=s*(p+.5),h=0;h<u;h++)r.push([d,l]);return r}(t,n,hd),this.anchors=sa(this.anchorsData),this.inputSizeData=[t,n],this.inputSize=aa([t,n]),this.iouThreshold=a,this.scoreThreshold=s}return e.prototype.getBoundingBoxes=function(e,t,n){return void 0===n&&(n=!0),ld(this,void 0,void 0,(function(){var r,a,s,o,i,u,c,l,p,d,h,f,m,y,g=this;return pd(this,(function(b){switch(b.label){case 0:return r=ds((function(){var t=Bs.resizeBilinear(e,[g.width,g.height]),n=Yr(ra(Gr(t,255),.5),2),r=g.blazeFaceModel.predict(n),a=ta(r),s=function(e,t,n){var r=ea(e,[0,1],[-1,2]),a=Wr(r,t),s=ea(e,[0,3],[-1,2]),o=Gr(s,n),i=Gr(a,n),u=Gr(o,2),c=ra(i,u),l=Wr(i,u),p=Yr(c,n),d=Yr(l,n);return Ur([p,d],1)}(a,g.anchors,g.inputSize),o=ea(a,[0,0],[-1,1]);return[a,s,ta(Qr(o))]})),a=r[0],s=r[1],o=r[2],i=console.warn,console.warn=function(){},u=Bs.nonMaxSuppression(s,o,this.maxFaces,this.iouThreshold,this.scoreThreshold),console.warn=i,[4,u.array()];case 1:return c=b.sent(),u.dispose(),l=c.map((function(e){return ea(s,[e,0],[1,-1])})),t?[3,3]:[4,Promise.all(l.map((function(e){return ld(g,void 0,void 0,(function(){var t;return pd(this,(function(n){switch(n.label){case 0:return[4,e.array()];case 1:return t=n.sent(),e.dispose(),[2,t]}}))}))})))];case 2:l=b.sent(),b.label=3;case 3:for(p=e.shape[1],d=e.shape[2],h=t?Gr([d,p],this.inputSize):[d/this.inputSizeData[0],p/this.inputSizeData[1]],f=[],m=function(e){var r=l[e],s=ds((function(){var s=dd(r instanceof gn?r:sa(r));if(!n)return s;var i,u=c[e];return i=t?ea(g.anchors,[u,0],[1,2]):g.anchorsData[u],{box:s,landmarks:Xr(ta(ea(a,[u,5],[1,-1])),[6,-1]),probability:ea(o,[u],[1]),anchor:i}}));f.push(s)},y=0;y<l.length;y++)m(y);return s.dispose(),o.dispose(),a.dispose(),[2,{boxes:f,scaleFactor:h}]}}))}))},e.prototype.estimateFaces=function(e,t,n,r){return void 0===t&&(t=!1),void 0===n&&(n=!1),void 0===r&&(r=!0),ld(this,void 0,void 0,(function(){var a,s,o,i,u,c,l=this;return pd(this,(function(p){switch(p.label){case 0:return a=function(e){return e instanceof gn?[e.shape[0],e.shape[1]]:[e.height,e.width]}(e),s=a[1],o=ds((function(){return e instanceof gn||(e=Fr(e)),Jr(_r(e,"float32"),0)})),[4,this.getBoundingBoxes(o,t,r)];case 1:return i=p.sent(),u=i.boxes,c=i.scaleFactor,o.dispose(),t?[2,u.map((function(e){var t=md(e,c),a={topLeft:ea(t,[0],[2]),bottomRight:ea(t,[2],[2])};if(r){var o=e,i=o.landmarks,u=o.probability,l=o.anchor,p=Yr(Wr(i,l),c);a.landmarks=p,a.probability=u}return n&&(a=fd(a,s)),a}))]:[2,Promise.all(u.map((function(e){return ld(l,void 0,void 0,(function(){var t,a,o,i,u,l,p,d,h,f,m,y=this;return pd(this,(function(g){switch(g.label){case 0:return t=md(e,c),r?[3,2]:[4,t.array()];case 1:return u=g.sent(),a={topLeft:u.slice(0,2),bottomRight:u.slice(2)},[3,4];case 2:return[4,Promise.all([e.landmarks,t,e.probability].map((function(e){return ld(y,void 0,void 0,(function(){return pd(this,(function(t){return[2,e.array()]}))}))})))];case 3:o=g.sent(),i=o[0],u=o[1],l=o[2],p=e.anchor,h=(d=c)[0],f=d[1],m=i.map((function(e){return[(e[0]+p[0])*h,(e[1]+p[1])*f]})),a={topLeft:u.slice(0,2),bottomRight:u.slice(2),landmarks:m,probability:l},function(e){e.startEndTensor.dispose(),e.startPoint.dispose(),e.endPoint.dispose()}(e.box),e.landmarks.dispose(),e.probability.dispose(),g.label=4;case 4:return t.dispose(),n&&(a=fd(a,s)),[2,a]}}))}))})))]}}))}))},e}();function gd(e){var t=void 0===e?{}:e,n=t.maxFaces,r=void 0===n?10:n,a=t.inputWidth,s=void 0===a?128:a,o=t.inputHeight,i=void 0===o?128:o,u=t.iouThreshold,c=void 0===u?.3:u,l=t.scoreThreshold,p=void 0===l?.75:l,d=t.modelUrl;return ld(this,void 0,void 0,(function(){var e;return pd(this,(function(t){switch(t.label){case 0:return null==d?[3,2]:[4,cd(d)];case 1:return e=t.sent(),[3,4];case 2:return[4,cd("https://tfhub.dev/tensorflow/tfjs-model/blazeface/1/default/1",{fromTFHub:!0})];case 3:e=t.sent(),t.label=4;case 4:return[2,new yd(e,s,i,r,c,p)]}}))}))}var bd,wd,vd=n.p+"f752b858fd2a5d2e07f3e34116956c4d.wasm",xd=n.p+"a256c789bffcc0e6a70c9faba7e0ad01.wasm",kd=n.p+"57a4b368fe9c4b3664afc1701e2d7a71.wasm",_d=function(e,t,n,r){return new(n||(n=Promise))((function(a,s){function o(e){try{u(r.next(e))}catch(e){s(e)}}function i(e){try{u(r.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,i)}u((r=r.apply(e,t||[])).next())}))},Sd=function(e,t){var n,r,a,s,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function i(s){return function(i){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&s[0]?r.return:s[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,s[1])).done)return a;switch(r=0,a&&(s=[2&s[0],a.value]),s[0]){case 0:case 1:a=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((a=(a=o.trys).length>0&&a[a.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!a||s[1]>a[0]&&s[1]<a[3])){o.label=s[1];break}if(6===s[0]&&o.label<a[1]){o.label=a[1],a=s;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(s);break}a[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],r=0}finally{n=a=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,i])}}},Nd=function(){function e(e){this.video=e,this.isActive=!1}return e.prototype.Load=function(){return _d(this,void 0,void 0,(function(){return Sd(this,(function(e){switch(e.label){case 0:return bd?[3,3]:(function(e,t=!1){if(gc)throw new Error("The WASM backend was already initialized. Make sure you call `setWasmPaths()` before you call `tf.setBackend()` or `tf.ready()`");if("string"==typeof e)mc=e;else{yc=e;const t=hc.filter((e=>null==yc[e]));if(t.length>0)throw new Error(`There were no entries found for the following binaries: ${t.join(",")}. Please either call setWasmPaths with a map providing a path for each binary, or with a string indicating the directory where all the binaries can be found.`)}bc=t}({"tfjs-backend-wasm.wasm":kd,"tfjs-backend-wasm-simd.wasm":vd,"tfjs-backend-wasm-threaded-simd.wasm":xd}),[4,Cn.ready()]);case 1:return e.sent(),"wasm",Cn.setBackend("wasm"),[4,gd({modelUrl:"/demo/blazeface/model.json"})];case 2:bd=e.sent(),e.label=3;case 3:return this.isActive=!0,this.predictLoop(),[2]}}))}))},e.prototype.predictLoop=function(){return _d(this,void 0,void 0,(function(){var e,t=this;return Sd(this,(function(n){switch(n.label){case 0:return this.isActive?[4,bd.estimateFaces(this.video,!1)]:[2];case 1:return e=n.sent(),this.currentFaceLocation=e[0]||null,setTimeout((function(){return t.predictLoop()}),100),[2]}}))}))},e.prototype.getFace=function(){return this.currentFaceLocation},e.prototype.cleanup=function(){this.isActive=!1},e}(),Td=function(){function e(e,t,n){this.faceDetector=e,this.canvasBox=t,this.videoBox=n,this.imageInfo={outOfView:!0,angle:0,scale:1,centerX:0,centerY:0,width:0,height:0},this.isActive=!0,this.calcFacePos()}return e.prototype.getImageInfo=function(){return this.imageInfo},e.prototype.cleanup=function(){this.isActive=!1},e.prototype.normalTransition=function(e,t,n){var r=e-t;return r<-n||r>n?e-r/2:e},e.prototype.calcFacePos=function(){var e=this;if(this.isActive){if(this.face=this.faceDetector.getFace(),!this.face)return this.imageInfo.outOfView=!0,void setTimeout((function(){return e.calcFacePos()}),40);var t=this.face.landmarks,n=this.face.topLeft,r=this.face.bottomRight,a=[r[0]-n[0],r[1]-n[1]];this.imageInfo.outOfView=n[0]<0||r[0]>this.videoBox.width||n[1]<0||r[1]>this.videoBox.height;var s=t[1][0]-t[0][0],o=t[0][1]-t[1][1],i=o/Math.hypot(s,o);this.imageInfo.width=r[0]-n[0],this.imageInfo.height=r[1]-n[1],this.imageInfo.angle=this.normalTransition(this.imageInfo.angle,i,.1),this.imageInfo.centerX=this.normalTransition(this.imageInfo.centerX,t[2][0],10),this.imageInfo.centerY=this.normalTransition(this.imageInfo.centerY,t[2][1],10),this.imageInfo.scale=this.normalTransition(this.imageInfo.scale,1/a[0]*this.canvasBox.width,.1),setTimeout((function(){return e.calcFacePos()}),40)}},e}(),Ed=function(){function e(e,t,n){this.video=e,this.canvasSize=t,this.faceFeatureExtractor=n,this.isActive=!0,this.canvas=document.createElement("CANVAS"),this.canvas.width=this.canvasSize.width,this.canvas.height=this.canvasSize.height,this.ctx=this.canvas.getContext("2d"),this.debug(),this.renderLoop()}return e.prototype.debug=function(){var e=document.getElementById("debug-canvas");e&&e.appendChild(this.canvas)},e.prototype.cleanup=function(){this.isActive=!1,this.canvas.remove()},e.prototype.getStream=function(){return this.canvas.captureStream()},e.prototype.renderImage=function(e,t,n,r,a,s,o,i,u){this.ctx&&(this.ctx.save(),this.ctx.translate(t,n),this.ctx.rotate(i),this.ctx.scale(u,u),this.ctx.drawImage(e,-s,-o,r,a),this.ctx.restore())},e.prototype.renderLoop=function(){var e,t,n,r,a,s;return n=this,r=void 0,s=function(){var n,r=this;return function(e,t){var n,r,a,s,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function i(s){return function(i){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&s[0]?r.return:s[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,s[1])).done)return a;switch(r=0,a&&(s=[2&s[0],a.value]),s[0]){case 0:case 1:a=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((a=(a=o.trys).length>0&&a[a.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!a||s[1]>a[0]&&s[1]<a[3])){o.label=s[1];break}if(6===s[0]&&o.label<a[1]){o.label=a[1],a=s;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(s);break}a[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],r=0}finally{n=a=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,i])}}}(this,(function(a){return this.isActive?(this.ctx.globalAlpha=1,this.ctx.fillStyle="black",this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),n=this.faceFeatureExtractor.getImageInfo(),this.renderImage(this.video,this.canvas.width/2,this.canvas.height/2,null===(e=this.video)||void 0===e?void 0:e.videoWidth,null===(t=this.video)||void 0===t?void 0:t.videoHeight,n.centerX,this.canvas.height-n.centerY<this.canvas.height/2?n.centerY:this.canvas.height/2,n.angle,n.scale),"requestVideoFrameCallback"in HTMLVideoElement.prototype?(this.video.requestVideoFrameCallback((function(){return r.renderLoop()})),[2]):(setTimeout((function(){return r.renderLoop()}),40),[2])):[2]}))},new((a=void 0)||(a=Promise))((function(e,t){function o(e){try{u(s.next(e))}catch(e){t(e)}}function i(e){try{u(s.throw(e))}catch(e){t(e)}}function u(t){var n;t.done?e(t.value):(n=t.value,n instanceof a?n:new a((function(e){e(n)}))).then(o,i)}u((s=s.apply(n,r||[])).next())}))},e}(),Id=function(){function e(e,t){void 0===t&&(t={audioBitsPerSecond:128e3,videoBitsPerSecond:4e5}),this.chunks=[];var n=this;this.mediaRecorder=new MediaRecorder(e,t),this.mediaRecorder.ondataavailable=function(e){n.chunks.push(e.data)}}return e.prototype.start=function(){var e=this;this.chunks=[],this.mediaRecorder.start(),this.recordStopTimeout&&(this.recordStopTimeout=setTimeout((function(){e.recordStopTimeout=null,e.stop()}),15e3))},e.prototype.stop=function(){return e=this,t=void 0,r=function(){var e=this;return function(e,t){var n,r,a,s,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function i(s){return function(i){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&s[0]?r.return:s[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,s[1])).done)return a;switch(r=0,a&&(s=[2&s[0],a.value]),s[0]){case 0:case 1:a=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((a=(a=o.trys).length>0&&a[a.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!a||s[1]>a[0]&&s[1]<a[3])){o.label=s[1];break}if(6===s[0]&&o.label<a[1]){o.label=a[1],a=s;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(s);break}a[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],r=0}finally{n=a=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,i])}}}(this,(function(t){return"inactive"===this.mediaRecorder.state?[2]:(this.recordStopTimeout&&(clearTimeout(this.recordStopTimeout),this.recordStopTimeout=null),[2,new Promise((function(t){e.mediaRecorder.onstop=function(){t(e.chunks)},e.mediaRecorder.stop()}))])}))},new((n=void 0)||(n=Promise))((function(a,s){function o(e){try{u(r.next(e))}catch(e){s(e)}}function i(e){try{u(r.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,i)}u((r=r.apply(e,t||[])).next())}));var e,t,n,r},e.prototype.isRecording=function(){return"recording"===this.mediaRecorder.state},e.prototype.cleanup=function(){this.stop()},e}(),Od=function(){function e(e,t,n){var r=this;this.element=e,this.pressed=t,this.released=n,this.isPressed=!1;var a=this;this.element.className="inactive",this.handlePress=function(){a.isPressed||(r.element.className="active",a.isPressed=!0,a.pressed())},this.handleRelease=function(){r.isPressed&&(r.element.className="inactive",r.isPressed=!1,r.released())},this.element.addEventListener("mousedown",this.handlePress),this.element.addEventListener("touchstart",this.handlePress),this.element.addEventListener("mouseup",this.handleRelease),this.element.addEventListener("mouseleave",this.handleRelease),this.element.addEventListener("touchend",this.handleRelease)}return e.prototype.stop=function(){this.handleRelease()},e.prototype.cleanup=function(){this.element.removeEventListener("mousedown",this.handlePress),this.element.removeEventListener("touchstart",this.handlePress),this.element.removeEventListener("mouseup",this.handleRelease),this.element.removeEventListener("mouseleave",this.handleRelease),this.element.removeEventListener("touchend",this.handleRelease)},e}(),Ad=function(){function e(e,t){void 0===t&&(t=function(e){return e.getImageInfo().outOfView}),this.faceFeatureExtractor=e,this.validatorCondition=t}return e.prototype.start=function(e,t){var n=this;this.recordDuration=(new Date).getTime(),this.validationInterval=setInterval((function(){n.validatorCondition(n.faceFeatureExtractor)?e():t&&t(n.faceFeatureExtractor.getImageInfo())}),40)},e.prototype.isReadyToSend=function(){return(new Date).getTime()-this.recordDuration>1e3},e.prototype.cleanup=function(){clearInterval(this.validationInterval),this.validationInterval=null,this.recordDuration=null},e}(),Md=(wd=function(e,t){return(wd=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}wd(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),Cd=function(e,t,n,r){return new(n||(n=Promise))((function(a,s){function o(e){try{u(r.next(e))}catch(e){s(e)}}function i(e){try{u(r.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,i)}u((r=r.apply(e,t||[])).next())}))},Rd=function(e,t){var n,r,a,s,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function i(s){return function(i){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&s[0]?r.return:s[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,s[1])).done)return a;switch(r=0,a&&(s=[2&s[0],a.value]),s[0]){case 0:case 1:a=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((a=(a=o.trys).length>0&&a[a.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!a||s[1]>a[0]&&s[1]<a[3])){o.label=s[1];break}if(6===s[0]&&o.label<a[1]){o.label=a[1],a=s;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(s);break}a[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],r=0}finally{n=a=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,i])}}},Dd=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.canvasBox={width:150,height:200},t.videoBox={width:0,height:0},t}return Md(t,e),t.prototype.draw=function(){this.cameraStream=document.createElement("video"),this.cameraStream.autoplay=!0,this.cameraStream.muted=!0,this.cameraStream.controls=!1,this.cameraStream.controls=!1,this.cameraStream.playsInline=!0,this.cameraStream.className="camera-stream",this.container.appendChild(this.cameraStream),this.controlContainer=document.createElement("div"),this.controlContainer.className="action-box",this.container.appendChild(this.controlContainer),this.pressHoldBtn=document.createElement("button"),this.pressHoldBtn.innerText="record",this.controlContainer.appendChild(this.pressHoldBtn)},t.prototype.initialize=function(){return Cd(this,void 0,void 0,(function(){var e,t=this;return Rd(this,(function(n){switch(n.label){case 0:return this.eventManager.dispatchEvent("loading",{isLoaded:!1}),this.dispatchJobInfo(),this.Camera=new M(this.cameraStream),[4,this.Camera.setup("user")];case 1:return n.sent(),this.videoBox={width:this.cameraStream.videoWidth,height:this.cameraStream.videoHeight},this.faceDetector=new Nd(this.cameraStream),[4,this.faceDetector.Load()];case 2:return n.sent(),this.faceFeatureExtractor=new Td(this.faceDetector,this.canvasBox,this.videoBox),this.faceSpeakerValidator=new Ad(this.faceFeatureExtractor),this.canvasRender=new Ed(this.cameraStream,this.canvasBox,this.faceFeatureExtractor),(e=this.canvasRender.getStream()).addTrack(this.Camera.getStream().getAudioTracks()[0]),this.recorder=new Id(e),this.eventManager.dispatchEvent("loading",{isLoaded:!0}),this.pressHold=new Od(this.pressHoldBtn,(function(){t.recorder.start(),t.faceSpeakerValidator.start((function(){t.faceSpeakerValidator.cleanup(),t.recorder.stop(),t.pressHold.stop(),t.eventManager.dispatchEvent("error",{errorCode:"out_of_frame",errorMessage:"recording stopped, stay in frame!"})}))}),(function(){t.recorder.stop().then((function(e){if(t.pressHoldBtn.className="inactive",!t.faceSpeakerValidator.isReadyToSend())return t.eventManager.dispatchEvent("error",{errorCode:"invalid_recording",errorMessage:"video is less than 1 second!"}),void t.faceSpeakerValidator.cleanup();t.faceSpeakerValidator.cleanup();var n=new Blob(e,{type:"video/mp4;"}),r=new FileReader;r.readAsArrayBuffer(n),r.onloadend=function(){var e=t.response(r.result),n=I.encode(e).finish();t.ws.send(n)}}))})),[2]}}))}))},t.prototype.cleanup=function(){return Cd(this,void 0,void 0,(function(){return Rd(this,(function(e){return this.Camera&&this.Camera.cleanup(),this.faceDetector&&this.faceDetector.cleanup(),this.faceFeatureExtractor&&this.faceFeatureExtractor.cleanup(),this.canvasRender&&this.canvasRender.cleanup(),this.recorder&&this.recorder.cleanup(),this.pressHold&&this.pressHold.cleanup(),this.faceSpeakerValidator&&this.faceSpeakerValidator.cleanup(),this.pressHoldBtn.remove(),this.cameraStream.remove(),this.controlContainer.remove(),[2]}))}))},t.prototype.isJob=function(){return!0},t.prototype.dispatchJobInfo=function(){this.eventManager.dispatchEvent("next_job",{job:"face_text",whatToSay:this.serverRequest.faceText.text})},t.prototype.response=function(e){return I.create({id:this.serverRequest.id,faceText:{video:new Uint8Array(e)}})},t}(A),Fd=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),$d=function(e,t,n,r){return new(n||(n=Promise))((function(a,s){function o(e){try{u(r.next(e))}catch(e){s(e)}}function i(e){try{u(r.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,i)}u((r=r.apply(e,t||[])).next())}))},Pd=function(e,t){var n,r,a,s,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function i(s){return function(i){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&s[0]?r.return:s[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,s[1])).done)return a;switch(r=0,a&&(s=[2&s[0],a.value]),s[0]){case 0:case 1:a=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((a=(a=o.trys).length>0&&a[a.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!a||s[1]>a[0]&&s[1]<a[3])){o.label=s[1];break}if(6===s[0]&&o.label<a[1]){o.label=a[1],a=s;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(s);break}a[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],r=0}finally{n=a=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,i])}}},jd=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.canvasBox={width:150,height:200},t.videoBox={width:0,height:0},t}return Fd(t,e),t.prototype.draw=function(){this.cameraStream=document.createElement("video"),this.cameraStream.autoplay=!0,this.cameraStream.muted=!0,this.cameraStream.controls=!1,this.cameraStream.controls=!1,this.cameraStream.playsInline=!0,this.cameraStream.className="camera-stream",this.container.appendChild(this.cameraStream),this.controlContainer=document.createElement("div"),this.controlContainer.className="action-box",this.container.appendChild(this.controlContainer)},t.prototype.initialize=function(){return $d(this,void 0,void 0,(function(){var e=this;return Pd(this,(function(t){switch(t.label){case 0:return this.eventManager.dispatchEvent("loading",{isLoaded:!1}),this.dispatchJobInfo(),this.Camera=new M(this.cameraStream),[4,this.Camera.setup("environment")];case 1:return t.sent(),this.videoBox={width:this.cameraStream.videoWidth,height:this.cameraStream.videoHeight},this.faceDetector=new Nd(this.cameraStream),[4,this.faceDetector.Load()];case 2:return t.sent(),this.faceFeatureExtractor=new Td(this.faceDetector,this.canvasBox,this.videoBox),this.faceFeatureExtractor.getImageInfo(),this.faceSpeakerValidator=new Ad(this.faceFeatureExtractor,(function(t){var n=t.getImageInfo();return!(100/e.videoBox.width*n.width>15&&n.centerX<e.videoBox.width/3&&!n.outOfView)})),this.eventManager.dispatchEvent("loading",{isLoaded:!0}),this.retry(),[2]}}))}))},t.prototype.retry=function(){var e=this,t=0;this.eventManager.dispatchEvent("capture_progress",{job:"id_card",progress:0}),this.faceSpeakerValidator.start((function(){t=0,e.eventManager.dispatchEvent("capture_progress",{job:"id_card",progress:t})}),(function(n){return $d(e,void 0,void 0,(function(){var e,r,a=this;return Pd(this,(function(s){switch(s.label){case 0:return++t%10==0&&this.eventManager.dispatchEvent("capture_progress",{job:"id_card",progress:2*t}),t>50?(this.faceSpeakerValidator.cleanup(),[4,this.Camera.capture()]):[3,2];case 1:e=s.sent(),(r=new FileReader).readAsArrayBuffer(e),r.onloadend=function(){var e=a.response(r.result,n),t=I.encode(e).finish();a.ws.send(t)},s.label=2;case 2:return[2]}}))}))}))},t.prototype.cleanup=function(){return $d(this,void 0,void 0,(function(){return Pd(this,(function(e){return this.Camera&&this.Camera.cleanup(),this.faceDetector&&this.faceDetector.cleanup(),this.faceFeatureExtractor&&this.faceFeatureExtractor.cleanup(),this.faceSpeakerValidator&&this.faceSpeakerValidator.cleanup(),this.cameraStream.remove(),this.controlContainer.remove(),[2]}))}))},t.prototype.isJob=function(){return!0},t.prototype.dispatchJobInfo=function(){this.eventManager.dispatchEvent("next_job",{job:"id_card",placeholderUrl:this.serverRequest.idCard.placeholder})},t.prototype.response=function(e,t){return I.create({id:this.serverRequest.id,idCard:{image:new Uint8Array(e),faceBox:{x:t.centerX,y:t.centerY,h:t.height,w:t.width}}})},t}(A),Bd=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ld=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Bd(t,e),t.prototype.dispatchJobInfo=function(){this.eventManager.dispatchEvent("next_job",{job:"face_agreement",whatToSay:this.serverRequest.faceAgreement.text})},t.prototype.response=function(e){return I.create({id:this.serverRequest.id,faceAgreement:{video:new Uint8Array(e)}})},t}(Dd),qd=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),zd=function(e,t,n,r){return new(n||(n=Promise))((function(a,s){function o(e){try{u(r.next(e))}catch(e){s(e)}}function i(e){try{u(r.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,i)}u((r=r.apply(e,t||[])).next())}))},Vd=function(e,t){var n,r,a,s,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function i(s){return function(i){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&s[0]?r.return:s[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,s[1])).done)return a;switch(r=0,a&&(s=[2&s[0],a.value]),s[0]){case 0:case 1:a=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((a=(a=o.trys).length>0&&a[a.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!a||s[1]>a[0]&&s[1]<a[3])){o.label=s[1];break}if(6===s[0]&&o.label<a[1]){o.label=a[1],a=s;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(s);break}a[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],r=0}finally{n=a=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,i])}}},Wd=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return qd(t,e),t.prototype.initialize=function(){return zd(this,void 0,void 0,(function(){return Vd(this,(function(e){return this.eventManager.dispatchEvent("jobs",{jobs:this.serverRequest.jobs.job.map((function(e){return{id:e.id,action:e.action,verified:e.verified}}))}),[2]}))}))},t.prototype.cleanup=function(){return zd(this,void 0,void 0,(function(){return Vd(this,(function(e){return[2]}))}))},t.prototype.isJob=function(){return!1},t}(A),Hd=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ud=function(e,t,n,r){return new(n||(n=Promise))((function(a,s){function o(e){try{u(r.next(e))}catch(e){s(e)}}function i(e){try{u(r.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,i)}u((r=r.apply(e,t||[])).next())}))},Kd=function(e,t){var n,r,a,s,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function i(s){return function(i){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&s[0]?r.return:s[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,s[1])).done)return a;switch(r=0,a&&(s=[2&s[0],a.value]),s[0]){case 0:case 1:a=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((a=(a=o.trys).length>0&&a[a.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!a||s[1]>a[0]&&s[1]<a[3])){o.label=s[1];break}if(6===s[0]&&o.label<a[1]){o.label=a[1],a=s;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(s);break}a[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],r=0}finally{n=a=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,i])}}},Gd=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Hd(t,e),t.prototype.initialize=function(){return Ud(this,void 0,void 0,(function(){return Kd(this,(function(e){return this.eventManager.dispatchEvent("finish",{}),[2]}))}))},t.prototype.cleanup=function(){return Ud(this,void 0,void 0,(function(){return Kd(this,(function(e){return[2]}))}))},t.prototype.isJob=function(){return!0},t}(A),Jd=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Yd=function(e,t,n,r){return new(n||(n=Promise))((function(a,s){function o(e){try{u(r.next(e))}catch(e){s(e)}}function i(e){try{u(r.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,i)}u((r=r.apply(e,t||[])).next())}))},Xd=function(e,t){var n,r,a,s,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function i(s){return function(i){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&s[0]?r.return:s[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,s[1])).done)return a;switch(r=0,a&&(s=[2&s[0],a.value]),s[0]){case 0:case 1:a=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((a=(a=o.trys).length>0&&a[a.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!a||s[1]>a[0]&&s[1]<a[3])){o.label=s[1];break}if(6===s[0]&&o.label<a[1]){o.label=a[1],a=s;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(s);break}a[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],r=0}finally{n=a=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,i])}}},Zd=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Jd(t,e),t.prototype.initialize=function(){return Yd(this,void 0,void 0,(function(){return Xd(this,(function(e){return this.eventManager.dispatchEvent("error",{errorCode:this.serverRequest.error.code,errorMessage:this.serverRequest.error.Message}),[2]}))}))},t.prototype.cleanup=function(){return Yd(this,void 0,void 0,(function(){return Xd(this,(function(e){return[2]}))}))},t.prototype.isJob=function(){return!1},t}(A),Qd=function(){function e(){}return e.prototype.getVerificationList=function(){return this.actions},e.prototype.getVerification=function(e){return this.actions[e]},e}(),eh=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),th=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.actions={faceAgreement:Ld,faceText:Dd,idCard:jd,jobs:Wd,finish:Gd,error:Zd},t}return eh(t,e),t}(Qd),nh=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),rh=function(e,t,n,r){return new(n||(n=Promise))((function(a,s){function o(e){try{u(r.next(e))}catch(e){s(e)}}function i(e){try{u(r.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,i)}u((r=r.apply(e,t||[])).next())}))},ah=function(e,t){var n,r,a,s,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function i(s){return function(i){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&s[0]?r.return:s[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,s[1])).done)return a;switch(r=0,a&&(s=[2&s[0],a.value]),s[0]){case 0:case 1:a=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((a=(a=o.trys).length>0&&a[a.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!a||s[1]>a[0]&&s[1]<a[3])){o.label=s[1];break}if(6===s[0]&&o.label<a[1]){o.label=a[1],a=s;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(s);break}a[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],r=0}finally{n=a=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,i])}}},sh=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.canvasBox={width:150,height:200},t.videoBox={width:0,height:0},t}return nh(t,e),t.prototype.draw=function(){this.cameraStream=document.createElement("video"),this.cameraStream.autoplay=!0,this.cameraStream.muted=!0,this.cameraStream.controls=!1,this.cameraStream.controls=!1,this.cameraStream.playsInline=!0,this.cameraStream.className="camera-stream",this.container.appendChild(this.cameraStream),this.controlContainer=document.createElement("div"),this.controlContainer.className="action-box",this.container.appendChild(this.controlContainer),this.pressHoldBtn=document.createElement("button"),this.pressHoldBtn.innerText="record",this.controlContainer.appendChild(this.pressHoldBtn)},t.prototype.initialize=function(){return rh(this,void 0,void 0,(function(){var e=this;return ah(this,(function(t){switch(t.label){case 0:return this.eventManager.dispatchEvent("loading",{isLoaded:!1}),this.dispatchJobInfo(),this.Camera=new M(this.cameraStream),[4,this.Camera.setup("user")];case 1:return t.sent(),this.recorder=new Id(this.Camera.getStream()),this.eventManager.dispatchEvent("loading",{isLoaded:!0}),this.pressHold=new Od(this.pressHoldBtn,(function(){e.recorder.start(),e.recordDuration=(new Date).getTime()}),(function(){e.recorder.stop().then((function(t){if(e.pressHoldBtn.className="inactive",e.isReadyToSend()){var n=new Blob(t,{type:"video/mp4;"}),r=new FileReader;r.readAsArrayBuffer(n),r.onloadend=function(){var t=e.response(r.result),n=I.encode(t).finish();e.ws.send(n)}}else e.eventManager.dispatchEvent("error",{errorCode:"invalid_recording",errorMessage:"video is less than 1 second!"})}))})),[2]}}))}))},t.prototype.cleanup=function(){return rh(this,void 0,void 0,(function(){return ah(this,(function(e){return this.Camera.cleanup(),this.recorder.cleanup(),this.pressHold.cleanup(),this.pressHoldBtn.remove(),this.cameraStream.remove(),this.controlContainer.remove(),[2]}))}))},t.prototype.isJob=function(){return!0},t.prototype.dispatchJobInfo=function(){this.eventManager.dispatchEvent("next_job",{job:"face_text",whatToSay:this.serverRequest.faceText.text})},t.prototype.response=function(e){return I.create({id:this.serverRequest.id,faceText:{video:new Uint8Array(e)}})},t.prototype.isReadyToSend=function(){return(new Date).getTime()-this.recordDuration>1e3},t}(A),oh=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ih=function(e,t,n,r){return new(n||(n=Promise))((function(a,s){function o(e){try{u(r.next(e))}catch(e){s(e)}}function i(e){try{u(r.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,i)}u((r=r.apply(e,t||[])).next())}))},uh=function(e,t){var n,r,a,s,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function i(s){return function(i){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&s[0]?r.return:s[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,s[1])).done)return a;switch(r=0,a&&(s=[2&s[0],a.value]),s[0]){case 0:case 1:a=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((a=(a=o.trys).length>0&&a[a.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!a||s[1]>a[0]&&s[1]<a[3])){o.label=s[1];break}if(6===s[0]&&o.label<a[1]){o.label=a[1],a=s;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(s);break}a[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],r=0}finally{n=a=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,i])}}},ch=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return oh(t,e),t.prototype.draw=function(){this.cameraStream=document.createElement("video"),this.cameraStream.autoplay=!0,this.cameraStream.muted=!0,this.cameraStream.controls=!1,this.cameraStream.playsInline=!0,this.cameraStream.className="camera-stream",this.container.appendChild(this.cameraStream),this.controlContainer=document.createElement("div"),this.controlContainer.className="action-box",this.container.appendChild(this.controlContainer),this.captureBtn=document.createElement("button"),this.captureBtn.innerText="capture",this.controlContainer.appendChild(this.captureBtn)},t.prototype.initialize=function(){return ih(this,void 0,void 0,(function(){var e=this;return uh(this,(function(t){switch(t.label){case 0:return this.eventManager.dispatchEvent("loading",{isLoaded:!1}),this.dispatchJobInfo(),this.Camera=new M(this.cameraStream),[4,this.Camera.setup("environment")];case 1:return t.sent(),this.eventManager.dispatchEvent("loading",{isLoaded:!0}),this.captureBtn.addEventListener("click",(function(t){return ih(e,void 0,void 0,(function(){var e,t,n=this;return uh(this,(function(r){switch(r.label){case 0:return[4,this.Camera.capture()];case 1:return e=r.sent(),(t=new FileReader).readAsArrayBuffer(e),t.onloadend=function(){var e=n.response(t.result),r=I.encode(e).finish();n.ws.send(r)},[2]}}))}))})),[2]}}))}))},t.prototype.cleanup=function(){return ih(this,void 0,void 0,(function(){return uh(this,(function(e){return this.Camera.cleanup(),this.cameraStream.remove(),this.controlContainer.remove(),[2]}))}))},t.prototype.isJob=function(){return!0},t.prototype.dispatchJobInfo=function(){this.eventManager.dispatchEvent("next_job",{job:"id_card",placeholderUrl:this.serverRequest.idCard.placeholder})},t.prototype.response=function(e){return I.create({id:this.serverRequest.id,idCard:{image:new Uint8Array(e),faceBox:null}})},t}(A),lh=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ph=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return lh(t,e),t.prototype.dispatchJobInfo=function(){this.eventManager.dispatchEvent("next_job",{job:"face_agreement",whatToSay:this.serverRequest.faceAgreement.text})},t.prototype.response=function(e){return I.create({id:this.serverRequest.id,faceAgreement:{video:new Uint8Array(e)}})},t}(sh),dh=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),hh=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.actions={faceAgreement:ph,faceText:sh,idCard:ch,jobs:Wd,finish:Gd,error:Zd},t}return dh(t,e),t}(Qd),fh=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),mh=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.actions={faceAgreement:ph,faceText:sh,idCard:ch,jobs:Wd,finish:Gd,error:Zd},t}return fh(t,e),t}(Qd),yh=function(){function e(e,t,n,r){var a=this;this.ws=e,this.container=t,this.eventManager=n,this.environmentName=r,this.currentAction=null,this.getEnv();var s=function(e){o.ws.registerEvent(e,(function(t){a.execute(e,t)}))},o=this;for(var i in this.environment.getVerificationList())s(i)}return e.prototype.execute=function(e,t){var n=new(this.environment.getVerification(e))(t,this.ws,this.container,this.eventManager);n.isJob()&&(this.currentAction&&this.currentAction.cleanup(),this.currentAction=n),"error"==e&&this.currentAction.retry(),n.initialize()},e.prototype.getEnv=function(){switch(this.environmentName){case"normal":this.environment=new th;break;case"low-performance":this.environment=new hh;break;case"file-only":this.environment=new mh}},e.prototype.close=function(){this.currentAction&&(console.dir(this.currentAction),this.currentAction.cleanup())},e}(),gh=function(){function e(){this.events={}}return e.prototype.addListener=function(e,t){this.events[e]=t},e.prototype.dispatchEvent=function(e,t){this.events[e]?this.events[e](t):console.log("event "+e+" is not registered!")},e}(),bh=function(){function e(e,t,n){void 0===n&&(n="normal"),this.eventManager=new gh,this.ws=new O(e,"wss://app.verified.run/ws"),this.vm=new yh(this.ws,t,this.eventManager,n),this.ws.start()}return e.prototype.cleanup=function(){this.ws.close(),this.vm.close()},e}()},7256:function(){},2578:function(){},2980:function(){},4862:function(){},7958:function(){},5410:function(){},8628:function(){},5042:function(){}},__webpack_module_cache__={},deferred;function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var n=__webpack_module_cache__[e]={id:e,loaded:!1,exports:{}};return __webpack_modules__[e].call(n.exports,n,n.exports,__webpack_require__),n.loaded=!0,n.exports}__webpack_require__.m=__webpack_modules__,__webpack_require__.amdD=function(){throw new Error("define cannot be used indirect")},__webpack_require__.amdO={},deferred=[],__webpack_require__.O=function(e,t,n,r){if(!t){var a=1/0;for(u=0;u<deferred.length;u++){t=deferred[u][0],n=deferred[u][1],r=deferred[u][2];for(var s=!0,o=0;o<t.length;o++)(!1&r||a>=r)&&Object.keys(__webpack_require__.O).every((function(e){return __webpack_require__.O[e](t[o])}))?t.splice(o--,1):(s=!1,r<a&&(a=r));if(s){deferred.splice(u--,1);var i=n();void 0!==i&&(e=i)}}return e}r=r||0;for(var u=deferred.length;u>0&&deferred[u-1][2]>r;u--)deferred[u]=deferred[u-1];deferred[u]=[t,n,r]},__webpack_require__.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return __webpack_require__.d(t,{a:t}),t},__webpack_require__.d=function(e,t){for(var n in t)__webpack_require__.o(t,n)&&!__webpack_require__.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),__webpack_require__.hmd=function(e){return(e=Object.create(e)).children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:function(){throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e},__webpack_require__.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},__webpack_require__.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},__webpack_require__.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e},function(){var e;__webpack_require__.g.importScripts&&(e=__webpack_require__.g.location+"");var t=__webpack_require__.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");n.length&&(e=n[n.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),__webpack_require__.p=e}(),function(){var e={361:0};__webpack_require__.O.j=function(t){return 0===e[t]};var t=function(t,n){var r,a,s=n[0],o=n[1],i=n[2],u=0;if(s.some((function(t){return 0!==e[t]}))){for(r in o)__webpack_require__.o(o,r)&&(__webpack_require__.m[r]=o[r]);if(i)var c=i(__webpack_require__)}for(t&&t(n);u<s.length;u++)a=s[u],__webpack_require__.o(e,a)&&e[a]&&e[a][0](),e[s[u]]=0;return __webpack_require__.O(c)},n=self.webpackChunkkycjs=self.webpackChunkkycjs||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var __webpack_exports__=__webpack_require__(4864);__webpack_exports__=__webpack_require__.O(__webpack_exports__)})();
//# sourceMappingURL=KYC.a09372e8d21f7638df21.js.map